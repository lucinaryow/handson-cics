     5	     *CBL XOPTS(COBOL2)
    20	      IDENTIFICATION DIVISION.
    21	      PROGRAM-ID. SM001P.
    22
    23	      ENVIRONMENT DIVISION.
    24	      CONFIGURATION SECTION.
    25	      SOURCE-COMPUTER.	  IBM-PC.
    26	      OBJECT-COMPUTER.	  IBM-PC.
    27
    28	      DATA DIVISION.
    29	      WORKING-STORAGE SECTION.
    75	      01  WS-TIME		      PIC 9(15) COMP-3.
    76	      01  WS-FILLER				PIC X(80).
    77	      01  WS-PG-LIT		      PIC 9(2).
    78	      01  WS-PG-RED REDEFINES WS-PG-LIT.
    79		  05   PG-LIT1		      PIC 9.
    80		  05   PG-LIT2		      PIC 9.
    81	      01  WS-TALLY		      PIC 9(3) VALUE 0.
    82	      01  WS-REM		      PIC 9(3).
    83	      01  WS-COMP		      PIC 9(4).
    84	      01  WS-MAX		      PIC 9(3).
    85	      01  WS-RESPONSE-CODE	      PIC S9(8) COMP.
    86	      01  WS-COUNTER		      PIC 9(2) VALUE 0.
    87	      01  WS-COUNTER2		      PIC 9(2) VALUE 0.
    88	      01  WS-CHOICE		      PIC X.
    89	      01  WS-USERID		      PIC X(8).
    90	      01  WS-PRGNAME		      PIC X(6).
    91	      01  WS-LENGTH		      PIC S9(4) COMP.
    92	      01  WS-RECB-LENGTH	      PIC S9(4) COMP VALUE +20.
    93	      01  WS-KEYB-LENGTH	      PIC S9(4) COMP VALUE +8.
    94	      01  WS-INDX		      PIC 9(3)	VALUE 1.
    95	      01  WS-LASTPAGE		      PIC X(1).
    96	      01  WS-FIRSTPAGE		      PIC X(1).
    97	      01  WS-PAGE-CTR		      PIC 9(02).
    98	      01  WS-COMMAREA.
    99		  05  WS-CA-PRGNAME	      PIC X(06).
   100		  05  FILLER		      PIC X(19).
   101		  05  WS-DFHSTATE	      PIC X(15).
   102		  05  WS-TRANS		      PIC X(04).
   103		  05  WS-LUSER		      PIC 9(03).
   104		  05  WS-FUSER		      PIC 9(03).
   105		  05  WS-PAGE		      PIC 9(02).
   106		  05  WS-QNAME		      PIC X(8).
   107		  05  WS-PAGE-END	      PIC 9(01).
   108		  05  WS-QITEM		      PIC S9(4) COMP.
   109		  05  WS-QITEM-START	      PIC S9(4) COMP.
   110		  05  WS-QITEM-END	      PIC S9(4) COMP.
   111		  05  WS-QITEM-PAGE	      PIC S9(4) COMP.
   112		  05  WS-USER-REC.
   113		      10  USERID.
   114			  15  USERID1			    PIC X(7).
   115			  15  FILLER			    PIC X.
   116		      10  REQUESTOR			    PIC X.
   117		      10  ADMINISTRATOR 		    PIC X.
   118		      10  APPROVER			    PIC X.
   119		      10  SERVICE-PROVIDER		    PIC X.
   120		      10  UPDATED-BY1.
   121			  15  UPDBY1			    PIC X(7).
   122			  15  FILLER			    PIC X.
   123		  05  WS-TIX-REC.   124		      10  TIX-ID			    PIC X(06).
   125		      10  TIX-REQUESTOR 		    PIC X(08).
   126		      10  TIX-STATUS			    PIC X(10).
   127		      10  TIX-TITLE			    PIC X(25).
   128		      10  TIX-DESC			    PIC X(100).
   129		      10  TIX-DESC-RED REDEFINES TIX-DESC.
   130			  15  TIX-DESC1 		    PIC X(50).
   131			  15  TIX-DESC2 		    PIC X(50).
   132		      10  LAST-UPDATE			    PIC X(20).
   133		      10  LAST-UPDATE-RED REDEFINES LAST-UPDATE.
   134			  15  LAST-UPDATE-DATE.
   135					      20 DD PIC X(02).
   136						  20 FILLER PIC X.
   137						  20 MM PIC X(02).
   138						  20 FILLER PIC X.
   139						  20 YYYY PIC X(02).
   140						  20 FILLER PIC X.
   141			  15  LAST-UPDATE-TIME		    PIC X(09).
   142		      10  UPDATED-BY2.
   143			  15  UPDBY2			    PIC X(7).
   144			  15  FILLER			    PIC X.
   145		      10  LAST-UPDATE-REM		    PIC X(50).
   146		      10  LAST-UPDATE-REMW REDEFINES LAST-UPDATE-REM.
   147			  15  LAST-UPDATE-REM1		    PIC X(25).
   148			  15  LAST-UPDATE-REM2		    PIC X(25).
   149		  05  WS-PROG-STATE			 PIC 9(1).
   150            05  WS-INIT                            PIC X VALUE 'Y'.
   151		  05  WS-USERID1			 PIC X(7).
   152		  05  WS-TICKET-NUM.
   153		      10  WS-TICKET-NUM1		 PIC X(6).
   154		      10  FILLER			 PIC X.
   155	      01  WS-END				PIC X(15) VALUE
   156            'END PROCESSING'.
   157	      01  WS-INVKEY				PIC X(21) VALUE
   158            'INVALID PFKEY PRESSED'.
   159	      01  WS-INVALID			  PIC X(14) VALUE
   160            'INVALID ACCESS'.
   161	      01  WS-INVALID-TICKET			  PIC X(28) VALUE
   162            'TICKET NUMBER DOES NOT EXIST'.
   163	      01  WS-INVALID-USER			  PIC X(24) VALUE
   164                                'INVALID ACCESS TO TICKET'.
   165	      01 WS-SWITCH.
   166		  05 DATE-FILTER-SW PIC X.
   167		  05 TITLE-FILTER-SW PIC X.
   168		  05 VALID-DATE-FILTER-SW   PIC X.
   169
   170	     *
   171	      COPY SM001S.
   173	     * SYMBOLIC MAP of sm001s Created by CACXBMS Version 6.0.27
   174	      01  SM001MI.
   175		  02  FILLER				     PIC X(12).
   176		  02  DATEL				     PIC S9(4) COMP.
   177		  02  DATEF				     PIC X.
   178		  02  FILLER REDEFINES DATEF.
   179		      03  DATEA 			     PIC X.
   180		  02  DATEI				     PIC X(010).
   181		  02  PAGEL				     PIC S9(4) COMP.
   182		  02  PAGEF				     PIC X.
   183		  02  FILLER REDEFINES PAGEF.
   184		      03  PAGEA 			     PIC X.   185		  02  PAGEI				     PIC X(002).
   186		  02  TIMEL				     PIC S9(4) COMP.
   187		  02  TIMEF				     PIC X.
   188		  02  FILLER REDEFINES TIMEF.
   189		      03  TIMEA 			     PIC X.
   190		  02  TIMEI				     PIC X(008).
   191		  02  TITLEL				     PIC S9(4) COMP.
   192		  02  TITLEF				     PIC X.
   193		  02  FILLER REDEFINES TITLEF.
   194		      03  TITLEA			     PIC X.
   195		  02  TITLEI				     PIC X(020).
   196		  02  STATUSL				     PIC S9(4) COMP.
   197		  02  STATUSF				     PIC X.
   198		  02  FILLER REDEFINES STATUSF.
   199		      03  STATUSA			     PIC X.
   200		  02  STATUSI				     PIC X(007).
   201		  02  TODATEL				     PIC S9(4) COMP.
   202		  02  TODATEF				     PIC X.
   203		  02  FILLER REDEFINES TODATEF.
   204		      03  TODATEA			     PIC X.
   205		  02  TODATEI				     PIC X(008).
   206		  02  FRDATEL				     PIC S9(4) COMP.
   207		  02  FRDATEF				     PIC X.
   208		  02  FILLER REDEFINES FRDATEF.
   209		      03  FRDATEA			     PIC X.
   210		  02  FRDATEI				     PIC X(008).
   211		  02  UC1L				     PIC S9(4) COMP.
   212		  02  UC1F				     PIC X.
   213		  02  FILLER REDEFINES UC1F.
   214		      03  UC1A				     PIC X.
   215		  02  UC1I				     PIC X(001).
   216		  02  UC2L				     PIC S9(4) COMP.
   217		  02  UC2F				     PIC X.
   218		  02  FILLER REDEFINES UC2F.
   219		      03  UC2A				     PIC X.
   220		  02  UC2I				     PIC X(001).
   221		  02  UC3L				     PIC S9(4) COMP.
   222		  02  UC3F				     PIC X.
   223		  02  FILLER REDEFINES UC3F.
   224		      03  UC3A				     PIC X.
   225		  02  UC3I				     PIC X(001).
   226		  02  UC4L				     PIC S9(4) COMP.
   227		  02  UC4F				     PIC X.
   228		  02  FILLER REDEFINES UC4F.
   229		      03  UC4A				     PIC X.
   230		  02  UC4I				     PIC X(001).
   231		  02  UC5L				     PIC S9(4) COMP.
   232		  02  UC5F				     PIC X.
   233		  02  FILLER REDEFINES UC5F.
   234		      03  UC5A				     PIC X.
   235		  02  UC5I				     PIC X(001).
   236		  02  UC6L				     PIC S9(4) COMP.
   237		  02  UC6F				     PIC X.
   238		  02  FILLER REDEFINES UC6F.
   239		      03  UC6A				     PIC X.
   240		  02  UC6I				     PIC X(001).
   241		  02  UC7L				     PIC S9(4) COMP.
   242		  02  UC7F				     PIC X.
   243		  02  FILLER REDEFINES UC7F.
   244		      03  UC7A				     PIC X.   245		  02  UC7I				     PIC X(001).
   246		  02  UC8L				     PIC S9(4) COMP.
   247		  02  UC8F				     PIC X.
   248		  02  FILLER REDEFINES UC8F.
   249		      03  UC8A				     PIC X.
   250		  02  UC8I				     PIC X(001).
   251		  02  UC9L				     PIC S9(4) COMP.
   252		  02  UC9F				     PIC X.
   253		  02  FILLER REDEFINES UC9F.
   254		      03  UC9A				     PIC X.
   255		  02  UC9I				     PIC X(001).
   256		  02  UC10L				     PIC S9(4) COMP.
   257		  02  UC10F				     PIC X.
   258		  02  FILLER REDEFINES UC10F.
   259		      03  UC10A 			     PIC X.
   260		  02  UC10I				     PIC X(001).
   261		  02  UC11L				     PIC S9(4) COMP.
   262		  02  UC11F				     PIC X.
   263		  02  FILLER REDEFINES UC11F.
   264		      03  UC11A 			     PIC X.
   265		  02  UC11I				     PIC X(001).
   266		  02  TN1L				     PIC S9(4) COMP.
   267		  02  TN1F				     PIC X.
   268		  02  FILLER REDEFINES TN1F.
   269		      03  TN1A				     PIC X.
   270		  02  TN1I				     PIC X(006).
   271		  02  TN2L				     PIC S9(4) COMP.
   272		  02  TN2F				     PIC X.
   273		  02  FILLER REDEFINES TN2F.
   274		      03  TN2A				     PIC X.
   275		  02  TN2I				     PIC X(006).
   276		  02  TN3L				     PIC S9(4) COMP.
   277		  02  TN3F				     PIC X.
   278		  02  FILLER REDEFINES TN3F.
   279		      03  TN3A				     PIC X.
   280		  02  TN3I				     PIC X(006).
   281		  02  TN4L				     PIC S9(4) COMP.
   282		  02  TN4F				     PIC X.
   283		  02  FILLER REDEFINES TN4F.
   284		      03  TN4A				     PIC X.
   285		  02  TN4I				     PIC X(006).
   286		  02  TN5L				     PIC S9(4) COMP.
   287		  02  TN5F				     PIC X.
   288		  02  FILLER REDEFINES TN5F.
   289		      03  TN5A				     PIC X.
   290		  02  TN5I				     PIC X(006).
   291		  02  TN6L				     PIC S9(4) COMP.
   292		  02  TN6F				     PIC X.
   293		  02  FILLER REDEFINES TN6F.
   294		      03  TN6A				     PIC X.
   295		  02  TN6I				     PIC X(006).
   296		  02  TN7L				     PIC S9(4) COMP.
   297		  02  TN7F				     PIC X.
   298		  02  FILLER REDEFINES TN7F.
   299		      03  TN7A				     PIC X.
   300		  02  TN7I				     PIC X(006).
   301		  02  TN8L				     PIC S9(4) COMP.
   302		  02  TN8F				     PIC X.
   303		  02  FILLER REDEFINES TN8F.
   304		      03  TN8A				     PIC X.   305		  02  TN8I				     PIC X(006).
   306		  02  TN9L				     PIC S9(4) COMP.
   307		  02  TN9F				     PIC X.
   308		  02  FILLER REDEFINES TN9F.
   309		      03  TN9A				     PIC X.
   310		  02  TN9I				     PIC X(006).
   311		  02  TN10L				     PIC S9(4) COMP.
   312		  02  TN10F				     PIC X.
   313		  02  FILLER REDEFINES TN10F.
   314		      03  TN10A 			     PIC X.
   315		  02  TN10I				     PIC X(006).
   316		  02  TN11L				     PIC S9(4) COMP.
   317		  02  TN11F				     PIC X.
   318		  02  FILLER REDEFINES TN11F.
   319		      03  TN11A 			     PIC X.
   320		  02  TN11I				     PIC X(006).
   321		  02  TT1L				     PIC S9(4) COMP.
   322		  02  TT1F				     PIC X.
   323		  02  FILLER REDEFINES TT1F.
   324		      03  TT1A				     PIC X.
   325		  02  TT1I				     PIC X(020).
   326		  02  TT2L				     PIC S9(4) COMP.
   327		  02  TT2F				     PIC X.
   328		  02  FILLER REDEFINES TT2F.
   329		      03  TT2A				     PIC X.
   330		  02  TT2I				     PIC X(020).
   331		  02  TT3L				     PIC S9(4) COMP.
   332		  02  TT3F				     PIC X.
   333		  02  FILLER REDEFINES TT3F.
   334		      03  TT3A				     PIC X.
   335		  02  TT3I				     PIC X(020).
   336		  02  TT4L				     PIC S9(4) COMP.
   337		  02  TT4F				     PIC X.
   338		  02  FILLER REDEFINES TT4F.
   339		      03  TT4A				     PIC X.
   340		  02  TT4I				     PIC X(020).
   341		  02  TT5L				     PIC S9(4) COMP.
   342		  02  TT5F				     PIC X.
   343		  02  FILLER REDEFINES TT5F.
   344		      03  TT5A				     PIC X.
   345		  02  TT5I				     PIC X(020).
   346		  02  TT6L				     PIC S9(4) COMP.
   347		  02  TT6F				     PIC X.
   348		  02  FILLER REDEFINES TT6F.
   349		      03  TT6A				     PIC X.
   350		  02  TT6I				     PIC X(020).
   351		  02  TT7L				     PIC S9(4) COMP.
   352		  02  TT7F				     PIC X.
   353		  02  FILLER REDEFINES TT7F.
   354		      03  TT7A				     PIC X.
   355		  02  TT7I				     PIC X(020).
   356		  02  TT8L				     PIC S9(4) COMP.
   357		  02  TT8F				     PIC X.
   358		  02  FILLER REDEFINES TT8F.
   359		      03  TT8A				     PIC X.
   360		  02  TT8I				     PIC X(020).
   361		  02  TT9L				     PIC S9(4) COMP.
   362		  02  TT9F				     PIC X.
   363		  02  FILLER REDEFINES TT9F.
   364		      03  TT9A				     PIC X.   365		  02  TT9I				     PIC X(020).
   366		  02  TT10L				     PIC S9(4) COMP.
   367		  02  TT10F				     PIC X.
   368		  02  FILLER REDEFINES TT10F.
   369		      03  TT10A 			     PIC X.
   370		  02  TT10I				     PIC X(020).
   371		  02  TT11L				     PIC S9(4) COMP.
   372		  02  TT11F				     PIC X.
   373		  02  FILLER REDEFINES TT11F.
   374		      03  TT11A 			     PIC X.
   375		  02  TT11I				     PIC X(020).
   376		  02  ST1L				     PIC S9(4) COMP.
   377		  02  ST1F				     PIC X.
   378		  02  FILLER REDEFINES ST1F.
   379		      03  ST1A				     PIC X.
   380		  02  ST1I				     PIC X(010).
   381		  02  ST2L				     PIC S9(4) COMP.
   382		  02  ST2F				     PIC X.
   383		  02  FILLER REDEFINES ST2F.
   384		      03  ST2A				     PIC X.
   385		  02  ST2I				     PIC X(010).
   386		  02  ST3L				     PIC S9(4) COMP.
   387		  02  ST3F				     PIC X.
   388		  02  FILLER REDEFINES ST3F.
   389		      03  ST3A				     PIC X.
   390		  02  ST3I				     PIC X(010).
   391		  02  ST4L				     PIC S9(4) COMP.
   392		  02  ST4F				     PIC X.
   393		  02  FILLER REDEFINES ST4F.
   394		      03  ST4A				     PIC X.
   395		  02  ST4I				     PIC X(010).
   396		  02  ST5L				     PIC S9(4) COMP.
   397		  02  ST5F				     PIC X.
   398		  02  FILLER REDEFINES ST5F.
   399		      03  ST5A				     PIC X.
   400		  02  ST5I				     PIC X(010).
   401		  02  ST6L				     PIC S9(4) COMP.
   402		  02  ST6F				     PIC X.
   403		  02  FILLER REDEFINES ST6F.
   404		      03  ST6A				     PIC X.
   405		  02  ST6I				     PIC X(010).
   406		  02  ST7L				     PIC S9(4) COMP.
   407		  02  ST7F				     PIC X.
   408		  02  FILLER REDEFINES ST7F.
   409		      03  ST7A				     PIC X.
   410		  02  ST7I				     PIC X(010).
   411		  02  ST8L				     PIC S9(4) COMP.
   412		  02  ST8F				     PIC X.
   413		  02  FILLER REDEFINES ST8F.
   414		      03  ST8A				     PIC X.
   415		  02  ST8I				     PIC X(010).
   416		  02  ST9L				     PIC S9(4) COMP.
   417		  02  ST9F				     PIC X.
   418		  02  FILLER REDEFINES ST9F.
   419		      03  ST9A				     PIC X.
   420		  02  ST9I				     PIC X(010).
   421		  02  ST10L				     PIC S9(4) COMP.
   422		  02  ST10F				     PIC X.
   423		  02  FILLER REDEFINES ST10F.
   424		      03  ST10A 			     PIC X.   425		  02  ST10I				     PIC X(010).
   426		  02  ST11L				     PIC S9(4) COMP.
   427		  02  ST11F				     PIC X.
   428		  02  FILLER REDEFINES ST11F.
   429		      03  ST11A 			     PIC X.
   430		  02  ST11I				     PIC X(010).
   431		  02  UD1L				     PIC S9(4) COMP.
   432		  02  UD1F				     PIC X.
   433		  02  FILLER REDEFINES UD1F.
   434		      03  UD1A				     PIC X.
   435		  02  UD1I				     PIC X(008).
   436		  02  UD2L				     PIC S9(4) COMP.
   437		  02  UD2F				     PIC X.
   438		  02  FILLER REDEFINES UD2F.
   439		      03  UD2A				     PIC X.
   440		  02  UD2I				     PIC X(008).
   441		  02  UD3L				     PIC S9(4) COMP.
   442		  02  UD3F				     PIC X.
   443		  02  FILLER REDEFINES UD3F.
   444		      03  UD3A				     PIC X.
   445		  02  UD3I				     PIC X(008).
   446		  02  UD4L				     PIC S9(4) COMP.
   447		  02  UD4F				     PIC X.
   448		  02  FILLER REDEFINES UD4F.
   449		      03  UD4A				     PIC X.
   450		  02  UD4I				     PIC X(008).
   451		  02  UD5L				     PIC S9(4) COMP.
   452		  02  UD5F				     PIC X.
   453		  02  FILLER REDEFINES UD5F.
   454		      03  UD5A				     PIC X.
   455		  02  UD5I				     PIC X(008).
   456		  02  UD6L				     PIC S9(4) COMP.
   457		  02  UD6F				     PIC X.
   458		  02  FILLER REDEFINES UD6F.
   459		      03  UD6A				     PIC X.
   460		  02  UD6I				     PIC X(008).
   461		  02  UD7L				     PIC S9(4) COMP.
   462		  02  UD7F				     PIC X.
   463		  02  FILLER REDEFINES UD7F.
   464		      03  UD7A				     PIC X.
   465		  02  UD7I				     PIC X(008).
   466		  02  UD8L				     PIC S9(4) COMP.
   467		  02  UD8F				     PIC X.
   468		  02  FILLER REDEFINES UD8F.
   469		      03  UD8A				     PIC X.
   470		  02  UD8I				     PIC X(008).
   471		  02  UD9L				     PIC S9(4) COMP.
   472		  02  UD9F				     PIC X.
   473		  02  FILLER REDEFINES UD9F.
   474		      03  UD9A				     PIC X.
   475		  02  UD9I				     PIC X(008).
   476		  02  UD10L				     PIC S9(4) COMP.
   477		  02  UD10F				     PIC X.
   478		  02  FILLER REDEFINES UD10F.
   479		      03  UD10A 			     PIC X.
   480		  02  UD10I				     PIC X(008).
   481		  02  UD11L				     PIC S9(4) COMP.
   482		  02  UD11F				     PIC X.
   483		  02  FILLER REDEFINES UD11F.
   484		      03  UD11A 			     PIC X.   485		  02  UD11I				     PIC X(008).
   486		  02  UB1L				     PIC S9(4) COMP.
   487		  02  UB1F				     PIC X.
   488		  02  FILLER REDEFINES UB1F.
   489		      03  UB1A				     PIC X.
   490		  02  UB1I				     PIC X(007).
   491		  02  UB2L				     PIC S9(4) COMP.
   492		  02  UB2F				     PIC X.
   493		  02  FILLER REDEFINES UB2F.
   494		      03  UB2A				     PIC X.
   495		  02  UB2I				     PIC X(007).
   496		  02  UB3L				     PIC S9(4) COMP.
   497		  02  UB3F				     PIC X.
   498		  02  FILLER REDEFINES UB3F.
   499		      03  UB3A				     PIC X.
   500		  02  UB3I				     PIC X(007).
   501		  02  UB4L				     PIC S9(4) COMP.
   502		  02  UB4F				     PIC X.
   503		  02  FILLER REDEFINES UB4F.
   504		      03  UB4A				     PIC X.
   505		  02  UB4I				     PIC X(007).
   506		  02  UB5L				     PIC S9(4) COMP.
   507		  02  UB5F				     PIC X.
   508		  02  FILLER REDEFINES UB5F.
   509		      03  UB5A				     PIC X.
   510		  02  UB5I				     PIC X(007).
   511		  02  UB6L				     PIC S9(4) COMP.
   512		  02  UB6F				     PIC X.
   513		  02  FILLER REDEFINES UB6F.
   514		      03  UB6A				     PIC X.
   515		  02  UB6I				     PIC X(007).
   516		  02  UB7L				     PIC S9(4) COMP.
   517		  02  UB7F				     PIC X.
   518		  02  FILLER REDEFINES UB7F.
   519		      03  UB7A				     PIC X.
   520		  02  UB7I				     PIC X(007).
   521		  02  UB8L				     PIC S9(4) COMP.
   522		  02  UB8F				     PIC X.
   523		  02  FILLER REDEFINES UB8F.
   524		      03  UB8A				     PIC X.
   525		  02  UB8I				     PIC X(007).
   526		  02  UB9L				     PIC S9(4) COMP.
   527		  02  UB9F				     PIC X.
   528		  02  FILLER REDEFINES UB9F.
   529		      03  UB9A				     PIC X.
   530		  02  UB9I				     PIC X(007).
   531		  02  UB10L				     PIC S9(4) COMP.
   532		  02  UB10F				     PIC X.
   533		  02  FILLER REDEFINES UB10F.
   534		      03  UB10A 			     PIC X.
   535		  02  UB10I				     PIC X(007).
   536		  02  UB11L				     PIC S9(4) COMP.
   537		  02  UB11F				     PIC X.
   538		  02  FILLER REDEFINES UB11F.
   539		      03  UB11A 			     PIC X.
   540		  02  UB11I				     PIC X(007).
   541		  02  MSGL				     PIC S9(4) COMP.
   542		  02  MSGF				     PIC X.
   543		  02  FILLER REDEFINES MSGF.
   544		      03  MSGA				     PIC X.   545		  02  MSGI				     PIC X(060).
   546		  02  ADDL				     PIC S9(4) COMP.
   547		  02  ADDF				     PIC X.
   548		  02  FILLER REDEFINES ADDF.
   549		      03  ADDA				     PIC X.
   550		  02  ADDI				     PIC X(009).
   551		  02  EXITL				     PIC S9(4) COMP.
   552		  02  EXITF				     PIC X.
   553		  02  FILLER REDEFINES EXITF.
   554		      03  EXITA 			     PIC X.
   555		  02  EXITI				     PIC X(010).
   556		  02  FINDL				     PIC S9(4) COMP.
   557		  02  FINDF				     PIC X.
   558		  02  FILLER REDEFINES FINDF.
   559		      03  FINDA 			     PIC X.
   560		  02  FINDI				     PIC X(010).
   561		  02  UPL				     PIC S9(4) COMP.
   562		  02  UPF				     PIC X.
   563		  02  FILLER REDEFINES UPF.
   564		      03  UPA				     PIC X.
   565		  02  UPI				     PIC X(008).
   566		  02  DOWNL				     PIC S9(4) COMP.
   567		  02  DOWNF				     PIC X.
   568		  02  FILLER REDEFINES DOWNF.
   569		      03  DOWNA 			     PIC X.
   570		  02  DOWNI				     PIC X(010).
   571		  02  RESETL				     PIC S9(4) COMP.
   572		  02  RESETF				     PIC X.
   573		  02  FILLER REDEFINES RESETF.
   574		      03  RESETA			     PIC X.
   575		  02  RESETI				     PIC X(012).
   576	      01  SM001MO REDEFINES SM001MI.
   577		  02  FILLER				     PIC X(12).
   578		  02  FILLER				     PIC XX.
   579		  02  FILLER				     PIC X.
   580		  02  DATEO				     PIC X(010).
   581		  02  FILLER				     PIC XX.
   582		  02  FILLER				     PIC X.
   583		  02  PAGEO				     PIC X(002).
   584		  02  FILLER				     PIC XX.
   585		  02  FILLER				     PIC X.
   586		  02  TIMEO				     PIC X(008).
   587		  02  FILLER				     PIC XX.
   588		  02  FILLER				     PIC X.
   589		  02  TITLEO				     PIC X(020).
   590		  02  FILLER				     PIC XX.
   591		  02  FILLER				     PIC X.
   592		  02  STATUSO				     PIC X(007).
   593		  02  FILLER				     PIC XX.
   594		  02  FILLER				     PIC X.
   595		  02  TODATEO				     PIC X(008).
   596		  02  FILLER				     PIC XX.
   597		  02  FILLER				     PIC X.
   598		  02  FRDATEO				     PIC X(008).
   599		  02  FILLER				     PIC XX.
   600		  02  FILLER				     PIC X.
   601		  02  UC1O				     PIC X(001).
   602		  02  FILLER				     PIC XX.
   603		  02  FILLER				     PIC X.
   604		  02  UC2O				     PIC X(001).   605		  02  FILLER				     PIC XX.
   606		  02  FILLER				     PIC X.
   607		  02  UC3O				     PIC X(001).
   608		  02  FILLER				     PIC XX.
   609		  02  FILLER				     PIC X.
   610		  02  UC4O				     PIC X(001).
   611		  02  FILLER				     PIC XX.
   612		  02  FILLER				     PIC X.
   613		  02  UC5O				     PIC X(001).
   614		  02  FILLER				     PIC XX.
   615		  02  FILLER				     PIC X.
   616		  02  UC6O				     PIC X(001).
   617		  02  FILLER				     PIC XX.
   618		  02  FILLER				     PIC X.
   619		  02  UC7O				     PIC X(001).
   620		  02  FILLER				     PIC XX.
   621		  02  FILLER				     PIC X.
   622		  02  UC8O				     PIC X(001).
   623		  02  FILLER				     PIC XX.
   624		  02  FILLER				     PIC X.
   625		  02  UC9O				     PIC X(001).
   626		  02  FILLER				     PIC XX.
   627		  02  FILLER				     PIC X.
   628		  02  UC10O				     PIC X(001).
   629		  02  FILLER				     PIC XX.
   630		  02  FILLER				     PIC X.
   631		  02  UC11O				     PIC X(001).
   632		  02  FILLER				     PIC XX.
   633		  02  FILLER				     PIC X.
   634		  02  TN1O				     PIC X(006).
   635		  02  FILLER				     PIC XX.
   636		  02  FILLER				     PIC X.
   637		  02  TN2O				     PIC X(006).
   638		  02  FILLER				     PIC XX.
   639		  02  FILLER				     PIC X.
   640		  02  TN3O				     PIC X(006).
   641		  02  FILLER				     PIC XX.
   642		  02  FILLER				     PIC X.
   643		  02  TN4O				     PIC X(006).
   644		  02  FILLER				     PIC XX.
   645		  02  FILLER				     PIC X.
   646		  02  TN5O				     PIC X(006).
   647		  02  FILLER				     PIC XX.
   648		  02  FILLER				     PIC X.
   649		  02  TN6O				     PIC X(006).
   650		  02  FILLER				     PIC XX.
   651		  02  FILLER				     PIC X.
   652		  02  TN7O				     PIC X(006).
   653		  02  FILLER				     PIC XX.
   654		  02  FILLER				     PIC X.
   655		  02  TN8O				     PIC X(006).
   656		  02  FILLER				     PIC XX.
   657		  02  FILLER				     PIC X.
   658		  02  TN9O				     PIC X(006).
   659		  02  FILLER				     PIC XX.
   660		  02  FILLER				     PIC X.
   661		  02  TN10O				     PIC X(006).
   662		  02  FILLER				     PIC XX.
   663		  02  FILLER				     PIC X.
   664		  02  TN11O				     PIC X(006).   665		  02  FILLER				     PIC XX.
   666		  02  FILLER				     PIC X.
   667		  02  TT1O				     PIC X(020).
   668		  02  FILLER				     PIC XX.
   669		  02  FILLER				     PIC X.
   670		  02  TT2O				     PIC X(020).
   671		  02  FILLER				     PIC XX.
   672		  02  FILLER				     PIC X.
   673		  02  TT3O				     PIC X(020).
   674		  02  FILLER				     PIC XX.
   675		  02  FILLER				     PIC X.
   676		  02  TT4O				     PIC X(020).
   677		  02  FILLER				     PIC XX.
   678		  02  FILLER				     PIC X.
   679		  02  TT5O				     PIC X(020).
   680		  02  FILLER				     PIC XX.
   681		  02  FILLER				     PIC X.
   682		  02  TT6O				     PIC X(020).
   683		  02  FILLER				     PIC XX.
   684		  02  FILLER				     PIC X.
   685		  02  TT7O				     PIC X(020).
   686		  02  FILLER				     PIC XX.
   687		  02  FILLER				     PIC X.
   688		  02  TT8O				     PIC X(020).
   689		  02  FILLER				     PIC XX.
   690		  02  FILLER				     PIC X.
   691		  02  TT9O				     PIC X(020).
   692		  02  FILLER				     PIC XX.
   693		  02  FILLER				     PIC X.
   694		  02  TT10O				     PIC X(020).
   695		  02  FILLER				     PIC XX.
   696		  02  FILLER				     PIC X.
   697		  02  TT11O				     PIC X(020).
   698		  02  FILLER				     PIC XX.
   699		  02  FILLER				     PIC X.
   700		  02  ST1O				     PIC X(010).
   701		  02  FILLER				     PIC XX.
   702		  02  FILLER				     PIC X.
   703		  02  ST2O				     PIC X(010).
   704		  02  FILLER				     PIC XX.
   705		  02  FILLER				     PIC X.
   706		  02  ST3O				     PIC X(010).
   707		  02  FILLER				     PIC XX.
   708		  02  FILLER				     PIC X.
   709		  02  ST4O				     PIC X(010).
   710		  02  FILLER				     PIC XX.
   711		  02  FILLER				     PIC X.
   712		  02  ST5O				     PIC X(010).
   713		  02  FILLER				     PIC XX.
   714		  02  FILLER				     PIC X.
   715		  02  ST6O				     PIC X(010).
   716		  02  FILLER				     PIC XX.
   717		  02  FILLER				     PIC X.
   718		  02  ST7O				     PIC X(010).
   719		  02  FILLER				     PIC XX.
   720		  02  FILLER				     PIC X.
   721		  02  ST8O				     PIC X(010).
   722		  02  FILLER				     PIC XX.
   723		  02  FILLER				     PIC X.
   724		  02  ST9O				     PIC X(010).   725		  02  FILLER				     PIC XX.
   726		  02  FILLER				     PIC X.
   727		  02  ST10O				     PIC X(010).
   728		  02  FILLER				     PIC XX.
   729		  02  FILLER				     PIC X.
   730		  02  ST11O				     PIC X(010).
   731		  02  FILLER				     PIC XX.
   732		  02  FILLER				     PIC X.
   733		  02  UD1O				     PIC X(008).
   734		  02  FILLER				     PIC XX.
   735		  02  FILLER				     PIC X.
   736		  02  UD2O				     PIC X(008).
   737		  02  FILLER				     PIC XX.
   738		  02  FILLER				     PIC X.
   739		  02  UD3O				     PIC X(008).
   740		  02  FILLER				     PIC XX.
   741		  02  FILLER				     PIC X.
   742		  02  UD4O				     PIC X(008).
   743		  02  FILLER				     PIC XX.
   744		  02  FILLER				     PIC X.
   745		  02  UD5O				     PIC X(008).
   746		  02  FILLER				     PIC XX.
   747		  02  FILLER				     PIC X.
   748		  02  UD6O				     PIC X(008).
   749		  02  FILLER				     PIC XX.
   750		  02  FILLER				     PIC X.
   751		  02  UD7O				     PIC X(008).
   752		  02  FILLER				     PIC XX.
   753		  02  FILLER				     PIC X.
   754		  02  UD8O				     PIC X(008).
   755		  02  FILLER				     PIC XX.
   756		  02  FILLER				     PIC X.
   757		  02  UD9O				     PIC X(008).
   758		  02  FILLER				     PIC XX.
   759		  02  FILLER				     PIC X.
   760		  02  UD10O				     PIC X(008).
   761		  02  FILLER				     PIC XX.
   762		  02  FILLER				     PIC X.
   763		  02  UD11O				     PIC X(008).
   764		  02  FILLER				     PIC XX.
   765		  02  FILLER				     PIC X.
   766		  02  UB1O				     PIC X(007).
   767		  02  FILLER				     PIC XX.
   768		  02  FILLER				     PIC X.
   769		  02  UB2O				     PIC X(007).
   770		  02  FILLER				     PIC XX.
   771		  02  FILLER				     PIC X.
   772		  02  UB3O				     PIC X(007).
   773		  02  FILLER				     PIC XX.
   774		  02  FILLER				     PIC X.
   775		  02  UB4O				     PIC X(007).
   776		  02  FILLER				     PIC XX.
   777		  02  FILLER				     PIC X.
   778		  02  UB5O				     PIC X(007).
   779		  02  FILLER				     PIC XX.
   780		  02  FILLER				     PIC X.
   781		  02  UB6O				     PIC X(007).
   782		  02  FILLER				     PIC XX.
   783		  02  FILLER				     PIC X.
   784		  02  UB7O				     PIC X(007).   785		  02  FILLER				     PIC XX.
   786		  02  FILLER				     PIC X.
   787		  02  UB8O				     PIC X(007).
   788		  02  FILLER				     PIC XX.
   789		  02  FILLER				     PIC X.
   790		  02  UB9O				     PIC X(007).
   791		  02  FILLER				     PIC XX.
   792		  02  FILLER				     PIC X.
   793		  02  UB10O				     PIC X(007).
   794		  02  FILLER				     PIC XX.
   795		  02  FILLER				     PIC X.
   796		  02  UB11O				     PIC X(007).
   797		  02  FILLER				     PIC XX.
   798		  02  FILLER				     PIC X.
   799		  02  MSGO				     PIC X(060).
   800		  02  FILLER				     PIC XX.
   801		  02  FILLER				     PIC X.
   802		  02  ADDO				     PIC X(009).
   803		  02  FILLER				     PIC XX.
   804		  02  FILLER				     PIC X.
   805		  02  EXITO				     PIC X(010).
   806		  02  FILLER				     PIC XX.
   807		  02  FILLER				     PIC X.
   808		  02  FINDO				     PIC X(010).
   809		  02  FILLER				     PIC XX.
   810		  02  FILLER				     PIC X.
   811		  02  UPO				     PIC X(008).
   812		  02  FILLER				     PIC XX.
   813		  02  FILLER				     PIC X.
   814		  02  DOWNO				     PIC X(010).
   815		  02  FILLER				     PIC XX.
   816		  02  FILLER				     PIC X.
   817		  02  RESETO				     PIC X(012).
   819	      01  WS-SM001 REDEFINES SM001MI.
   820		  05  FILLER		      PIC X(96).
   821		  05  UC  OCCURS 11.
   822		      10  UCL		      PIC S9(4) COMP.
   823		      10  UCF		      PIC X.
   824		      10  FILLER REDEFINES UCF.
   825			  15  UCA	      PIC X.
   826		      10  UCI		      PIC X(001).
   827		  05  TN  OCCURS 11.
   828		      10  TNL		      PIC S9(4) COMP.
   829		      10  TNF		      PIC X.
   830		      10  FILLER REDEFINES TNF.
   831			  15  TNA	      PIC X.
   832		      10  TNI		      PIC X(006).
   833		  05  TT     OCCURS 11.
   834		      10  TTL		     PIC S9(4) COMP.
   835		      10  TTF		     PIC X.
   836		      10  FILLER REDEFINES TTF.
   837			  15  TTA	     PIC X.
   838		      10  TTI		     PIC X(020).
   839		  05  ST     OCCURS 11.
   840		      10  STL		     PIC S9(4) COMP.
   841		      10  STF		     PIC X.
   842		      10  FILLER REDEFINES STF.
   843			  15 STA	     PIC X.
   844		      10  STI		     PIC X(010).
   845		  05  UD      OCCURS 11.   846		      10  UDL		    PIC S9(4) COMP.
   847		      10  UDF		    PIC X.
   848		      10  FILLER REDEFINES UDF.
   849			  15  UDA	    PIC X.
   850		      10  UDI		    PIC X(008).
   851		  05  UB     OCCURS 11.
   852		      10  UBL		     PIC S9(4) COMP.
   853		      10  UBF		     PIC X.
   854		      10  FILLER REDEFINES UBF.
   855			  15  UBA	     PIC X.
   856		      10  UBI		     PIC X(007).
   857
   858	     *
   859	      COPY DFHAID.
   861	      01  DFHAID.
   862	     *
   863	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   864	     *
   865	     * Revision Information
   866	     * ^{File:dfhaid.cob  }
   867	     * ^{Timestamp:Thu May 15 14:02:52 1997}
   868	     * ^{Revision:2.0}
   869	     *
   870	     *This is the AID constants copy file
   871	     *
   872            05  DFHENTER                  PIC X VALUE ''''.
   873	     *					value APOST
   874            05  DFHCLEAR                  PIC X VALUE '_'.
   875            05  DFHPA1                    PIC X VALUE '%'.
   876            05  DFHPA2                    PIC X VALUE '>'.
   877            05  DFHPA3                    PIC X VALUE ','.
   878            05  DFHPF1                    PIC X VALUE '1'.
   879            05  DFHPF2                    PIC X VALUE '2'.
   880            05  DFHPF3                    PIC X VALUE '3'.
   881            05  DFHPF4                    PIC X VALUE '4'.
   882            05  DFHPF5                    PIC X VALUE '5'.
   883            05  DFHPF6                    PIC X VALUE '6'.
   884            05  DFHPF7                    PIC X VALUE '7'.
   885            05  DFHPF8                    PIC X VALUE '8'.
   886            05  DFHPF9                    PIC X VALUE '9'.
   887            05  DFHPF10                   PIC X VALUE ':'.
   888            05  DFHPF11                   PIC X VALUE '#'.
   889            05  DFHPF12                   PIC X VALUE '@'.
   890            05  DFHPF13                   PIC X VALUE 'A'.
   891            05  DFHPF14                   PIC X VALUE 'B'.
   892            05  DFHPF15                   PIC X VALUE 'C'.
   893            05  DFHPF16                   PIC X VALUE 'D'.
   894            05  DFHPF17                   PIC X VALUE 'E'.
   895            05  DFHPF18                   PIC X VALUE 'F'.
   896            05  DFHPF19                   PIC X VALUE 'G'.
   897            05  DFHPF20                   PIC X VALUE 'H'.
   898            05  DFHPF21                   PIC X VALUE 'I'.
   899            05  DFHPF22                   PIC X VALUE '›'.
   900       *                                  EBCDIC Cent sign x'4A'
   901       *                                  ASCII  Cent sign x'9B'
   902            05  DFHPF23                   PIC X VALUE '.'.
   903            05  DFHPF24                   PIC X VALUE '<'.
   904            05  DFHOPID                   PIC X VALUE 'W'.
   905            05  DFHMSRE                   PIC X VALUE 'X'.
   906            05  DFHTRIG                   PIC X VALUE '"'.   907       *                                        value QUOTE  "
   908            05  DFHPEN                    PIC X VALUE '='.
   909            05  DFHCLRP                   PIC X VALUE 'Ý'.
   910       *                                  EBCDIC x'6A'
   911       *                                  ASCII  x'DD'
   912            05  DFHSTRF                   PIC X VALUE 'h'.
   913	     *	  DFHQUIT is a CA-Realia CICS Extension
   914	     *	  It is set by using <Ctrl>+C or <Ctrl>+<Break> Keys
   915            05  DFHQUIT                   PIC X VALUE '!'.
   916		  05  DFHNULL			PIC X VALUE LOW-VALUE.
   918	     *
   919	      COPY DFHBMSCA.
   921	      01  DFHBMSCA.
   922	     *
   923	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   924	     *
   925	     * Revision Information
   926	     * ^{File:dfhbmsca.cob}
   927	     * ^{Timestamp:Tue Oct 08 15:34:54 1996}
   928	     * ^{Revision:2.0}
   929	     *
   930	     *	Note:This FILE is provided with most values as quoted literals
   931	     *	     so that the file can be used for both ASCII and EBCDIC
   932	     *	     programs
   933	     *
   934	     *	     The only exceptions are some 3270 Data Stream Orders
   935	     *	     They use different Hexadecimal values for ASCII and
   936	     *	     EBCDIC and they cannot be expressed as quoted literals
   937	     *	     as the values are <Line Feed>, <Tab>, <End of File> etc.
   938	     *	     characters in ASCII
   939	     *
   940	     *	     They have their values set up to default to the EBCDIC
   941	     *	     values.
   942	     *
   943	     *	     3270 orders are only needed for EXEC CICS SEND and RECEIVE
   944	     *	     and SEND TEXT with imbedded format orders.
   945	     *	     If you use these values in ASCII programs the values
   946	     *	     must be changed.
   947	     *
   948	     *	     An alternative is to use REPLACING to change the values.
   949	     *
   950	     *	  i.e. COPY DFHBMSCA replacing
   951	     *			    ==005== BY ==009==	*> DFHPT
   952	     *			    ==021== BY ==010==	*> DFHNL
   953	     *			    ==040== BY ==021==	*> DFHSA
   954	     *			    ==041== BY ==031==	*> DFHSFE
   955	     *			    ==044== BY ==023==	*> DFHMF
   956	     *			    ==060== BY ==020==	*> DFHRA
   957	     *			    ==063== BY ==026==. *> DFHSUB
   958	     *
   959	     ******************************************************************
   960	     *BMS and Terminal Control - Order & Attributes constants	      *
   961	     ******************************************************************
   962	     *
   963	     *	  Field Attributes
   964	     *
   965            05  DFHBMASB                          PIC X VALUE '8'.
   966            05  DFHBMASF                          PIC X VALUE '1'.
   967            05  DFHBMASK                          PIC X VALUE '0'.
   968            05  DFHBMBRY                          PIC X VALUE 'H'.   969            05  DFHBMDAR                          PIC X VALUE '<'.
   970            05  DFHBMFSE                          PIC X VALUE 'A'.
   971            05  DFHBMPRF                          PIC X VALUE '/'.
   972            05  DFHBMPRO                          PIC X VALUE '-'.
   973            05  DFHBMUNN                          PIC X VALUE '&'.
   974            05  DFHBMUNP                          PIC X VALUE ' '.
   975            05  DFHUNNUM                          PIC X VALUE 'J'.
   976	     *
   977	     *	  partially supported
   978	     *
   979            05  DFHUNNOD                          PIC X VALUE '('.
   980            05  DFHUNIMD                          PIC X VALUE 'I'.
   981            05  DFHUNINT                          PIC X VALUE 'R'.
   982            05  DFHUNNON                          PIC X VALUE '('.
   983            05  DFHPROTI                          PIC X VALUE 'Y'.
   984            05  DFHPROTN                          PIC X VALUE '%'.
   985	     *
   986	     *	  These values are additions to mainframe constants
   987	     *
   988            05  DFHBMS-ASK-DARK                   PIC X VALUE '@'.
   989            05  DFHBMS-ASK-BRY-FSET               PIC X VALUE '9'.
   990            05  DFHBMS-ASK-DAR-FSET               PIC X VALUE ''''.
   991	     *						      VALUE APOST
   992            05  DFHBMS-PRO-BRY-FSET               PIC X VALUE 'Z'.
   993            05  DFHBMS-PRO-DAR-FSET               PIC X VALUE '_'.
   994            05  DFHBMS-NUM-BRY                    PIC X VALUE 'Q'.
   995            05  DFHBMS-NUM-DAR                    PIC X VALUE '*'.
   996            05  DFHBMS-NUM-DAR-FSET               PIC X VALUE ')'.
   997	     *
   998	     *	  Field Flag values
   999		  05  DFHBMEOF-VAL VALUE 128		PIC S9(4) COMP-4.
  1000		  05  FILLER REDEFINES DFHBMEOF-VAL.
  1001		      10  FILLER			PIC X.
  1002		      10  DFHBMEOF			PIC X.
  1003       *                                          x'80'.
  1004		  05  DFHBMCUR-VAL VALUE 002		PIC S9(4) COMP-4.
  1005		  05  FILLER REDEFINES DFHBMCUR-VAL.
  1006		      10  FILLER			PIC X.
  1007		      10  DFHBMCUR			PIC X.
  1008       *                                          x'02'.
  1009		  05  DFHBMMEC-VAL VALUE 130		PIC S9(4) COMP-4.
  1010		  05  FILLER REDEFINES DFHBMMEC-VAL.
  1011		      10  FILLER			PIC X.
  1012		      10  DFHBMMEC			PIC X.
  1013       *                                          x'82'.
  1014       *                                          x'02'.
  1015		  05  DFHBMFLG-VAL  VALUE 0		PIC S9(4) COMP-4.
  1016		      88  DFHERASE			VALUES 128 130.
  1017       *                                          x'80' X'82'
  1018		      88  DFHCURSR			VALUES 002 130.
  1019       *                                          x'02' X'82'
  1020		  05  FILLER REDEFINES DFHBMFLG-VAL.
  1021		      10  FILLER			PIC X.
  1022		      10  DFHBMFLG			PIC X.
  1023
  1024		  05  DFHBMDUP-VAL VALUE 028		PIC S9(4) COMP-4.
  1025		  05  FILLER REDEFINES DFHBMDUP-VAL.
  1026		      10  FILLER			PIC X.
  1027		      10  DFHBMDUP			PIC X.
  1028       *                                              x'1C'  1029	     *
  1030	     ******************************************************************
  1031	     *	  supported 327X Extended Attributes
  1032	     *
  1033	     *	  Extended COLOR Attributes
  1034	     *
  1035            05  DFHDFCOL                          PIC X VALUE '0'.
  1036            05  DFHBLUE                           PIC X VALUE '1'.
  1037            05  DFHRED                            PIC X VALUE '2'.
  1038            05  DFHPINK                           PIC X VALUE '3'.
  1039            05  DFHGREEN                          PIC X VALUE '4'.
  1040            05  DFHTURQ                           PIC X VALUE '5'.
  1041            05  DFHYELLO                          PIC X VALUE '6'.
  1042            05  DFHNEUTR                          PIC X VALUE '7'.
  1043	     *
  1044	     *	  Extended HILIGHT Attributes
  1045	     *
  1046            05  DFHDFHI                           PIC X VALUE '0'.
  1047            05  DFHBLINK                          PIC X VALUE '1'.
  1048            05  DFHREVRS                          PIC X VALUE '2'.
  1049            05  DFHUNDLN                          PIC X VALUE '4'.
  1050	     *
  1051	     ******************************************************************
  1052	     *	  supported 327X Data Stream Orders
  1053	     *
  1054		  05  DFHSBA-VAL VALUE 017		 PIC S9(4) COMP-4.
  1055		  05  FILLER REDEFINES DFHSBA-VAL.
  1056		      10  FILLER			PIC X.
  1057		      10  DFHSBA			PIC X.
  1058       *                                              x'11'
  1059		  05  DFHEUA-VAL VALUE 018		PIC S9(4) COMP-4.
  1060		  05  FILLER REDEFINES DFHEUA-VAL.
  1061		      10  FILLER			PIC X.
  1062		      10  DFHEUA			PIC X.
  1063       *                                              x'12'
  1064		  05  DFHIC-VAL VALUE 019		PIC S9(4) COMP-4.
  1065		  05  FILLER REDEFINES DFHIC-VAL.
  1066		      10  FILLER			PIC X.
  1067		      10  DFHIC 			PIC X.
  1068       *                                              X'13'.
  1069		  05  DFHSF-VAL VALUE 029		PIC S9(4) COMP-4.
  1070		  05  FILLER REDEFINES DFHSF-VAL.
  1071		      10  FILLER			PIC X.
  1072		      10  DFHSF 			PIC X.
  1073       *                                              X'1D'.
  1074		  05  DFHPT-VAL VALUE 005		PIC S9(4) COMP-4.
  1075		      88 DFHPT-VAL-EBCDIC		VALUE 5.
  1076		      88 DFHPT-VAL-ASCII		VALUE 9.
  1077		  05  FILLER REDEFINES DFHPT-VAL.
  1078		      10  FILLER			PIC X.
  1079		      10  DFHPT 			PIC X.
  1080       *                                              EBCDIC X'05'.
  1081       *                                              ASCII  X'09'.
  1082		  05  DFHRA-VAL VALUE 060		PIC S9(4) COMP-4.
  1083		      88 DFHRA-VAL-EBCDIC		VALUE 60.
  1084		      88 DFHRA-VAL-ASCII		VALUE 20.
  1085		  05  FILLER REDEFINES DFHRA-VAL.
  1086		      10  FILLER			PIC X.
  1087		      10  DFHRA 			PIC X.
  1088       *                                              EBCDIC x'3C'  1089       *                                              ASCII  x'14'
  1090		  05  DFHSFE-VAL VALUE 041		PIC S9(4) COMP-4.
  1091		      88 DFHSFE-VAL-EBCDIC		VALUE 41.
  1092		      88 DFHSFE-VAL-ASCII		VALUE 31.
  1093		  05  FILLER REDEFINES DFHSFE-VAL.
  1094		      10  FILLER			PIC X.
  1095		      10  DFHSFE			PIC X.
  1096       *                                              EBCDIC x'29'
  1097       *                                              ASCII  x'1F'
  1098		  05  DFHMF-VAL VALUE 044		PIC S9(4) COMP-4.
  1099		      88 DFHMF-VAL-EBCDIC		VALUE 44.
  1100		      88 DFHMF-VAL-ASCII		VALUE 23.
  1101		  05  FILLER REDEFINES DFHMF-VAL.
  1102		      10  FILLER			PIC X.
  1103		      10  DFHMF 			PIC X.
  1104       *                                              EBCDIC x'2C'
  1105       *                                              ASCII  x'17'
  1106	     *
  1107	     ******************************************************************
  1108	     *	  unsupported 327X Data Stream order codes
  1109	     *
  1110		  05  DFHSA-VAL VALUE 040		PIC S9(4) COMP-4.
  1111		      88 DFHSA-VAL-EBCDIC		VALUE 40.
  1112		      88 DFHSA-VAL-ASCII		VALUE 21.
  1113		  05  FILLER REDEFINES DFHSA-VAL.
  1114		      10  FILLER			PIC X.
  1115		      10  DFHSA 			PIC X.
  1116       *                                              EBCDIC x'28'
  1117       *                                              ASCII  x'15'
  1118		  05  DFHGE-VAL VALUE 008		PIC S9(4) COMP-4.
  1119		  05  FILLER REDEFINES DFHGE-VAL.
  1120		      10  FILLER			PIC X.
  1121		      10  DFHGE 			PIC X.
  1122       *                                              X'08'.
  1123	     *
  1124	     ******************************************************************
  1125	     *	  SFE and MF supported attribute types
  1126	     *
  1127            05  DFHCOLOR                          PIC X VALUE 'ƒ'.
  1128       *                                              EBCDIC x'42'
  1129       *                                              ASCII  x'83'
  1130            05  DFHHLT                            PIC X VALUE 'Ö'.
  1131       *                                              EBCDIC x'41'
  1132       *                                              ASCII  x'D6'
  1133            05  DFH3270                           PIC X VALUE '{'.
  1134	     *
  1135	     *	  supported for SEND TEXT command and printer terminal
  1136	     *
  1137		  05  DFHBMPNL-VAL VALUE 021		PIC S9(4) COMP-4.
  1138		      88 DFHBMPNL-VAL-EBCDIC		VALUE 21.
  1139		      88 DFHBMPNL-VAL-ASCII		VALUE 10.
  1140		  05  FILLER REDEFINES DFHBMPNL-VAL.
  1141		      10  FILLER			PIC X.
  1142		      10  DFHBMPNL			PIC X.
  1143       *                                              EBCDIC X'15'.
  1144       *                                              ASCII  X'0A'.
  1145	     *
  1146	     ******************************************************************
  1147	     *	  Printer terminal data stream only
  1148	     *  1149		  05  DFHBMPFF-VAL VALUE 012		PIC S9(4) COMP-4.
  1150		  05  FILLER REDEFINES DFHBMPFF-VAL.
  1151		      10  FILLER			PIC X.
  1152		      10  DFHBMPFF			PIC X.
  1153       *                                              X'0C'.
  1154		  05  DFHBMPCR-VAL VALUE 013		PIC S9(4) COMP-4.
  1155		  05  FILLER REDEFINES DFHBMPCR-VAL.
  1156		      10  FILLER			PIC X.
  1157		      10  DFHBMPCR			PIC X.
  1158       *                                              X'0D'.
  1159		  05  DFHBMPEM-VAL VALUE 025		PIC S9(4) COMP-4.
  1160		  05  FILLER REDEFINES DFHBMPEM-VAL.
  1161		      10  FILLER			PIC X.
  1162		      10  DFHBMPEM			PIC X.
  1163       *                                              X'19'.
  1164	     *
  1165	     ******************************************************************
  1166	     *	  unsupported Miscellaneous attributes and constants
  1167	     *
  1168		  05  DFHALL				PIC X VALUE LOW-VALUES.
  1169            05  DFHBASE                           PIC X VALUE '0'.
  1170		  05  DFHBMDET				PIC X VALUE LOW-VALUES.
  1171		  05  DFHBMPSOSI-VAL VALUE 3599 	PIC S9(4) COMP-4.
  1172		  05  FILLER REDEFINES DFHBMPSOSI-VAL.
  1173		      10  DFHBMPSO			PIC X.
  1174       *                                              X'0E'.
  1175		      10  DFHBMPSI			PIC X.
  1176       *                                              X'0F'.
  1177		  05  DFHDFT VALUE HIGH-VALUES		PIC X.
  1178            05  DFHERROR                          PIC X VALUE '¶'.
  1179       *                                              EBCDIC X'1A'.
  1180       *                                              ASCII  X'B6'.
  1181            05  DFHFIL                            PIC X VALUE '4'.
  1182            05  DFHMENT                           PIC X VALUE '2'.
  1183            05  DFHMET                            PIC X VALUE '3'.
  1184            05  DFHMFE                            PIC X VALUE '6'.
  1185            05  DFHMFET                           PIC X VALUE '7'.
  1186            05  DFHMFT                            PIC X VALUE '5'.
  1187            05  DFHMT                             PIC X VALUE '1'.
  1188            05  DFHOUTLN                          PIC X VALUE 'B'.
  1189            05  DFHPS                             PIC X VALUE '„'.
  1190       *                                              EBCDIC x'43'
  1191       *                                              ASCII  x'84'
  1192            05  DFHVAL                            PIC X VALUE 'A'.
  1193	     *
  1194		  05  DFHSUB-VAL   VALUE 063		PIC S9(4) COMP-4.
  1195		      88 DFHSUB-VAL-EBCDIC		VALUE 63.
  1196		      88 DFHSUB-VAL-ASCII		VALUE 26.
  1197		  05  FILLER REDEFINES DFHSUB-VAL.
  1198		      10  FILLER			PIC X.
  1199		      10  DFHSUB			PIC X.
  1200       *                                              EBCDIC X'3F'.
  1201       *                                              ASCII  X'1A'.
  1202	     *
  1203		  05  DFHFM-VAL    VALUE 030		PIC S9(4) COMP-4.
  1204		  05  FILLER REDEFINES DFHFM-VAL.
  1205		      10  FILLER			PIC X.
  1206		      10  DFHFM 			PIC X.
  1207       *                                              EBCDIC X'1E'.
  1208		  05  DFHEO VALUE HIGH-VALUE		PIC X.  1210
  1211	      LINKAGE SECTION.
  1213	      01  DFHEIBLK.						       R
  1214		  05 EIBTIME  PIC S9(7) COMP-3. 			       R
  1215		  05 EIBDATE  PIC S9(7) COMP-3. 			       R
  1216		  05 EIBTRNID PIC X(4). 				       R
  1217		  05 EIBTASKN PIC S9(7) COMP-3. 			       R
  1218		  05 EIBTRMID PIC X(4). 				       R
  1219		  05 DFHEIGDI PIC S9(4) COMP-4. 			       R
  1220		  05 EIBCPOSN PIC S9(4) COMP-4. 			       R
  1221		  05 EIBCALEN PIC S9(4) COMP-4. 			       R
  1222		  05 EIBAID   PIC X.					       R
  1223		  05 EIBFN    PIC X(2). 				       R
  1224		  05 EIBRCODE PIC X(6). 				       R
  1225		  05 EIBDS    PIC X(8). 				       R
  1226		  05 EIBREQID PIC X(8). 				       R
  1227		  05 EIBRSRCE PIC X(8). 				       R
  1228		  05 EIBSYNC  PIC X.					       R
  1229		  05 EIBFREE  PIC X.					       R
  1230		  05 EIBRECV  PIC X.					       R
  1231		  05 EIBSEND  PIC X.					       R
  1232		  05 EIBATT   PIC X.					       R
  1233		  05 EIBEOC   PIC X.					       R
  1234		  05 EIBFMH   PIC X.					       R
  1235		  05 EIBCOMPL PIC X.					       R
  1236		  05 EIBSIG   PIC X.					       R
  1237		  05 EIBCONF  PIC X.					       R
  1238		  05 EIBERR   PIC X.					       R
  1239		  05 EIBERRCD PIC X(4). 				       R
  1240		  05 EIBSYNRB PIC X.					       R
  1241		  05 EIBNODAT PIC X.					       R
  1242		  05 EIBRESP  PIC S9(8) COMP-4. 			       R
  1243		  05 EIBRESP2 PIC S9(8) COMP-4. 			       R
  1244		  05 EIBRLDBK PIC X.					       R
  1245		  05 EIBCARESERVED PIC X(32).				       R
  1247	       01  DFHCOMMAREA			      PIC X(322).
  1248	     *
  1249	      PROCEDURE DIVISION					       R
  1251		  USING DFHEIBLK DFHCOMMAREA.				       R
  1276	      100-PROCESS SECTION.
  1277            IF EIBTRNID = 'SM00' OR 'SM01' OR 'SM02' OR 'SM03' OR 'SM04'
  1278                           OR 'SM05' OR 'SM06'
  1279		      MOVE DFHCOMMAREA TO WS-COMMAREA
  1281		      EXEC CICS
  1282			IGNORE CONDITION ERROR
  1283		      END-EXEC
  1298
  1299		      IF EIBCALEN = +0
  1300			  STRING EIBTRMID DELIMITED BY SIZE
  1301				  EIBTRNID DELIMITED BY SIZE
  1302			      INTO WS-QNAME
  1303			  MOVE LENGTH OF SM001MI TO WS-LENGTH
  1304			  MOVE 1 TO WS-PAGE
  1305			  MOVE WS-PAGE TO PAGEO
  1306			  PERFORM 999-MOVE-FILE-TO-Q
  1307			  PERFORM 500-MOVE-Q-TO-SCREEN
  1308			  PERFORM 100-NEW-MAP
  1309		      ELSE
  1311			   EXEC CICS
  1312                          RECEIVE MAP ('SM001M')  1313                          MAPSET ('SM001S')
  1314				INTO (SM001MI)
  1315			    END-EXEC
  1349			   IF  NOT EIBRESP = DFHRESP(MAPFAIL)
  1351			   IF  NOT EIBRESP =	     036		       R
  1352			       EVALUATE EIBAID
  1353				WHEN DFHPF2
  1354				   PERFORM 240-WHENF2
  1355				WHEN DFHPF3
  1357				   EXEC CICS DELETEQ TS
  1358					QUEUE(WS-QNAME)
  1359				   END-EXEC
  1379				   EXEC CICS SEND TEXT
  1380				      FROM(WS-FILLER)
  1381				      LENGTH(+500)
  1382				      ERASE
  1383				   END-EXEC
  1414				   EXEC CICS XCTL
  1415                                PROGRAM('SM000P')
  1416				   END-EXEC
  1435			       WHEN DFHENTER
  1436				   PERFORM 250-WHENENTER
  1437			       WHEN DFHPF5
  1438			       WHEN DFHPF7
  1439				   PERFORM 220-WHENF7
  1440			       WHEN DFHPF8
  1441				   PERFORM 230-WHENF8
  1442			       WHEN DFHPF12
  1443				   PERFORM 270-WHENF12
  1444			       WHEN OTHER
  1445                             MOVE 'INVALID PFKEY PRESSED' TO MSGO
  1446			       END-EVALUATE
  1447			  ELSE
  1448                        MOVE 'INVALID PFKEY PRESSED' TO MSGO
  1449			      PERFORM 500-MOVE-Q-TO-SCREEN
  1450			      PERFORM 100-NEW-MAP
  1451			  END-IF
  1452		      END-IF
  1453		  ELSE
  1455		      EXEC CICS SEND TEXT
  1456			      FROM (WS-INVKEY)
  1457			      LENGTH (22)
  1458			      ERASE
  1459		      END-EXEC
  1490		      EXEC CICS RETURN END-EXEC
  1503		  END-IF.
  1504
  1505
  1506	      100-NEW-MAP SECTION.
  1508		  EXEC CICS ASSIGN
  1509		      USERID(WS-USERID)
  1510		  END-EXEC
  1528
  1530		  EXEC CICS ASKTIME
  1531		      ABSTIME  (WS-TIME)
  1532		  END-EXEC
  1550
  1552		  EXEC CICS FORMATTIME
  1553		      ABSTIME  (WS-TIME)
  1554                DATESEP  ('/')  1555		      DDMMYYYY	 (DATEO)
  1556                TIMESEP    (':')
  1557		      TIME	 (TIMEO)
  1558		  END-EXEC
  1598
  1600		  EXEC CICS
  1601                SEND MAP ('SM001M')
  1602                MAPSET ('SM001S')
  1603		      FROM (SM001MO)
  1604		      LENGTH(WS-LENGTH)
  1605		      ERASE
  1606		  END-EXEC
  1648
  1650		  EXEC CICS RETURN
  1651                TRANSID('SM01')
  1652		      COMMAREA(WS-COMMAREA)
  1653		  END-EXEC.
  1678
  1679	      220-WHENF7 SECTION.
  1680
  1681		   SUBTRACT 11 FROM WS-QITEM-PAGE
  1682		   IF WS-QITEM-PAGE = WS-QITEM-START OR
  1683		      WS-QITEM-PAGE <  WS-QITEM-START
  1684                MOVE 'THIS IS THE FIRST PAGE' TO MSGO
  1685		      MOVE 1 TO WS-PAGE
  1686		      MOVE WS-QITEM-START TO WS-QITEM-PAGE
  1687		   ELSE
  1688		     SUBTRACT 1 FROM WS-PAGE
  1689		   END-IF
  1690		   MOVE WS-PAGE TO PAGEO
  1691		   PERFORM 500-MOVE-Q-TO-SCREEN
  1692		   PERFORM 100-NEW-MAP.
  1693
  1694	      230-WHENF8 SECTION.
  1695
  1696		   ADD 11 TO WS-QITEM-PAGE
  1697		   IF WS-QITEM-PAGE > WS-QITEM-END
  1698		      SUBTRACT 11 FROM WS-QITEM-PAGE
  1699		      MOVE WS-PAGE TO PAGEO
  1700                MOVE 'THIS IS THE LAST PAGE' TO MSGO
  1701		   ELSE
  1702		      ADD 1 TO WS-PAGE
  1703		      MOVE WS-PAGE TO PAGEO
  1704		      PERFORM 500-MOVE-Q-TO-SCREEN
  1705		   END-IF.
  1706		   PERFORM 100-NEW-MAP.
  1707
  1708	      240-WHENF2 SECTION.
  1710		  EXEC CICS ASSIGN
  1711		      USERID(WS-USERID)
  1712		  END-EXEC
  1731		  EXEC CICS
  1732                READ FILE('UAF00001')
  1733		      INTO (WS-USER-REC)
  1734		      RIDFLD (WS-USERID)
  1735		      RESP(WS-RESPONSE-CODE)
  1736		      GTEQ
  1737		  END-EXEC
  1775            IF NOT WS-RESPONSE-CODE = +00 OR REQUESTOR NOT = 'Y'
  1776                MOVE 'INVALID ACCESS' TO MSGO  1777		      PERFORM 100-NEW-MAP
  1778		  ELSE
  1780		      EXEC CICS XCTL
  1781                    PROGRAM('SM02P')
  1782		      END-EXEC
  1801		  END-IF.
  1802
  1803	      250-WHENENTER SECTION.
  1804		  IF PAGEI = LOW-VALUES
  1805		      MOVE WS-PAGE TO PAGEI
  1806		  END-IF
  1807		  IF PAGEI NOT = WS-PAGE OR PAGEL = +0
  1808		      MOVE PAGEI TO WS-PG-LIT
  1809		      IF PG-LIT1 IS NUMERIC AND PG-LIT2 IS NUMERIC
  1810			  IF WS-PG-LIT > WS-PAGE
  1811			      COMPUTE WS-COMP = WS-QITEM +
  1812					      ((WS-PG-LIT - 1) - WS-PAGE) * 11
  1813			      IF WS-COMP > WS-QITEM-END
  1814				  PERFORM VARYING WS-INDX FROM WS-QITEM-START
  1815					  BY 1 UNTIL
  1816				       WS-INDX > WS-QITEM-END
  1817				      ADD 1 TO WS-TALLY
  1818				  END-PERFORM
  1819				  DIVIDE WS-TALLY BY 11 GIVING WS-REM
  1820				  COMPUTE WS-MAX = WS-REM + 1
  1821				  MOVE WS-MAX TO WS-PAGE
  1822				  MOVE WS-PAGE TO PAGEO
  1823				  COMPUTE WS-QITEM-PAGE = (WS-REM * 11) +
  1824							  WS-QITEM-START
  1825				  PERFORM 500-MOVE-Q-TO-SCREEN
  1826                            MOVE 'THIS IS THE LAST PAGE' TO MSGO
  1827				  PERFORM 100-NEW-MAP
  1828			      ELSE
  1829				  MOVE WS-COMP TO WS-QITEM-PAGE
  1830				  MOVE PAGEI TO WS-PAGE
  1831				  PERFORM 500-MOVE-Q-TO-SCREEN
  1832				  PERFORM 100-NEW-MAP
  1833			      END-IF
  1834			  ELSE
  1835			      IF WS-PG-LIT = 1
  1836				  MOVE PAGEI TO WS-PAGE
  1837				  MOVE WS-QITEM-START TO WS-QITEM-PAGE
  1838				  PERFORM 500-MOVE-Q-TO-SCREEN
  1839                            MOVE 'THIS IS THE FIRST PAGE' TO MSGO
  1840				  PERFORM 100-NEW-MAP
  1841			      ELSE
  1842				  COMPUTE WS-COMP = WS-QITEM-PAGE -
  1843						    (WS-PAGE - WS-PG-LIT) * 11
  1844				  MOVE WS-COMP TO WS-QITEM-PAGE
  1845				  MOVE PAGEI TO WS-PAGE
  1846				  PERFORM 500-MOVE-Q-TO-SCREEN
  1847				  PERFORM 100-NEW-MAP
  1848			      END-IF
  1849			  END-IF
  1850		      ELSE
  1851                    MOVE 'ENTER A NUMERIC PAGE NUMBER' TO MSGO
  1852			  PERFORM 100-NEW-MAP
  1853		      END-IF
  1854		  ELSE
  1855		      MOVE 1 TO WS-INDX  1856		      PERFORM UNTIL WS-INDX > 11
  1857			  MOVE UCI(WS-INDX) TO WS-CHOICE
  1858                    IF NOT WS-CHOICE = '_'
  1859			      ADD 1 TO WS-COUNTER
  1860			      MOVE WS-INDX TO WS-COUNTER2
  1861			  END-IF
  1862			  ADD 1 TO WS-INDX
  1863		      END-PERFORM
  1864		      IF WS-COUNTER > 1
  1865			  MOVE 1 TO WS-INDX
  1866			  PERFORM UNTIL WS-INDX > 11
  1867                        MOVE '_' TO UCI(WS-INDX)
  1868			      ADD 1 TO WS-INDX
  1869			  END-PERFORM
  1870                    MOVE 'ENTER 1 SELECTION ONLY' TO MSGO
  1871		      ELSE
  1872			  EVALUATE UCI(WS-COUNTER2)
  1873                        WHEN 'U'
  1874                            IF STI(WS-COUNTER2) = 'APPROVED' OR 'ONGOING'
  1875				      PERFORM 600-VALIDATE-USER
  1876				      EVALUATE TRUE
  1877                                    WHEN SERVICE-PROVIDER = 'Y' AND
  1878                                         REQUESTOR = 'Y'
  1880					      EXEC CICS XCTL
  1881                                            PROGRAM('SM003P')
  1882					      END-EXEC
  1901                                    WHEN SERVICE-PROVIDER = 'Y'
  1903					      EXEC CICS XCTL
  1904                                            PROGRAM('SM003P')
  1905					      END-EXEC
  1924                                    WHEN REQUESTOR = 'Y'
  1926					      EXEC CICS
  1927                                            READ FILE('STF00001')
  1928						  INTO (WS-TIX-REC)
  1929						  RIDFLD (TNI(WS-COUNTER2))
  1930						  RESP(WS-RESPONSE-CODE)
  1931						  EQUAL
  1932					      END-EXEC
  1970					      IF WS-USERID = TIX-REQUESTOR
  1972						  EXEC CICS XCTL
  1973                                                PROGRAM('SM003P')
  1974						  END-EXEC
  1993					      ELSE
  1994                                            MOVE '_' TO UCI(WS-COUNTER2)
  1995                                            MOVE 'INVALID ACCESS' TO MSGO
  1996						  PERFORM 100-NEW-MAP
  1997					      END-IF
  1998					  WHEN OTHER
  1999                                        MOVE '_' TO UCI(WS-COUNTER2)
  2000                                        MOVE 'INVALID ACCESS' TO MSGO
  2001					      PERFORM 100-NEW-MAP
  2002				      END-EVALUATE
  2003				  ELSE
  2004                                MOVE '_' TO UCI(WS-COUNTER2)
  2005                                MOVE 'STATUS MUST BE APPROVED OR ONGOING'
  2006					  TO MSGO
  2007				      PERFORM 100-NEW-MAP
  2008				  END-IF
  2009                        WHEN 'C'
  2010                            IF STI(WS-COUNTER2) = 'COMPLETED'  2011				      PERFORM 600-VALIDATE-USER
  2013				      EXEC CICS
  2014                                    READ FILE('STF00001')
  2015					  INTO (WS-TIX-REC)
  2016					  RIDFLD (TNI(WS-COUNTER2))
  2017					  RESP(WS-RESPONSE-CODE)
  2018					  EQUAL
  2019				      END-EXEC
  2057				      IF WS-USERID = TIX-REQUESTOR
  2059					  EXEC CICS XCTL
  2060                                        PROGRAM('SM004P')
  2061					  END-EXEC
  2080				      ELSE
  2081                                    MOVE '_' TO UCI(WS-COUNTER2)
  2082                                    MOVE 'INVALID ACCESS' TO MSGO
  2083					  PERFORM 100-NEW-MAP
  2084				      END-IF
  2085				  ELSE
  2086                                MOVE '_' TO UCI(WS-COUNTER2)
  2087                                MOVE 'STATUS MUST BE COMPLETED' TO
  2088					  MSGO
  2089				      PERFORM 100-NEW-MAP
  2090				  END-IF
  2091                        WHEN 'A'
  2092                                IF STI(WS-COUNTER2) = 'CREATED'
  2093				      PERFORM 600-VALIDATE-USER
  2094				      EVALUATE TRUE
  2095                                    WHEN APPROVER = 'Y'
  2097					      EXEC CICS
  2098                                            READ FILE('STF00001')
  2099						  INTO (WS-TIX-REC)
  2100						  RIDFLD (TNI(WS-COUNTER2))
  2101						  RESP(WS-RESPONSE-CODE)
  2102						  EQUAL
  2103					      END-EXEC
  2141					      IF WS-USERID = TIX-REQUESTOR
  2143						  EXEC CICS XCTL
  2144                                                PROGRAM('SM005P')
  2145						  END-EXEC
  2164					      ELSE
  2165                                            MOVE '_' TO UCI(WS-COUNTER2)
  2166                                            MOVE 'INVALID ACCESS' TO MSGO
  2167						  PERFORM 100-NEW-MAP
  2168					      END-IF
  2169					  WHEN OTHER
  2170                                        MOVE '_' TO UCI(WS-COUNTER2)
  2171                                        MOVE 'INVALID ACCESS' TO MSGO
  2172					      PERFORM 100-NEW-MAP
  2173				      END-EVALUATE
  2174				  ELSE
  2175                                MOVE '_' TO UCI(WS-COUNTER2)
  2176                                MOVE 'STATUS MUST BE CREATED' TO
  2177					  MSGO
  2178				      PERFORM 100-NEW-MAP
  2179				  END-IF
  2180                        WHEN 'X'
  2182				  EXEC CICS
  2183                                READ FILE('STF00001')
  2184				      INTO (WS-TIX-REC)
  2185				      RIDFLD (TNI(WS-COUNTER2))  2186				      RESP(WS-RESPONSE-CODE)
  2187				      EQUAL
  2188				  END-EXEC
  2226				  IF WS-USERID = TIX-REQUESTOR
  2228				      EXEC CICS XCTL
  2229                                    PROGRAM('SM006P')
  2230				      END-EXEC
  2249				  ELSE
  2250                                MOVE '_' TO UCI(WS-COUNTER2)
  2251                                MOVE 'INVALID ACCESS' TO MSGO
  2252				      PERFORM 100-NEW-MAP
  2253				  END-IF
  2254			      WHEN SPACE
  2255                            MOVE '_' TO UCI(WS-COUNTER2)
  2256                            MOVE 'OPTION IS REQUIRED' TO MSGO
  2257				  PERFORM 100-NEW-MAP
  2258			      WHEN OTHER
  2259                            MOVE '_' TO UCI(WS-COUNTER2)
  2260                            MOVE 'ENTER U, C, A, OR X AND PRESS ENTER' TO
  2261					MSGO
  2262				  PERFORM 100-NEW-MAP
  2263			  END-EVALUATE
  2264		      END-IF
  2265		  END-IF.
  2266
  2267	      260-WHENF5 SECTION.
  2268
  2269	      270-WHENF12 SECTION.
  2270		  PERFORM UNTIL WS-QITEM-PAGE < WS-QITEM-START OR
  2271				WS-QITEM-PAGE = WS-QITEM-START
  2272			      SUBTRACT 11 FROM WS-QITEM-PAGE
  2273		  END-PERFORM
  2274            MOVE 'THIS IS THE FIRST PAGE' TO MSGO
  2275		  MOVE 1 TO WS-PAGE
  2276		  MOVE WS-QITEM-START TO WS-QITEM-PAGE
  2277		   MOVE WS-PAGE TO PAGEO
  2278		   PERFORM 500-MOVE-Q-TO-SCREEN
  2279		   PERFORM 100-NEW-MAP.
  2280
  2281	      500-MOVE-Q-TO-SCREEN SECTION.
  2282
  2283		   MOVE WS-QITEM-PAGE TO WS-QITEM
  2285		   EXEC CICS READQ TS
  2286			     QUEUE(WS-QNAME)
  2287			     INTO (WS-TIX-REC)
  2288			     ITEM (WS-QITEM)
  2289		    END-EXEC
  2319
  2320		   MOVE 1 TO WS-INDX
  2321
  2322		   PERFORM UNTIL WS-INDX > 11
  2324		       IF EIBRESP = DFHRESP(NORMAL) AND
  2326		       IF EIBRESP =	    000     AND 		       R
  2327			  WS-QITEM <= WS-QITEM-END
  2328			  MOVE TIX-ID TO TNI(WS-INDX)
  2329			  MOVE TIX-TITLE TO TTI(WS-INDX)
  2330			  MOVE TIX-STATUS TO STI(WS-INDX)
  2331			  MOVE LAST-UPDATE TO UDI(WS-INDX)
  2332			  MOVE UPDBY2 TO UBI(WS-INDX)
  2333			  ADD 1 TO WS-INDX  2334			  ADD 1 TO WS-QITEM
  2336			  EXEC CICS READQ TS
  2337			       QUEUE(WS-QNAME)
  2338			       INTO (WS-TIX-REC)
  2339			       ITEM (WS-QITEM)
  2340			 END-EXEC
  2370		      ELSE
  2371			 MOVE SPACES TO TNI(WS-INDX)
  2372			 MOVE SPACES TO TTI(WS-INDX)
  2373			 MOVE SPACES TO STI(WS-INDX)
  2374			 MOVE SPACES TO UDI(WS-INDX)
  2375			 MOVE SPACES TO UBI(WS-INDX)
  2376                   MOVE 'THIS IS THE LAST PAGE' TO MSGO
  2377                   MOVE '1' TO WS-LASTPAGE
  2378			 ADD 1 TO WS-INDX
  2379		      END-IF
  2380		   END-PERFORM.
  2381
  2382	      500-EXIT.
  2383		  EXIT.
  2384
  2385	      600-VALIDATE-USER.
  2387		  EXEC CICS ASSIGN
  2388		      USERID(WS-USERID)
  2389		  END-EXEC
  2408		  EXEC CICS
  2409                READ FILE('UAF00001')
  2410		      INTO (WS-USER-REC)
  2411		      RIDFLD (WS-USERID)
  2412		      RESP(WS-RESPONSE-CODE)
  2413		      GTEQ
  2414		  END-EXEC
  2452		  IF NOT WS-RESPONSE-CODE = +00
  2453                MOVE 'INVALID ACCESS' TO MSGO
  2454		      PERFORM 100-NEW-MAP
  2455		  END-IF.
  2456
  2457	      999-MOVE-FILE-TO-Q SECTION.
  2458
  2459		   MOVE LOW-VALUES TO TIX-ID.
  2461		   EXEC CICS
  2462                STARTBR FILE('stf00001')
  2463		      RIDFLD (TIX-ID)
  2464		      GTEQ
  2465		   END-EXEC
  2492
  2494		   EXEC CICS
  2495                 READNEXT FILE('stf00001')
  2496		       INTO (WS-TIX-REC)
  2497		       RIDFLD (TIX-ID)
  2498		   END-EXEC
  2527
  2529		  EXEC CICS WRITEQ TS
  2530			    QUEUE(WS-QNAME)
  2531			    FROM (WS-TIX-REC)
  2532			    ITEM (WS-QITEM)
  2533		  END-EXEC
  2562		  MOVE WS-QITEM TO WS-QITEM-START
  2564		  PERFORM UNTIL EIBRESP NOT = DFHRESP(NORMAL)
  2566		  PERFORM UNTIL EIBRESP NOT =	      000		       R  2567		      MOVE WS-QITEM TO WS-QITEM-END
  2569		      EXEC CICS
  2570                     READNEXT FILE('stf00001')
  2571			   INTO (WS-TIX-REC)
  2572			   RIDFLD (TIX-ID)
  2573		      END-EXEC
  2603		      IF EIBRESP = DFHRESP(NORMAL)
  2605		      IF EIBRESP =	   000				       R
  2607			  EXEC CICS WRITEQ TS
  2608				  QUEUE(WS-QNAME)
  2609				  FROM (WS-TIX-REC)
  2610				  ITEM (WS-QITEM)
  2611			  END-EXEC
  2640		  END-IF
  2641		  END-PERFORM
  2643		  EXEC CICS
  2644                 ENDBR FILE('stf00001')
  2645		  END-EXEC
  2664		  MOVE WS-QITEM-START TO WS-QITEM-PAGE.
  2665
  2666	      999-EXIT.
  2667		  EXIT.
  2668
  2669
  2670CA-Realia COBOL Version 6.0.45	 C:\handson-cics\CAWB30\sm001p.cic     PAGE   29

LINE (REL)  ERR# LVL			ERROR TEXT

1808 ( 309)  0614 W Expected numeric data-name; found 'PAGEI'; treated as USAGE
	DISPLAY numeric
1821 ( 322)  0616 W Digits may be truncated during MOVE from 'WS-MAX'
1830 ( 331)  0614 W Expected numeric data-name; found 'PAGEI'; treated as USAGE
	DISPLAY numeric
1836 ( 337)  0614 W Expected numeric data-name; found 'PAGEI'; treated as USAGE
	DISPLAY numeric
1845 ( 346)  0614 W Expected numeric data-name; found 'PAGEI'; treated as USAGE
	DISPLAY numeric
1860 ( 361)  0616 W Digits may be truncated during MOVE from 'WS-INDX'

sm001p has   6 Warning messagesCA-Realia COBOL Version 6.0.45	 C:\handson-cics\CAWB30\sm001p.cic     PAGE   30



			Realia COBOL Compiler Version Information

			      Pass 1	 Version 6.072
			      Pass 1a	 Version 6.015
			      Pass 2	 Version 6.068
			      Pass 2a	 Version 6.020
			      Pass 3	 Version 6.094
			      Pass 4	 Version 6.007
			      Pass 5	 Version 6.022


			Compilation Directives in Effect

COMP-4		  DCHK		    OPT 	      NOCALL
NOSUBCHK	  STRCHK	    NOTRUNC	      NOSMALLCOMP
NODCALL 	  NODIVZERO	    NOEPDCALL	      APOST
EBCDIC		  STATABORT	    NOMOVELINK	      NOBLL4K
ARGCHK		  UPLOW 	    NOVERARG	      MDY
LP:   60	  PP		    FCREATE	      NOIEEE
NOLILIAN	  CURRENCY-SIGN=$   WRITEAFTER	      SOSI
NOCOPY68	  NOFLAG-COM	    NOFLAG-SEG	      NOFLAG-FIPS
DEBUGXREF	  DIALECT-VS2

			Error level limit: W

			Source lines compiled:	    2681
			Compilation time (mm:ss.ss):  0:00.10
			Compilation speed (lines/minute):  8600

			Compilation date (yy/mm/dd): 23/12/05
			     Time of day (hh:mm:ss): 09:19:19