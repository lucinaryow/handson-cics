      *$PP-NOLIST
      *$PP-DEF CARCPP HA COPY SUPPRESS
      *$PP
      *$PP-LIST
      *CBL XOPTS(COBOL2)
      *$PP-NOLIST							REALCICS
      *$PP-DEF CICS HA CICS Internal Data				REALCICS
      *$PP-DEF CICS HI CICS Internal Code				REALCICS
      *$PP-DEF CICS NA CICS Generated					REALCICS
      *  EXEC commands are standard PP-NOLIST				REALCICS
      *$PP-LIST 							REALCICS
      *$PP-NOLIST CICS HI						REALCICS
      *$NOMOVELINK,COMP-4,NOCALL					REALCICS
      *$DIALECT-VS2							REALCICS
      *$NOBLL4K 							REALCICS
      *$EBCDIC								REALCICS
      *$DCHK								REALCICS
      *$NOTRUNC 							REALCICS
      *$PP-LIST CICS HI 						REALCICS
       IDENTIFICATION DIVISION.
       PROGRAM-ID. SM001P.

       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER.    IBM-PC.
       OBJECT-COMPUTER.    IBM-PC.

       DATA DIVISION.
       WORKING-STORAGE SECTION.
      *$PP-NOLIST CICS HA						REALCICS
       01  DFH-RETURN-STATUS PIC S9(4) COMP-5.				REALCICS
       01  CICSICB.							REALCICS
	   05 DFH-ICB-SIZE PIC S9(9) BINARY VALUE 0.			REALCICS
	   05 DFH-MODULE-INFO.						REALCICS
	      10 DFH-VERSION PIC S9(4) COMP-4 VALUE 6001.		REALCICS
              10 DFH-MODULE-ID PIC X(8) VALUE 'SM001P'.                 REALCICS
              10 DFH-VAR-CODESET PIC X VALUE 'A'.                       REALCICS
              10 DFH-CODE-TYPE PIC X VALUE '2'.                         REALCICS
	      10 DFH-CICSTYPE PIC S9(4) COMP-4 VALUE 1. 		REALCICS
	      10 DFH-LEVEL PIC S9(4) COMP-4 VALUE 05.			REALCICS
	   05 DFH-COMMAND PIC XX.					REALCICS
	   05 DFH-DEBUG-DATA.						REALCICS
	      10 DFH-SOURCE-NAME PIC X(8).				REALCICS
	      10 DFH-SOURCE-LINE-NUM PIC 9(6) COMP-4.			REALCICS
	   05 DFH-RESULT-STATUS PIC S9(4) COMP-4.			REALCICS
	   05 DFH-RESERVED PIC X(512) VALUE LOW-VALUE.			REALCICS
	   05 DFH-RESULT REDEFINES DFH-RESERVED.			REALCICS
	      10 DFH-RESP PIC S9(8) COMP-4.				REALCICS
	      10 DFH-RESP2 PIC S9(8) COMP-4.				REALCICS
	      10 DFH-WORK-01 PIC S9(9) COMP-5.				REALCICS
	      10 DFH-WORK-01U REDEFINES DFH-WORK-01 PIC 9(9) COMP-5.	REALCICS
	   05 DFH-VARS-COUNT PIC S9(4) COMP-4.				REALCICS
	   05 DFH-VARS-MAX VALUE 24 PIC S9(4) COMP-4.			REALCICS
	   05 DFH-VARS OCCURS 24.					REALCICS
	      10 DFH-FLAG PIC S9(4) COMP-4.				REALCICS
	      10 DFH-DATA-TYPE PIC X.					REALCICS
	      10 DFH-DATA-CLASS PIC X.					REALCICS
	      10 DFH-DEBUG POINTER.					REALCICS
	      10 DFH-ADDR POINTER.					REALCICS
	      10 DFH-SIZE PIC S9(9) COMP-4.				REALCICS
	      10 DFH-DATA PIC X(8).					REALCICS
	      10 DFH-DATA1 REDEFINES DFH-DATA PIC X(1). 		REALCICS
	      10 DFH-DATA2 REDEFINES DFH-DATA PIC X(2). 		REALCICS
	      10 DFH-DATA4 REDEFINES DFH-DATA PIC X(4). 		REALCICS
	      10 DFH-DATA7 REDEFINES DFH-DATA PIC X(7). 		REALCICS
	      10 DFH-DATA8 REDEFINES DFH-DATA PIC X(8). 		REALCICS
	      10 DFH-DATAF REDEFINES DFH-DATA PIC S9(9) COMP-4. 	REALCICS
	      10 DFH-DATAH REDEFINES DFH-DATA PIC S9(4) COMP-4. 	REALCICS
	      10 DFH-LABEL REDEFINES DFH-DATA PIC S9(4) COMP-4. 	REALCICS
	      10 DFH-DATAT REDEFINES DFH-DATA PIC S9(15) COMP-3.	REALCICS
	      10 FILLER REDEFINES DFH-DATA.				REALCICS
		  15 DFH-DATAP PIC S9(6) COMP-3.			REALCICS
		  15 FILLER PIC X(4).					REALCICS
      *$PP-LIST CICS HA 						REALCICS
       01  WS-TIME		       PIC 9(15) COMP-3.
       01  WS-FILLER				 PIC X(80).
       01  WS-PG-LIT		       PIC 9(2).
       01  WS-PG-RED REDEFINES WS-PG-LIT.
	   05	PG-LIT1 	       PIC 9.
	   05	PG-LIT2 	       PIC 9.
       01  WS-TALLY		       PIC 9(3) VALUE 0.
       01  WS-REM		       PIC 9(3).
       01  WS-COMP		       PIC 9(4).
       01  WS-MAX		       PIC 9(3).
       01  WS-RESPONSE-CODE	       PIC S9(8) COMP.
       01  WS-COUNTER		       PIC 9(2) VALUE 0.
       01  WS-COUNTER2		       PIC 9(2) VALUE 0.
       01  WS-CHOICE		       PIC X.
       01  WS-USERID		       PIC X(8).
       01  WS-PRGNAME		       PIC X(6).
       01  WS-LENGTH		       PIC S9(4) COMP.
       01  WS-RECB-LENGTH	       PIC S9(4) COMP VALUE +20.
       01  WS-KEYB-LENGTH	       PIC S9(4) COMP VALUE +8.
       01  WS-INDX		       PIC 9(3)  VALUE 1.
       01  WS-LASTPAGE		       PIC X(1).
       01  WS-FIRSTPAGE 	       PIC X(1).
       01  WS-PAGE-CTR		       PIC 9(02).
       01  WS-COMMAREA.
	   05  WS-CA-PRGNAME	       PIC X(06).
	   05  FILLER		       PIC X(19).
	   05  WS-DFHSTATE	       PIC X(15).
	   05  WS-TRANS 	       PIC X(04).
	   05  WS-LUSER 	       PIC 9(03).
	   05  WS-FUSER 	       PIC 9(03).
	   05  WS-PAGE		       PIC 9(02).
	   05  WS-QNAME 	       PIC X(8).
	   05  WS-PAGE-END	       PIC 9(01).
	   05  WS-QITEM 	       PIC S9(4) COMP.
	   05  WS-QITEM-START	       PIC S9(4) COMP.
	   05  WS-QITEM-END	       PIC S9(4) COMP.
	   05  WS-QITEM-PAGE	       PIC S9(4) COMP.
	   05  WS-USER-REC.
	       10  USERID.
		   15  USERID1			     PIC X(7).
		   15  FILLER			     PIC X.
	       10  REQUESTOR			     PIC X.
	       10  ADMINISTRATOR		     PIC X.
	       10  APPROVER			     PIC X.
	       10  SERVICE-PROVIDER		     PIC X.
	       10  UPDATED-BY1.
		   15  UPDBY1			     PIC X(7).
		   15  FILLER			     PIC X.
	   05  WS-TIX-REC.
	       10  TIX-ID			     PIC X(06).
	       10  TIX-REQUESTOR		     PIC X(08).
	       10  TIX-STATUS			     PIC X(10).
	       10  TIX-TITLE			     PIC X(25).
	       10  TIX-DESC			     PIC X(100).
	       10  TIX-DESC-RED REDEFINES TIX-DESC.
		   15  TIX-DESC1		     PIC X(50).
		   15  TIX-DESC2		     PIC X(50).
	       10  LAST-UPDATE			     PIC X(20).
	       10  LAST-UPDATE-RED REDEFINES LAST-UPDATE.
		   15  LAST-UPDATE-DATE.
				       20 DD PIC 9(02).
					   20 FILLER PIC X.
					   20 MM PIC 9(02).
					   20 FILLER PIC X.
					   20 YYYY PIC 9(02).
					   20 FILLER PIC X.
		   15  LAST-UPDATE-TIME 	     PIC X(09).
	       10  UPDATED-BY2.
		   15  UPDBY2			     PIC X(7).
		   15  FILLER			     PIC X.
	       10  LAST-UPDATE-REM		     PIC X(50).
	       10  LAST-UPDATE-REMW REDEFINES LAST-UPDATE-REM.
		   15  LAST-UPDATE-REM1 	     PIC X(25).
		   15  LAST-UPDATE-REM2 	     PIC X(25).
	   05  WS-PROG-STATE			  PIC 9(1).
           05  WS-INIT                            PIC X VALUE 'Y'.
	   05  WS-USERID1			  PIC X(7).
	   05  WS-TICKET-NUM.
	       10  WS-TICKET-NUM1		  PIC X(6).
	       10  FILLER			  PIC X.
       01  WS-END				 PIC X(15) VALUE
           'END PROCESSING'.
       01  WS-INVKEY				 PIC X(21) VALUE
           'INVALID PFKEY PRESSED'.
       01  WS-INVALID			   PIC X(14) VALUE
           'INVALID ACCESS'.
       01  WS-INVALID-TICKET			   PIC X(28) VALUE
           'TICKET NUMBER DOES NOT EXIST'.
       01  WS-INVALID-USER			   PIC X(24) VALUE
                               'INVALID ACCESS TO TICKET'.
       01 WS-SWITCH.
	   05 DATE-FILTER-SW PIC X.
	   05 TITLE-FILTER-SW PIC X.
	   05 VALID-DATE-FILTER-SW   PIC X.

      *
      PCOPY SM001S.
      *$PP-START-COPY C:\handson-cics\CAWB30\SM001S.COB
      * SYMBOLIC MAP of sm001s Created by CACXBMS Version 6.0.27
       01  SM001MI.
	   02  FILLER				      PIC X(12).
	   02  DATEL				      PIC S9(4) COMP.
	   02  DATEF				      PIC X.
	   02  FILLER REDEFINES DATEF.
	       03  DATEA			      PIC X.
	   02  DATEI				      PIC X(010).
	   02  PAGEL				      PIC S9(4) COMP.
	   02  PAGEF				      PIC X.
	   02  FILLER REDEFINES PAGEF.
	       03  PAGEA			      PIC X.
	   02  PAGEI				      PIC X(002).
	   02  TIMEL				      PIC S9(4) COMP.
	   02  TIMEF				      PIC X.
	   02  FILLER REDEFINES TIMEF.
	       03  TIMEA			      PIC X.
	   02  TIMEI				      PIC X(008).
	   02  TITLEL				      PIC S9(4) COMP.
	   02  TITLEF				      PIC X.
	   02  FILLER REDEFINES TITLEF.
	       03  TITLEA			      PIC X.
	   02  TITLEI				      PIC X(020).
	   02  STATUSL				      PIC S9(4) COMP.
	   02  STATUSF				      PIC X.
	   02  FILLER REDEFINES STATUSF.
	       03  STATUSA			      PIC X.
	   02  STATUSI				      PIC X(007).
	   02  TODATEL				      PIC S9(4) COMP.
	   02  TODATEF				      PIC X.
	   02  FILLER REDEFINES TODATEF.
	       03  TODATEA			      PIC X.
	   02  TODATEI				      PIC X(008).
	   02  FRDATEL				      PIC S9(4) COMP.
	   02  FRDATEF				      PIC X.
	   02  FILLER REDEFINES FRDATEF.
	       03  FRDATEA			      PIC X.
	   02  FRDATEI				      PIC X(008).
	   02  UC1L				      PIC S9(4) COMP.
	   02  UC1F				      PIC X.
	   02  FILLER REDEFINES UC1F.
	       03  UC1A 			      PIC X.
	   02  UC1I				      PIC X(001).
	   02  UC2L				      PIC S9(4) COMP.
	   02  UC2F				      PIC X.
	   02  FILLER REDEFINES UC2F.
	       03  UC2A 			      PIC X.
	   02  UC2I				      PIC X(001).
	   02  UC3L				      PIC S9(4) COMP.
	   02  UC3F				      PIC X.
	   02  FILLER REDEFINES UC3F.
	       03  UC3A 			      PIC X.
	   02  UC3I				      PIC X(001).
	   02  UC4L				      PIC S9(4) COMP.
	   02  UC4F				      PIC X.
	   02  FILLER REDEFINES UC4F.
	       03  UC4A 			      PIC X.
	   02  UC4I				      PIC X(001).
	   02  UC5L				      PIC S9(4) COMP.
	   02  UC5F				      PIC X.
	   02  FILLER REDEFINES UC5F.
	       03  UC5A 			      PIC X.
	   02  UC5I				      PIC X(001).
	   02  UC6L				      PIC S9(4) COMP.
	   02  UC6F				      PIC X.
	   02  FILLER REDEFINES UC6F.
	       03  UC6A 			      PIC X.
	   02  UC6I				      PIC X(001).
	   02  UC7L				      PIC S9(4) COMP.
	   02  UC7F				      PIC X.
	   02  FILLER REDEFINES UC7F.
	       03  UC7A 			      PIC X.
	   02  UC7I				      PIC X(001).
	   02  UC8L				      PIC S9(4) COMP.
	   02  UC8F				      PIC X.
	   02  FILLER REDEFINES UC8F.
	       03  UC8A 			      PIC X.
	   02  UC8I				      PIC X(001).
	   02  UC9L				      PIC S9(4) COMP.
	   02  UC9F				      PIC X.
	   02  FILLER REDEFINES UC9F.
	       03  UC9A 			      PIC X.
	   02  UC9I				      PIC X(001).
	   02  UC10L				      PIC S9(4) COMP.
	   02  UC10F				      PIC X.
	   02  FILLER REDEFINES UC10F.
	       03  UC10A			      PIC X.
	   02  UC10I				      PIC X(001).
	   02  UC11L				      PIC S9(4) COMP.
	   02  UC11F				      PIC X.
	   02  FILLER REDEFINES UC11F.
	       03  UC11A			      PIC X.
	   02  UC11I				      PIC X(001).
	   02  TN1L				      PIC S9(4) COMP.
	   02  TN1F				      PIC X.
	   02  FILLER REDEFINES TN1F.
	       03  TN1A 			      PIC X.
	   02  TN1I				      PIC X(006).
	   02  TN2L				      PIC S9(4) COMP.
	   02  TN2F				      PIC X.
	   02  FILLER REDEFINES TN2F.
	       03  TN2A 			      PIC X.
	   02  TN2I				      PIC X(006).
	   02  TN3L				      PIC S9(4) COMP.
	   02  TN3F				      PIC X.
	   02  FILLER REDEFINES TN3F.
	       03  TN3A 			      PIC X.
	   02  TN3I				      PIC X(006).
	   02  TN4L				      PIC S9(4) COMP.
	   02  TN4F				      PIC X.
	   02  FILLER REDEFINES TN4F.
	       03  TN4A 			      PIC X.
	   02  TN4I				      PIC X(006).
	   02  TN5L				      PIC S9(4) COMP.
	   02  TN5F				      PIC X.
	   02  FILLER REDEFINES TN5F.
	       03  TN5A 			      PIC X.
	   02  TN5I				      PIC X(006).
	   02  TN6L				      PIC S9(4) COMP.
	   02  TN6F				      PIC X.
	   02  FILLER REDEFINES TN6F.
	       03  TN6A 			      PIC X.
	   02  TN6I				      PIC X(006).
	   02  TN7L				      PIC S9(4) COMP.
	   02  TN7F				      PIC X.
	   02  FILLER REDEFINES TN7F.
	       03  TN7A 			      PIC X.
	   02  TN7I				      PIC X(006).
	   02  TN8L				      PIC S9(4) COMP.
	   02  TN8F				      PIC X.
	   02  FILLER REDEFINES TN8F.
	       03  TN8A 			      PIC X.
	   02  TN8I				      PIC X(006).
	   02  TN9L				      PIC S9(4) COMP.
	   02  TN9F				      PIC X.
	   02  FILLER REDEFINES TN9F.
	       03  TN9A 			      PIC X.
	   02  TN9I				      PIC X(006).
	   02  TN10L				      PIC S9(4) COMP.
	   02  TN10F				      PIC X.
	   02  FILLER REDEFINES TN10F.
	       03  TN10A			      PIC X.
	   02  TN10I				      PIC X(006).
	   02  TN11L				      PIC S9(4) COMP.
	   02  TN11F				      PIC X.
	   02  FILLER REDEFINES TN11F.
	       03  TN11A			      PIC X.
	   02  TN11I				      PIC X(006).
	   02  TT1L				      PIC S9(4) COMP.
	   02  TT1F				      PIC X.
	   02  FILLER REDEFINES TT1F.
	       03  TT1A 			      PIC X.
	   02  TT1I				      PIC X(020).
	   02  TT2L				      PIC S9(4) COMP.
	   02  TT2F				      PIC X.
	   02  FILLER REDEFINES TT2F.
	       03  TT2A 			      PIC X.
	   02  TT2I				      PIC X(020).
	   02  TT3L				      PIC S9(4) COMP.
	   02  TT3F				      PIC X.
	   02  FILLER REDEFINES TT3F.
	       03  TT3A 			      PIC X.
	   02  TT3I				      PIC X(020).
	   02  TT4L				      PIC S9(4) COMP.
	   02  TT4F				      PIC X.
	   02  FILLER REDEFINES TT4F.
	       03  TT4A 			      PIC X.
	   02  TT4I				      PIC X(020).
	   02  TT5L				      PIC S9(4) COMP.
	   02  TT5F				      PIC X.
	   02  FILLER REDEFINES TT5F.
	       03  TT5A 			      PIC X.
	   02  TT5I				      PIC X(020).
	   02  TT6L				      PIC S9(4) COMP.
	   02  TT6F				      PIC X.
	   02  FILLER REDEFINES TT6F.
	       03  TT6A 			      PIC X.
	   02  TT6I				      PIC X(020).
	   02  TT7L				      PIC S9(4) COMP.
	   02  TT7F				      PIC X.
	   02  FILLER REDEFINES TT7F.
	       03  TT7A 			      PIC X.
	   02  TT7I				      PIC X(020).
	   02  TT8L				      PIC S9(4) COMP.
	   02  TT8F				      PIC X.
	   02  FILLER REDEFINES TT8F.
	       03  TT8A 			      PIC X.
	   02  TT8I				      PIC X(020).
	   02  TT9L				      PIC S9(4) COMP.
	   02  TT9F				      PIC X.
	   02  FILLER REDEFINES TT9F.
	       03  TT9A 			      PIC X.
	   02  TT9I				      PIC X(020).
	   02  TT10L				      PIC S9(4) COMP.
	   02  TT10F				      PIC X.
	   02  FILLER REDEFINES TT10F.
	       03  TT10A			      PIC X.
	   02  TT10I				      PIC X(020).
	   02  TT11L				      PIC S9(4) COMP.
	   02  TT11F				      PIC X.
	   02  FILLER REDEFINES TT11F.
	       03  TT11A			      PIC X.
	   02  TT11I				      PIC X(020).
	   02  ST1L				      PIC S9(4) COMP.
	   02  ST1F				      PIC X.
	   02  FILLER REDEFINES ST1F.
	       03  ST1A 			      PIC X.
	   02  ST1I				      PIC X(010).
	   02  ST2L				      PIC S9(4) COMP.
	   02  ST2F				      PIC X.
	   02  FILLER REDEFINES ST2F.
	       03  ST2A 			      PIC X.
	   02  ST2I				      PIC X(010).
	   02  ST3L				      PIC S9(4) COMP.
	   02  ST3F				      PIC X.
	   02  FILLER REDEFINES ST3F.
	       03  ST3A 			      PIC X.
	   02  ST3I				      PIC X(010).
	   02  ST4L				      PIC S9(4) COMP.
	   02  ST4F				      PIC X.
	   02  FILLER REDEFINES ST4F.
	       03  ST4A 			      PIC X.
	   02  ST4I				      PIC X(010).
	   02  ST5L				      PIC S9(4) COMP.
	   02  ST5F				      PIC X.
	   02  FILLER REDEFINES ST5F.
	       03  ST5A 			      PIC X.
	   02  ST5I				      PIC X(010).
	   02  ST6L				      PIC S9(4) COMP.
	   02  ST6F				      PIC X.
	   02  FILLER REDEFINES ST6F.
	       03  ST6A 			      PIC X.
	   02  ST6I				      PIC X(010).
	   02  ST7L				      PIC S9(4) COMP.
	   02  ST7F				      PIC X.
	   02  FILLER REDEFINES ST7F.
	       03  ST7A 			      PIC X.
	   02  ST7I				      PIC X(010).
	   02  ST8L				      PIC S9(4) COMP.
	   02  ST8F				      PIC X.
	   02  FILLER REDEFINES ST8F.
	       03  ST8A 			      PIC X.
	   02  ST8I				      PIC X(010).
	   02  ST9L				      PIC S9(4) COMP.
	   02  ST9F				      PIC X.
	   02  FILLER REDEFINES ST9F.
	       03  ST9A 			      PIC X.
	   02  ST9I				      PIC X(010).
	   02  ST10L				      PIC S9(4) COMP.
	   02  ST10F				      PIC X.
	   02  FILLER REDEFINES ST10F.
	       03  ST10A			      PIC X.
	   02  ST10I				      PIC X(010).
	   02  ST11L				      PIC S9(4) COMP.
	   02  ST11F				      PIC X.
	   02  FILLER REDEFINES ST11F.
	       03  ST11A			      PIC X.
	   02  ST11I				      PIC X(010).
	   02  UD1L				      PIC S9(4) COMP.
	   02  UD1F				      PIC X.
	   02  FILLER REDEFINES UD1F.
	       03  UD1A 			      PIC X.
	   02  UD1I				      PIC X(008).
	   02  UD2L				      PIC S9(4) COMP.
	   02  UD2F				      PIC X.
	   02  FILLER REDEFINES UD2F.
	       03  UD2A 			      PIC X.
	   02  UD2I				      PIC X(008).
	   02  UD3L				      PIC S9(4) COMP.
	   02  UD3F				      PIC X.
	   02  FILLER REDEFINES UD3F.
	       03  UD3A 			      PIC X.
	   02  UD3I				      PIC X(008).
	   02  UD4L				      PIC S9(4) COMP.
	   02  UD4F				      PIC X.
	   02  FILLER REDEFINES UD4F.
	       03  UD4A 			      PIC X.
	   02  UD4I				      PIC X(008).
	   02  UD5L				      PIC S9(4) COMP.
	   02  UD5F				      PIC X.
	   02  FILLER REDEFINES UD5F.
	       03  UD5A 			      PIC X.
	   02  UD5I				      PIC X(008).
	   02  UD6L				      PIC S9(4) COMP.
	   02  UD6F				      PIC X.
	   02  FILLER REDEFINES UD6F.
	       03  UD6A 			      PIC X.
	   02  UD6I				      PIC X(008).
	   02  UD7L				      PIC S9(4) COMP.
	   02  UD7F				      PIC X.
	   02  FILLER REDEFINES UD7F.
	       03  UD7A 			      PIC X.
	   02  UD7I				      PIC X(008).
	   02  UD8L				      PIC S9(4) COMP.
	   02  UD8F				      PIC X.
	   02  FILLER REDEFINES UD8F.
	       03  UD8A 			      PIC X.
	   02  UD8I				      PIC X(008).
	   02  UD9L				      PIC S9(4) COMP.
	   02  UD9F				      PIC X.
	   02  FILLER REDEFINES UD9F.
	       03  UD9A 			      PIC X.
	   02  UD9I				      PIC X(008).
	   02  UD10L				      PIC S9(4) COMP.
	   02  UD10F				      PIC X.
	   02  FILLER REDEFINES UD10F.
	       03  UD10A			      PIC X.
	   02  UD10I				      PIC X(008).
	   02  UD11L				      PIC S9(4) COMP.
	   02  UD11F				      PIC X.
	   02  FILLER REDEFINES UD11F.
	       03  UD11A			      PIC X.
	   02  UD11I				      PIC X(008).
	   02  UB1L				      PIC S9(4) COMP.
	   02  UB1F				      PIC X.
	   02  FILLER REDEFINES UB1F.
	       03  UB1A 			      PIC X.
	   02  UB1I				      PIC X(007).
	   02  UB2L				      PIC S9(4) COMP.
	   02  UB2F				      PIC X.
	   02  FILLER REDEFINES UB2F.
	       03  UB2A 			      PIC X.
	   02  UB2I				      PIC X(007).
	   02  UB3L				      PIC S9(4) COMP.
	   02  UB3F				      PIC X.
	   02  FILLER REDEFINES UB3F.
	       03  UB3A 			      PIC X.
	   02  UB3I				      PIC X(007).
	   02  UB4L				      PIC S9(4) COMP.
	   02  UB4F				      PIC X.
	   02  FILLER REDEFINES UB4F.
	       03  UB4A 			      PIC X.
	   02  UB4I				      PIC X(007).
	   02  UB5L				      PIC S9(4) COMP.
	   02  UB5F				      PIC X.
	   02  FILLER REDEFINES UB5F.
	       03  UB5A 			      PIC X.
	   02  UB5I				      PIC X(007).
	   02  UB6L				      PIC S9(4) COMP.
	   02  UB6F				      PIC X.
	   02  FILLER REDEFINES UB6F.
	       03  UB6A 			      PIC X.
	   02  UB6I				      PIC X(007).
	   02  UB7L				      PIC S9(4) COMP.
	   02  UB7F				      PIC X.
	   02  FILLER REDEFINES UB7F.
	       03  UB7A 			      PIC X.
	   02  UB7I				      PIC X(007).
	   02  UB8L				      PIC S9(4) COMP.
	   02  UB8F				      PIC X.
	   02  FILLER REDEFINES UB8F.
	       03  UB8A 			      PIC X.
	   02  UB8I				      PIC X(007).
	   02  UB9L				      PIC S9(4) COMP.
	   02  UB9F				      PIC X.
	   02  FILLER REDEFINES UB9F.
	       03  UB9A 			      PIC X.
	   02  UB9I				      PIC X(007).
	   02  UB10L				      PIC S9(4) COMP.
	   02  UB10F				      PIC X.
	   02  FILLER REDEFINES UB10F.
	       03  UB10A			      PIC X.
	   02  UB10I				      PIC X(007).
	   02  UB11L				      PIC S9(4) COMP.
	   02  UB11F				      PIC X.
	   02  FILLER REDEFINES UB11F.
	       03  UB11A			      PIC X.
	   02  UB11I				      PIC X(007).
	   02  MSGL				      PIC S9(4) COMP.
	   02  MSGF				      PIC X.
	   02  FILLER REDEFINES MSGF.
	       03  MSGA 			      PIC X.
	   02  MSGI				      PIC X(060).
	   02  ADDL				      PIC S9(4) COMP.
	   02  ADDF				      PIC X.
	   02  FILLER REDEFINES ADDF.
	       03  ADDA 			      PIC X.
	   02  ADDI				      PIC X(009).
	   02  EXITL				      PIC S9(4) COMP.
	   02  EXITF				      PIC X.
	   02  FILLER REDEFINES EXITF.
	       03  EXITA			      PIC X.
	   02  EXITI				      PIC X(010).
	   02  FINDL				      PIC S9(4) COMP.
	   02  FINDF				      PIC X.
	   02  FILLER REDEFINES FINDF.
	       03  FINDA			      PIC X.
	   02  FINDI				      PIC X(010).
	   02  UPL				      PIC S9(4) COMP.
	   02  UPF				      PIC X.
	   02  FILLER REDEFINES UPF.
	       03  UPA				      PIC X.
	   02  UPI				      PIC X(008).
	   02  DOWNL				      PIC S9(4) COMP.
	   02  DOWNF				      PIC X.
	   02  FILLER REDEFINES DOWNF.
	       03  DOWNA			      PIC X.
	   02  DOWNI				      PIC X(010).
	   02  RESETL				      PIC S9(4) COMP.
	   02  RESETF				      PIC X.
	   02  FILLER REDEFINES RESETF.
	       03  RESETA			      PIC X.
	   02  RESETI				      PIC X(012).
       01  SM001MO REDEFINES SM001MI.
	   02  FILLER				      PIC X(12).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  DATEO				      PIC X(010).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  PAGEO				      PIC X(002).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  TIMEO				      PIC X(008).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  TITLEO				      PIC X(020).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  STATUSO				      PIC X(007).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  TODATEO				      PIC X(008).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  FRDATEO				      PIC X(008).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UC1O				      PIC X(001).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UC2O				      PIC X(001).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UC3O				      PIC X(001).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UC4O				      PIC X(001).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UC5O				      PIC X(001).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UC6O				      PIC X(001).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UC7O				      PIC X(001).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UC8O				      PIC X(001).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UC9O				      PIC X(001).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UC10O				      PIC X(001).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UC11O				      PIC X(001).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  TN1O				      PIC X(006).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  TN2O				      PIC X(006).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  TN3O				      PIC X(006).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  TN4O				      PIC X(006).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  TN5O				      PIC X(006).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  TN6O				      PIC X(006).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  TN7O				      PIC X(006).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  TN8O				      PIC X(006).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  TN9O				      PIC X(006).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  TN10O				      PIC X(006).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  TN11O				      PIC X(006).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  TT1O				      PIC X(020).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  TT2O				      PIC X(020).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  TT3O				      PIC X(020).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  TT4O				      PIC X(020).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  TT5O				      PIC X(020).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  TT6O				      PIC X(020).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  TT7O				      PIC X(020).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  TT8O				      PIC X(020).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  TT9O				      PIC X(020).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  TT10O				      PIC X(020).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  TT11O				      PIC X(020).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  ST1O				      PIC X(010).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  ST2O				      PIC X(010).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  ST3O				      PIC X(010).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  ST4O				      PIC X(010).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  ST5O				      PIC X(010).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  ST6O				      PIC X(010).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  ST7O				      PIC X(010).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  ST8O				      PIC X(010).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  ST9O				      PIC X(010).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  ST10O				      PIC X(010).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  ST11O				      PIC X(010).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UD1O				      PIC X(008).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UD2O				      PIC X(008).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UD3O				      PIC X(008).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UD4O				      PIC X(008).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UD5O				      PIC X(008).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UD6O				      PIC X(008).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UD7O				      PIC X(008).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UD8O				      PIC X(008).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UD9O				      PIC X(008).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UD10O				      PIC X(008).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UD11O				      PIC X(008).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UB1O				      PIC X(007).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UB2O				      PIC X(007).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UB3O				      PIC X(007).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UB4O				      PIC X(007).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UB5O				      PIC X(007).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UB6O				      PIC X(007).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UB7O				      PIC X(007).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UB8O				      PIC X(007).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UB9O				      PIC X(007).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UB10O				      PIC X(007).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UB11O				      PIC X(007).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  MSGO				      PIC X(060).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  ADDO				      PIC X(009).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  EXITO				      PIC X(010).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  FINDO				      PIC X(010).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  UPO				      PIC X(008).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  DOWNO				      PIC X(010).
	   02  FILLER				      PIC XX.
	   02  FILLER				      PIC X.
	   02  RESETO				      PIC X(012).
      *$PP-END-COPY
       01  WS-SM001 REDEFINES SM001MI.
	   05  FILLER		       PIC X(96).
	   05  UC  OCCURS 11.
	       10  UCL		       PIC S9(4) COMP.
	       10  UCF		       PIC X.
	       10  FILLER REDEFINES UCF.
		   15  UCA	       PIC X.
	       10  UCI		       PIC X(001).
	   05  TN  OCCURS 11.
	       10  TNL		       PIC S9(4) COMP.
	       10  TNF		       PIC X.
	       10  FILLER REDEFINES TNF.
		   15  TNA	       PIC X.
	       10  TNI		       PIC X(006).
	   05  TT     OCCURS 11.
	       10  TTL		      PIC S9(4) COMP.
	       10  TTF		      PIC X.
	       10  FILLER REDEFINES TTF.
		   15  TTA	      PIC X.
	       10  TTI		      PIC X(020).
	   05  ST     OCCURS 11.
	       10  STL		      PIC S9(4) COMP.
	       10  STF		      PIC X.
	       10  FILLER REDEFINES STF.
		   15 STA	      PIC X.
	       10  STI		      PIC X(010).
	   05  UD      OCCURS 11.
	       10  UDL		     PIC S9(4) COMP.
	       10  UDF		     PIC X.
	       10  FILLER REDEFINES UDF.
		   15  UDA	     PIC X.
	       10  UDI		     PIC X(008).
	   05  UB     OCCURS 11.
	       10  UBL		      PIC S9(4) COMP.
	       10  UBF		      PIC X.
	       10  FILLER REDEFINES UBF.
		   15  UBA	      PIC X.
	       10  UBI		      PIC X(007).

      *
      PCOPY DFHAID.
      *$PP-START-COPY C:\HANDSON-CICS\CAWB30\CICSCOPY\DFHAID.COB
       01  DFHAID.
      *
      * CA-Realia CICS 6.0 Computer Associates International, Inc.
      *
      * Revision Information
      * ^{File:dfhaid.cob  }
      * ^{Timestamp:Thu May 15 14:02:52 1997}
      * ^{Revision:2.0}
      *
      *This is the AID constants copy file
      *
           05  DFHENTER                  PIC X VALUE ''''.
      * 				 value APOST
           05  DFHCLEAR                  PIC X VALUE '_'.
           05  DFHPA1                    PIC X VALUE '%'.
           05  DFHPA2                    PIC X VALUE '>'.
           05  DFHPA3                    PIC X VALUE ','.
           05  DFHPF1                    PIC X VALUE '1'.
           05  DFHPF2                    PIC X VALUE '2'.
           05  DFHPF3                    PIC X VALUE '3'.
           05  DFHPF4                    PIC X VALUE '4'.
           05  DFHPF5                    PIC X VALUE '5'.
           05  DFHPF6                    PIC X VALUE '6'.
           05  DFHPF7                    PIC X VALUE '7'.
           05  DFHPF8                    PIC X VALUE '8'.
           05  DFHPF9                    PIC X VALUE '9'.
           05  DFHPF10                   PIC X VALUE ':'.
           05  DFHPF11                   PIC X VALUE '#'.
           05  DFHPF12                   PIC X VALUE '@'.
           05  DFHPF13                   PIC X VALUE 'A'.
           05  DFHPF14                   PIC X VALUE 'B'.
           05  DFHPF15                   PIC X VALUE 'C'.
           05  DFHPF16                   PIC X VALUE 'D'.
           05  DFHPF17                   PIC X VALUE 'E'.
           05  DFHPF18                   PIC X VALUE 'F'.
           05  DFHPF19                   PIC X VALUE 'G'.
           05  DFHPF20                   PIC X VALUE 'H'.
           05  DFHPF21                   PIC X VALUE 'I'.
           05  DFHPF22                   PIC X VALUE '›'.
      *                                  EBCDIC Cent sign x'4A'
      *                                  ASCII  Cent sign x'9B'
           05  DFHPF23                   PIC X VALUE '.'.
           05  DFHPF24                   PIC X VALUE '<'.
           05  DFHOPID                   PIC X VALUE 'W'.
           05  DFHMSRE                   PIC X VALUE 'X'.
           05  DFHTRIG                   PIC X VALUE '"'.
      *                                        value QUOTE  "
           05  DFHPEN                    PIC X VALUE '='.
           05  DFHCLRP                   PIC X VALUE 'Ý'.
      *                                  EBCDIC x'6A'
      *                                  ASCII  x'DD'
           05  DFHSTRF                   PIC X VALUE 'h'.
      *    DFHQUIT is a CA-Realia CICS Extension
      *    It is set by using <Ctrl>+C or <Ctrl>+<Break> Keys
           05  DFHQUIT                   PIC X VALUE '!'.
	   05  DFHNULL			 PIC X VALUE LOW-VALUE.
      *$PP-END-COPY
      *
      PCOPY DFHBMSCA.
      *$PP-START-COPY C:\HANDSON-CICS\CAWB30\CICSCOPY\DFHBMSCA.COB
       01  DFHBMSCA.
      *
      * CA-Realia CICS 6.0 Computer Associates International, Inc.
      *
      * Revision Information
      * ^{File:dfhbmsca.cob}
      * ^{Timestamp:Tue Oct 08 15:34:54 1996}
      * ^{Revision:2.0}
      *
      *  Note:This FILE is provided with most values as quoted literals
      *       so that the file can be used for both ASCII and EBCDIC
      *       programs
      *
      *       The only exceptions are some 3270 Data Stream Orders
      *       They use different Hexadecimal values for ASCII and
      *       EBCDIC and they cannot be expressed as quoted literals
      *       as the values are <Line Feed>, <Tab>, <End of File> etc.
      *       characters in ASCII
      *
      *       They have their values set up to default to the EBCDIC
      *       values.
      *
      *       3270 orders are only needed for EXEC CICS SEND and RECEIVE
      *       and SEND TEXT with imbedded format orders.
      *       If you use these values in ASCII programs the values
      *       must be changed.
      *
      *       An alternative is to use REPLACING to change the values.
      *
      *    i.e. COPY DFHBMSCA replacing
      * 		     ==005== BY ==009==  *> DFHPT
      * 		     ==021== BY ==010==  *> DFHNL
      * 		     ==040== BY ==021==  *> DFHSA
      * 		     ==041== BY ==031==  *> DFHSFE
      * 		     ==044== BY ==023==  *> DFHMF
      * 		     ==060== BY ==020==  *> DFHRA
      * 		     ==063== BY ==026==. *> DFHSUB
      *
      ******************************************************************
      *BMS and Terminal Control - Order & Attributes constants	       *
      ******************************************************************
      *
      *    Field Attributes
      *
           05  DFHBMASB                          PIC X VALUE '8'.
           05  DFHBMASF                          PIC X VALUE '1'.
           05  DFHBMASK                          PIC X VALUE '0'.
           05  DFHBMBRY                          PIC X VALUE 'H'.
           05  DFHBMDAR                          PIC X VALUE '<'.
           05  DFHBMFSE                          PIC X VALUE 'A'.
           05  DFHBMPRF                          PIC X VALUE '/'.
           05  DFHBMPRO                          PIC X VALUE '-'.
           05  DFHBMUNN                          PIC X VALUE '&'.
           05  DFHBMUNP                          PIC X VALUE ' '.
           05  DFHUNNUM                          PIC X VALUE 'J'.
      *
      *    partially supported
      *
           05  DFHUNNOD                          PIC X VALUE '('.
           05  DFHUNIMD                          PIC X VALUE 'I'.
           05  DFHUNINT                          PIC X VALUE 'R'.
           05  DFHUNNON                          PIC X VALUE '('.
           05  DFHPROTI                          PIC X VALUE 'Y'.
           05  DFHPROTN                          PIC X VALUE '%'.
      *
      *    These values are additions to mainframe constants
      *
           05  DFHBMS-ASK-DARK                   PIC X VALUE '@'.
           05  DFHBMS-ASK-BRY-FSET               PIC X VALUE '9'.
           05  DFHBMS-ASK-DAR-FSET               PIC X VALUE ''''.
      * 					       VALUE APOST
           05  DFHBMS-PRO-BRY-FSET               PIC X VALUE 'Z'.
           05  DFHBMS-PRO-DAR-FSET               PIC X VALUE '_'.
           05  DFHBMS-NUM-BRY                    PIC X VALUE 'Q'.
           05  DFHBMS-NUM-DAR                    PIC X VALUE '*'.
           05  DFHBMS-NUM-DAR-FSET               PIC X VALUE ')'.
      *
      *    Field Flag values
	   05  DFHBMEOF-VAL VALUE 128		 PIC S9(4) COMP-4.
	   05  FILLER REDEFINES DFHBMEOF-VAL.
	       10  FILLER			 PIC X.
	       10  DFHBMEOF			 PIC X.
      *                                          x'80'.
	   05  DFHBMCUR-VAL VALUE 002		 PIC S9(4) COMP-4.
	   05  FILLER REDEFINES DFHBMCUR-VAL.
	       10  FILLER			 PIC X.
	       10  DFHBMCUR			 PIC X.
      *                                          x'02'.
	   05  DFHBMMEC-VAL VALUE 130		 PIC S9(4) COMP-4.
	   05  FILLER REDEFINES DFHBMMEC-VAL.
	       10  FILLER			 PIC X.
	       10  DFHBMMEC			 PIC X.
      *                                          x'82'.
      *                                          x'02'.
	   05  DFHBMFLG-VAL  VALUE 0		 PIC S9(4) COMP-4.
	       88  DFHERASE			 VALUES 128 130.
      *                                          x'80' X'82'
	       88  DFHCURSR			 VALUES 002 130.
      *                                          x'02' X'82'
	   05  FILLER REDEFINES DFHBMFLG-VAL.
	       10  FILLER			 PIC X.
	       10  DFHBMFLG			 PIC X.

	   05  DFHBMDUP-VAL VALUE 028		 PIC S9(4) COMP-4.
	   05  FILLER REDEFINES DFHBMDUP-VAL.
	       10  FILLER			 PIC X.
	       10  DFHBMDUP			 PIC X.
      *                                              x'1C'
      *
      ******************************************************************
      *    supported 327X Extended Attributes
      *
      *    Extended COLOR Attributes
      *
           05  DFHDFCOL                          PIC X VALUE '0'.
           05  DFHBLUE                           PIC X VALUE '1'.
           05  DFHRED                            PIC X VALUE '2'.
           05  DFHPINK                           PIC X VALUE '3'.
           05  DFHGREEN                          PIC X VALUE '4'.
           05  DFHTURQ                           PIC X VALUE '5'.
           05  DFHYELLO                          PIC X VALUE '6'.
           05  DFHNEUTR                          PIC X VALUE '7'.
      *
      *    Extended HILIGHT Attributes
      *
           05  DFHDFHI                           PIC X VALUE '0'.
           05  DFHBLINK                          PIC X VALUE '1'.
           05  DFHREVRS                          PIC X VALUE '2'.
           05  DFHUNDLN                          PIC X VALUE '4'.
      *
      ******************************************************************
      *    supported 327X Data Stream Orders
      *
	   05  DFHSBA-VAL VALUE 017		  PIC S9(4) COMP-4.
	   05  FILLER REDEFINES DFHSBA-VAL.
	       10  FILLER			 PIC X.
	       10  DFHSBA			 PIC X.
      *                                              x'11'
	   05  DFHEUA-VAL VALUE 018		 PIC S9(4) COMP-4.
	   05  FILLER REDEFINES DFHEUA-VAL.
	       10  FILLER			 PIC X.
	       10  DFHEUA			 PIC X.
      *                                              x'12'
	   05  DFHIC-VAL VALUE 019		 PIC S9(4) COMP-4.
	   05  FILLER REDEFINES DFHIC-VAL.
	       10  FILLER			 PIC X.
	       10  DFHIC			 PIC X.
      *                                              X'13'.
	   05  DFHSF-VAL VALUE 029		 PIC S9(4) COMP-4.
	   05  FILLER REDEFINES DFHSF-VAL.
	       10  FILLER			 PIC X.
	       10  DFHSF			 PIC X.
      *                                              X'1D'.
	   05  DFHPT-VAL VALUE 005		 PIC S9(4) COMP-4.
	       88 DFHPT-VAL-EBCDIC		 VALUE 5.
	       88 DFHPT-VAL-ASCII		 VALUE 9.
	   05  FILLER REDEFINES DFHPT-VAL.
	       10  FILLER			 PIC X.
	       10  DFHPT			 PIC X.
      *                                              EBCDIC X'05'.
      *                                              ASCII  X'09'.
	   05  DFHRA-VAL VALUE 060		 PIC S9(4) COMP-4.
	       88 DFHRA-VAL-EBCDIC		 VALUE 60.
	       88 DFHRA-VAL-ASCII		 VALUE 20.
	   05  FILLER REDEFINES DFHRA-VAL.
	       10  FILLER			 PIC X.
	       10  DFHRA			 PIC X.
      *                                              EBCDIC x'3C'
      *                                              ASCII  x'14'
	   05  DFHSFE-VAL VALUE 041		 PIC S9(4) COMP-4.
	       88 DFHSFE-VAL-EBCDIC		 VALUE 41.
	       88 DFHSFE-VAL-ASCII		 VALUE 31.
	   05  FILLER REDEFINES DFHSFE-VAL.
	       10  FILLER			 PIC X.
	       10  DFHSFE			 PIC X.
      *                                              EBCDIC x'29'
      *                                              ASCII  x'1F'
	   05  DFHMF-VAL VALUE 044		 PIC S9(4) COMP-4.
	       88 DFHMF-VAL-EBCDIC		 VALUE 44.
	       88 DFHMF-VAL-ASCII		 VALUE 23.
	   05  FILLER REDEFINES DFHMF-VAL.
	       10  FILLER			 PIC X.
	       10  DFHMF			 PIC X.
      *                                              EBCDIC x'2C'
      *                                              ASCII  x'17'
      *
      ******************************************************************
      *    unsupported 327X Data Stream order codes
      *
	   05  DFHSA-VAL VALUE 040		 PIC S9(4) COMP-4.
	       88 DFHSA-VAL-EBCDIC		 VALUE 40.
	       88 DFHSA-VAL-ASCII		 VALUE 21.
	   05  FILLER REDEFINES DFHSA-VAL.
	       10  FILLER			 PIC X.
	       10  DFHSA			 PIC X.
      *                                              EBCDIC x'28'
      *                                              ASCII  x'15'
	   05  DFHGE-VAL VALUE 008		 PIC S9(4) COMP-4.
	   05  FILLER REDEFINES DFHGE-VAL.
	       10  FILLER			 PIC X.
	       10  DFHGE			 PIC X.
      *                                              X'08'.
      *
      ******************************************************************
      *    SFE and MF supported attribute types
      *
           05  DFHCOLOR                          PIC X VALUE 'ƒ'.
      *                                              EBCDIC x'42'
      *                                              ASCII  x'83'
           05  DFHHLT                            PIC X VALUE 'Ö'.
      *                                              EBCDIC x'41'
      *                                              ASCII  x'D6'
           05  DFH3270                           PIC X VALUE '{'.
      *
      *    supported for SEND TEXT command and printer terminal
      *
	   05  DFHBMPNL-VAL VALUE 021		 PIC S9(4) COMP-4.
	       88 DFHBMPNL-VAL-EBCDIC		 VALUE 21.
	       88 DFHBMPNL-VAL-ASCII		 VALUE 10.
	   05  FILLER REDEFINES DFHBMPNL-VAL.
	       10  FILLER			 PIC X.
	       10  DFHBMPNL			 PIC X.
      *                                              EBCDIC X'15'.
      *                                              ASCII  X'0A'.
      *
      ******************************************************************
      *    Printer terminal data stream only
      *
	   05  DFHBMPFF-VAL VALUE 012		 PIC S9(4) COMP-4.
	   05  FILLER REDEFINES DFHBMPFF-VAL.
	       10  FILLER			 PIC X.
	       10  DFHBMPFF			 PIC X.
      *                                              X'0C'.
	   05  DFHBMPCR-VAL VALUE 013		 PIC S9(4) COMP-4.
	   05  FILLER REDEFINES DFHBMPCR-VAL.
	       10  FILLER			 PIC X.
	       10  DFHBMPCR			 PIC X.
      *                                              X'0D'.
	   05  DFHBMPEM-VAL VALUE 025		 PIC S9(4) COMP-4.
	   05  FILLER REDEFINES DFHBMPEM-VAL.
	       10  FILLER			 PIC X.
	       10  DFHBMPEM			 PIC X.
      *                                              X'19'.
      *
      ******************************************************************
      *    unsupported Miscellaneous attributes and constants
      *
	   05  DFHALL				 PIC X VALUE LOW-VALUES.
           05  DFHBASE                           PIC X VALUE '0'.
	   05  DFHBMDET 			 PIC X VALUE LOW-VALUES.
	   05  DFHBMPSOSI-VAL VALUE 3599	 PIC S9(4) COMP-4.
	   05  FILLER REDEFINES DFHBMPSOSI-VAL.
	       10  DFHBMPSO			 PIC X.
      *                                              X'0E'.
	       10  DFHBMPSI			 PIC X.
      *                                              X'0F'.
	   05  DFHDFT VALUE HIGH-VALUES 	 PIC X.
           05  DFHERROR                          PIC X VALUE '¶'.
      *                                              EBCDIC X'1A'.
      *                                              ASCII  X'B6'.
           05  DFHFIL                            PIC X VALUE '4'.
           05  DFHMENT                           PIC X VALUE '2'.
           05  DFHMET                            PIC X VALUE '3'.
           05  DFHMFE                            PIC X VALUE '6'.
           05  DFHMFET                           PIC X VALUE '7'.
           05  DFHMFT                            PIC X VALUE '5'.
           05  DFHMT                             PIC X VALUE '1'.
           05  DFHOUTLN                          PIC X VALUE 'B'.
           05  DFHPS                             PIC X VALUE '„'.
      *                                              EBCDIC x'43'
      *                                              ASCII  x'84'
           05  DFHVAL                            PIC X VALUE 'A'.
      *
	   05  DFHSUB-VAL   VALUE 063		 PIC S9(4) COMP-4.
	       88 DFHSUB-VAL-EBCDIC		 VALUE 63.
	       88 DFHSUB-VAL-ASCII		 VALUE 26.
	   05  FILLER REDEFINES DFHSUB-VAL.
	       10  FILLER			 PIC X.
	       10  DFHSUB			 PIC X.
      *                                              EBCDIC X'3F'.
      *                                              ASCII  X'1A'.
      *
	   05  DFHFM-VAL    VALUE 030		 PIC S9(4) COMP-4.
	   05  FILLER REDEFINES DFHFM-VAL.
	       10  FILLER			 PIC X.
	       10  DFHFM			 PIC X.
      *                                              EBCDIC X'1E'.
	   05  DFHEO VALUE HIGH-VALUE		 PIC X.
      *$PP-END-COPY

       LINKAGE SECTION.
      *$PP-START-INSERT CICS NA 					REALCICS
       01  DFHEIBLK.							REALCICS
	   05 EIBTIME  PIC S9(7) COMP-3.				REALCICS
	   05 EIBDATE  PIC S9(7) COMP-3.				REALCICS
	   05 EIBTRNID PIC X(4).					REALCICS
	   05 EIBTASKN PIC S9(7) COMP-3.				REALCICS
	   05 EIBTRMID PIC X(4).					REALCICS
	   05 DFHEIGDI PIC S9(4) COMP-4.				REALCICS
	   05 EIBCPOSN PIC S9(4) COMP-4.				REALCICS
	   05 EIBCALEN PIC S9(4) COMP-4.				REALCICS
	   05 EIBAID   PIC X.						REALCICS
	   05 EIBFN    PIC X(2).					REALCICS
	   05 EIBRCODE PIC X(6).					REALCICS
	   05 EIBDS    PIC X(8).					REALCICS
	   05 EIBREQID PIC X(8).					REALCICS
	   05 EIBRSRCE PIC X(8).					REALCICS
	   05 EIBSYNC  PIC X.						REALCICS
	   05 EIBFREE  PIC X.						REALCICS
	   05 EIBRECV  PIC X.						REALCICS
	   05 EIBSEND  PIC X.						REALCICS
	   05 EIBATT   PIC X.						REALCICS
	   05 EIBEOC   PIC X.						REALCICS
	   05 EIBFMH   PIC X.						REALCICS
	   05 EIBCOMPL PIC X.						REALCICS
	   05 EIBSIG   PIC X.						REALCICS
	   05 EIBCONF  PIC X.						REALCICS
	   05 EIBERR   PIC X.						REALCICS
	   05 EIBERRCD PIC X(4).					REALCICS
	   05 EIBSYNRB PIC X.						REALCICS
	   05 EIBNODAT PIC X.						REALCICS
	   05 EIBRESP  PIC S9(8) COMP-4.				REALCICS
	   05 EIBRESP2 PIC S9(8) COMP-4.				REALCICS
	   05 EIBRLDBK PIC X.						REALCICS
	   05 EIBCARESERVED PIC X(32).					REALCICS
      *$PP-END-INSERT CICS NA						REALCICS
	01  DFHCOMMAREA 		       PIC X(322).
      *
       PROCEDURE DIVISION						REALCICS
      *$PP-START-INSERT CICS NA 					REALCICS
	   USING DFHEIBLK DFHCOMMAREA.					REALCICS
      *$PP-END-INSERT CICS NA						REALCICS
      *$PP-NOLIST CICS HI						REALCICS
       DFH-ROUTINES SECTION.						REALCICS
       DFH-ENTRY.							REALCICS
           MOVE 'sm001p' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 0 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE LOW-VALUE TO DFH-COMMAND				REALCICS
           CALL 'Mli_GetLAdr' USING DFHEIBLK DFH-ADDR (1)               REALCICS
           CALL 'Mli_GetMaxLen' USING DFHCOMMAREA DFH-WORK-01           REALCICS
	   ADD 0 DFH-WORK-01 GIVING DFH-SIZE (1)			REALCICS
           CALL 'REALIA_GET_PARM_COUNT' USING DFH-WORK-01               REALCICS
	   ADD 0 DFH-WORK-01U GIVING DFH-FLAG (1)			REALCICS
	   MOVE 1 TO DFH-VARS-COUNT					REALCICS
	   MOVE LOW-VALUE TO DFH-COMMAND				REALCICS
           CALL 'CICS_Module_Init' USING CICSICB GIVING                 REALCICS
	       DFH-RETURN-STATUS					REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN END-IF			REALCICS
	   GO TO DFH-MAINLINE-ENTRY.					REALCICS
       DFH-GET-INFO.							REALCICS
           ENTRY 'CACX_GET_INFO_SM001P' USING DFHEIBLK.                 REALCICS
	   STRING DFH-MODULE-INFO DELIMITED BY SIZE INTO EIBCARESERVED	REALCICS
	   GOBACK.							REALCICS
       DFH-MAINLINE-ENTRY SECTION.					REALCICS
      *$PP-LIST CICS HI 						REALCICS
       100-PROCESS SECTION.
           IF EIBTRNID = 'SM00' OR 'SM01' OR 'SM02' OR 'SM03' OR 'SM04'
                          OR 'SM05' OR 'SM06'
	       MOVE DFHCOMMAREA TO WS-COMMAREA
      *$PP-DEBUG							REALCICS
      P        EXEC CICS
      P 	 IGNORE CONDITION ERROR
      P        END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 161 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '0' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (02)                              REALCICS
           MOVE X'020A' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 002 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_HANDLE' USING CICSICB GIVING                 REALCICS
	       DFH-RETURN-STATUS					REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS

	       IF EIBCALEN = +0
		   STRING EIBTRMID DELIMITED BY SIZE
			   EIBTRNID DELIMITED BY SIZE
		       INTO WS-QNAME
		   MOVE LENGTH OF SM001MI TO WS-LENGTH
		   MOVE 1 TO WS-PAGE
		   MOVE WS-PAGE TO PAGEO
		   PERFORM 999-MOVE-FILE-TO-Q
		   PERFORM 500-MOVE-Q-TO-SCREEN
		   PERFORM 100-NEW-MAP
	       ELSE
      *$PP-DEBUG							REALCICS
      P 	    EXEC CICS
      P                  RECEIVE MAP ('SM001M')
      P                  MAPSET ('SM001S')
      P 		 INTO (SM001MI)
      P 	     END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 176 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '8' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '7 ' TO DFH-DATA-CLASS (02)                             REALCICS
           MOVE 'SM001M' TO DFH-DATA7 (02)                              REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF DFH-DATA7 (02)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA7 (02) GIVING DFH-SIZE (02)		REALCICS
	   MOVE 001 TO DFH-FLAG (03)					REALCICS
           MOVE '8' TO DFH-DATA-TYPE (03)                               REALCICS
           MOVE '7 ' TO DFH-DATA-CLASS (03)                             REALCICS
           MOVE 'SM001S' TO DFH-DATA7 (03)                              REALCICS
	   SET DFH-ADDR (03) TO ADDRESS OF DFH-DATA7 (03)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA7 (03) GIVING DFH-SIZE (03)		REALCICS
	   MOVE 001 TO DFH-FLAG (04)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (04)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (04)                              REALCICS
	   SET DFH-ADDR (04) TO ADDRESS OF SM001MI			REALCICS
	   ADD 0 LENGTH OF SM001MI GIVING DFH-SIZE (04) 		REALCICS
	   MOVE 002 TO DFH-FLAG (05)					REALCICS
           MOVE '0' TO DFH-DATA-TYPE (05)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (05)                              REALCICS
           MOVE X'1802' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 005 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS
      *$PP-START-INSERT CICS NA 					REALCICS
      P 	    IF	NOT EIBRESP = DFHRESP(MAPFAIL)
      *$PP-END-INSERT CICS NA						REALCICS
		    IF	NOT EIBRESP =	      036			REALCICS
			EVALUATE EIBAID
			 WHEN DFHPF2
			    PERFORM 240-WHENF2
			 WHEN DFHPF3
      *$PP-DEBUG							REALCICS
      P 		    EXEC CICS DELETEQ TS
      P 			 QUEUE(WS-QNAME)
      P 		    END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 186 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '2' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (02)                             REALCICS
	   MOVE WS-QNAME TO DFH-DATA8 (02)				REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF DFH-DATA8 (02)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA8 (02) GIVING DFH-SIZE (02)		REALCICS
           MOVE X'0A06' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 002 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS
      *$PP-DEBUG							REALCICS
      P 		    EXEC CICS SEND TEXT
      P 		       FROM(WS-FILLER)
      P 		       LENGTH(+500)
      P 		       ERASE
      P 		    END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 189 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (02)                              REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF WS-FILLER			REALCICS
	   ADD 0 LENGTH OF WS-FILLER GIVING DFH-SIZE (02)		REALCICS
	   MOVE 001 TO DFH-FLAG (03)					REALCICS
           MOVE '8' TO DFH-DATA-TYPE (03)                               REALCICS
           MOVE 'H ' TO DFH-DATA-CLASS (03)                             REALCICS
	   ADD 0 +500 GIVING DFH-DATAH (03)				REALCICS
	   SET DFH-ADDR (03) TO ADDRESS OF DFH-DATAH (03)		REALCICS
	   ADD 0 LENGTH OF DFH-DATAH (03) GIVING DFH-SIZE (03)		REALCICS
	   MOVE 001 TO DFH-FLAG (06)					REALCICS
           MOVE '0' TO DFH-DATA-TYPE (06)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (06)                              REALCICS
	   MOVE 003 TO DFH-FLAG (13)					REALCICS
           MOVE '0' TO DFH-DATA-TYPE (13)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (13)                              REALCICS
           MOVE X'1806' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 013 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS
      *$PP-DEBUG							REALCICS
      P 		    EXEC CICS XCTL
      P                        PROGRAM('SM000P')
      P 		    END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 194 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '2' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (02)                             REALCICS
           MOVE 'SM000P' TO DFH-DATA8 (02)                              REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF DFH-DATA8 (02)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA8 (02) GIVING DFH-SIZE (02)		REALCICS
           MOVE X'0E04' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 002 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS
			WHEN DFHENTER
			    PERFORM 250-WHENENTER
			WHEN DFHPF5
			WHEN DFHPF7
			    PERFORM 220-WHENF7
			WHEN DFHPF8
			    PERFORM 230-WHENF8
			WHEN DFHPF12
			    PERFORM 270-WHENF12
			WHEN OTHER
                            MOVE 'INVALID PFKEY PRESSED' TO MSGO
			END-EVALUATE
		   ELSE
                       MOVE 'INVALID PFKEY PRESSED' TO MSGO
		       PERFORM 500-MOVE-Q-TO-SCREEN
		       PERFORM 100-NEW-MAP
		   END-IF
	       END-IF
	   ELSE
      *$PP-DEBUG							REALCICS
      P        EXEC CICS SEND TEXT
      P 	       FROM (WS-INVKEY)
      P 	       LENGTH (22)
      P 	       ERASE
      P        END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 216 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (02)                              REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF WS-INVKEY			REALCICS
	   ADD 0 LENGTH OF WS-INVKEY GIVING DFH-SIZE (02)		REALCICS
	   MOVE 001 TO DFH-FLAG (03)					REALCICS
           MOVE '8' TO DFH-DATA-TYPE (03)                               REALCICS
           MOVE 'H ' TO DFH-DATA-CLASS (03)                             REALCICS
	   ADD 0 22 GIVING DFH-DATAH (03)				REALCICS
	   SET DFH-ADDR (03) TO ADDRESS OF DFH-DATAH (03)		REALCICS
	   ADD 0 LENGTH OF DFH-DATAH (03) GIVING DFH-SIZE (03)		REALCICS
	   MOVE 001 TO DFH-FLAG (06)					REALCICS
           MOVE '0' TO DFH-DATA-TYPE (06)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (06)                              REALCICS
	   MOVE 003 TO DFH-FLAG (13)					REALCICS
           MOVE '0' TO DFH-DATA-TYPE (13)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (13)                              REALCICS
           MOVE X'1806' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 013 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS
      *$PP-DEBUG							REALCICS
      P        EXEC CICS RETURN END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 221 TO DFH-SOURCE-LINE-NUM				REALCICS
           MOVE X'0E08' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 000 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS
	   END-IF.


       100-NEW-MAP SECTION.
      *$PP-DEBUG							REALCICS
      P    EXEC CICS ASSIGN
      P        USERID(WS-USERID)
      P    END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 226 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 080 TO DFH-FLAG (02)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (02)                             REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF WS-USERID			REALCICS
	   ADD 0 LENGTH OF WS-USERID GIVING DFH-SIZE (02)		REALCICS
           MOVE X'0208' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 002 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS

      *$PP-DEBUG							REALCICS
      P    EXEC CICS ASKTIME
      P        ABSTIME	(WS-TIME)
      P    END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 230 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE 'T ' TO DFH-DATA-CLASS (02)                             REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF WS-TIME			REALCICS
	   ADD 0 LENGTH OF WS-TIME GIVING DFH-SIZE (02) 		REALCICS
           MOVE X'4A02' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 002 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS

      *$PP-DEBUG							REALCICS
      P    EXEC CICS FORMATTIME
      P        ABSTIME	(WS-TIME)
      P        DATESEP  ('/')
      P        DDMMYYYY   (DATEO)
      P        TIMESEP    (':')
      P        TIME	  (TIMEO)
      P    END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 234 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE 'T ' TO DFH-DATA-CLASS (02)                             REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF WS-TIME			REALCICS
	   ADD 0 LENGTH OF WS-TIME GIVING DFH-SIZE (02) 		REALCICS
	   MOVE 001 TO DFH-FLAG (09)					REALCICS
           MOVE '8' TO DFH-DATA-TYPE (09)                               REALCICS
           MOVE '1 ' TO DFH-DATA-CLASS (09)                             REALCICS
           MOVE '/' TO DFH-DATA1 (09)                                   REALCICS
	   SET DFH-ADDR (09) TO ADDRESS OF DFH-DATA1 (09)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA1 (09) GIVING DFH-SIZE (09)		REALCICS
	   MOVE 001 TO DFH-FLAG (21)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (21)                               REALCICS
           MOVE 'A ' TO DFH-DATA-CLASS (21)                             REALCICS
	   SET DFH-ADDR (21) TO ADDRESS OF DATEO			REALCICS
	   ADD 0 LENGTH OF DATEO GIVING DFH-SIZE (21)			REALCICS
	   MOVE 001 TO DFH-FLAG (17)					REALCICS
           MOVE '8' TO DFH-DATA-TYPE (17)                               REALCICS
           MOVE '1 ' TO DFH-DATA-CLASS (17)                             REALCICS
           MOVE ':' TO DFH-DATA1 (17)                                   REALCICS
	   SET DFH-ADDR (17) TO ADDRESS OF DFH-DATA1 (17)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA1 (17) GIVING DFH-SIZE (17)		REALCICS
	   MOVE 001 TO DFH-FLAG (15)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (15)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (15)                             REALCICS
	   SET DFH-ADDR (15) TO ADDRESS OF TIMEO			REALCICS
	   ADD 0 LENGTH OF TIMEO GIVING DFH-SIZE (15)			REALCICS
           MOVE X'4A04' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 021 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS

      *$PP-DEBUG							REALCICS
      P    EXEC CICS
      P        SEND MAP ('SM001M')
      P        MAPSET ('SM001S')
      P        FROM (SM001MO)
      P        LENGTH(WS-LENGTH)
      P        ERASE
      P    END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 242 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '8' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '7 ' TO DFH-DATA-CLASS (02)                             REALCICS
           MOVE 'SM001M' TO DFH-DATA7 (02)                              REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF DFH-DATA7 (02)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA7 (02) GIVING DFH-SIZE (02)		REALCICS
	   MOVE 001 TO DFH-FLAG (03)					REALCICS
           MOVE '8' TO DFH-DATA-TYPE (03)                               REALCICS
           MOVE '7 ' TO DFH-DATA-CLASS (03)                             REALCICS
           MOVE 'SM001S' TO DFH-DATA7 (03)                              REALCICS
	   SET DFH-ADDR (03) TO ADDRESS OF DFH-DATA7 (03)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA7 (03) GIVING DFH-SIZE (03)		REALCICS
	   MOVE 001 TO DFH-FLAG (04)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (04)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (04)                              REALCICS
	   SET DFH-ADDR (04) TO ADDRESS OF SM001MO			REALCICS
	   ADD 0 LENGTH OF SM001MO GIVING DFH-SIZE (04) 		REALCICS
	   MOVE 001 TO DFH-FLAG (06)					REALCICS
           MOVE '8' TO DFH-DATA-TYPE (06)                               REALCICS
           MOVE 'H ' TO DFH-DATA-CLASS (06)                             REALCICS
	   ADD 0 WS-LENGTH GIVING DFH-DATAH (06)			REALCICS
	   SET DFH-ADDR (06) TO ADDRESS OF DFH-DATAH (06)		REALCICS
	   ADD 0 LENGTH OF DFH-DATAH (06) GIVING DFH-SIZE (06)		REALCICS
	   MOVE 001 TO DFH-FLAG (09)					REALCICS
           MOVE '0' TO DFH-DATA-TYPE (09)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (09)                              REALCICS
	   MOVE 003 TO DFH-FLAG (18)					REALCICS
           MOVE '0' TO DFH-DATA-TYPE (18)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (18)                              REALCICS
           MOVE X'1804' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 018 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS

      *$PP-DEBUG							REALCICS
      P    EXEC CICS RETURN
      P        TRANSID('SM01')
      P        COMMAREA(WS-COMMAREA)
      P    END-EXEC.
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 250 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '8' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '4 ' TO DFH-DATA-CLASS (02)                             REALCICS
           MOVE 'SM01' TO DFH-DATA4 (02)                                REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF DFH-DATA4 (02)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA4 (02) GIVING DFH-SIZE (02)		REALCICS
	   MOVE 001 TO DFH-FLAG (04)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (04)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (04)                              REALCICS
	   SET DFH-ADDR (04) TO ADDRESS OF WS-COMMAREA			REALCICS
	   ADD 0 LENGTH OF WS-COMMAREA GIVING DFH-SIZE (04)		REALCICS
           MOVE X'0E08' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 004 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
	   .								REALCICS
      *$PP-LIST 							REALCICS

       220-WHENF7 SECTION.

	    SUBTRACT 11 FROM WS-QITEM-PAGE
	    IF WS-QITEM-PAGE = WS-QITEM-START OR
	       WS-QITEM-PAGE <	WS-QITEM-START
               MOVE 'THIS IS THE FIRST PAGE' TO MSGO
	       MOVE 1 TO WS-PAGE
	       MOVE WS-QITEM-START TO WS-QITEM-PAGE
	    ELSE
	      SUBTRACT 1 FROM WS-PAGE
	    END-IF
	    MOVE WS-PAGE TO PAGEO
	    PERFORM 500-MOVE-Q-TO-SCREEN
	    PERFORM 100-NEW-MAP.

       230-WHENF8 SECTION.

	    ADD 11 TO WS-QITEM-PAGE
	    IF WS-QITEM-PAGE > WS-QITEM-END
	       SUBTRACT 11 FROM WS-QITEM-PAGE
	       MOVE WS-PAGE TO PAGEO
               MOVE 'THIS IS THE LAST PAGE' TO MSGO
	    ELSE
	       ADD 1 TO WS-PAGE
	       MOVE WS-PAGE TO PAGEO
	       PERFORM 500-MOVE-Q-TO-SCREEN
	    END-IF.
	    PERFORM 100-NEW-MAP.

       240-WHENF2 SECTION.
      *$PP-DEBUG							REALCICS
      P    EXEC CICS ASSIGN
      P        USERID(WS-USERID)
      P    END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 285 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 080 TO DFH-FLAG (02)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (02)                             REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF WS-USERID			REALCICS
	   ADD 0 LENGTH OF WS-USERID GIVING DFH-SIZE (02)		REALCICS
           MOVE X'0208' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 002 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS
      *$PP-DEBUG							REALCICS
      P    EXEC CICS
      P        READ FILE('UAF00001')
      P        INTO (WS-USER-REC)
      P        RIDFLD (WS-USERID)
      P        RESP(WS-RESPONSE-CODE)
      P        GTEQ
      P    END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 288 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '8' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (02)                             REALCICS
           MOVE 'UAF00001' TO DFH-DATA8 (02)                            REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF DFH-DATA8 (02)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA8 (02) GIVING DFH-SIZE (02)		REALCICS
	   MOVE 001 TO DFH-FLAG (04)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (04)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (04)                              REALCICS
	   SET DFH-ADDR (04) TO ADDRESS OF WS-USER-REC			REALCICS
	   ADD 0 LENGTH OF WS-USER-REC GIVING DFH-SIZE (04)		REALCICS
	   MOVE 001 TO DFH-FLAG (06)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (06)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (06)                              REALCICS
	   SET DFH-ADDR (06) TO ADDRESS OF WS-USERID			REALCICS
	   ADD 0 LENGTH OF WS-USERID GIVING DFH-SIZE (06)		REALCICS
	   MOVE 001 TO DFH-FLAG (01)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (01)                               REALCICS
           MOVE 'H ' TO DFH-DATA-CLASS (01)                             REALCICS
	   SET DFH-ADDR (01) TO ADDRESS OF WS-RESPONSE-CODE		REALCICS
	   ADD 0 LENGTH OF WS-RESPONSE-CODE GIVING DFH-SIZE (01)	REALCICS
	   MOVE 001 TO DFH-FLAG (11)					REALCICS
           MOVE '0' TO DFH-DATA-TYPE (11)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (11)                              REALCICS
           MOVE X'0602' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 011 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
	   ADD 0 DFH-RESP GIVING WS-RESPONSE-CODE			REALCICS
      *$PP-LIST 							REALCICS
           IF NOT WS-RESPONSE-CODE = +00 OR REQUESTOR NOT = 'Y'
               MOVE 'INVALID ACCESS' TO MSGO
	       PERFORM 100-NEW-MAP
	   ELSE
      *$PP-DEBUG							REALCICS
      P        EXEC CICS SEND TEXT
      P 	   FROM(WS-FILLER)
      P 	   LENGTH(+500)
      P 	   ERASE
      P        END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 299 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (02)                              REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF WS-FILLER			REALCICS
	   ADD 0 LENGTH OF WS-FILLER GIVING DFH-SIZE (02)		REALCICS
	   MOVE 001 TO DFH-FLAG (03)					REALCICS
           MOVE '8' TO DFH-DATA-TYPE (03)                               REALCICS
           MOVE 'H ' TO DFH-DATA-CLASS (03)                             REALCICS
	   ADD 0 +500 GIVING DFH-DATAH (03)				REALCICS
	   SET DFH-ADDR (03) TO ADDRESS OF DFH-DATAH (03)		REALCICS
	   ADD 0 LENGTH OF DFH-DATAH (03) GIVING DFH-SIZE (03)		REALCICS
	   MOVE 001 TO DFH-FLAG (06)					REALCICS
           MOVE '0' TO DFH-DATA-TYPE (06)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (06)                              REALCICS
	   MOVE 003 TO DFH-FLAG (13)					REALCICS
           MOVE '0' TO DFH-DATA-TYPE (13)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (13)                              REALCICS
           MOVE X'1806' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 013 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS
      *$PP-DEBUG							REALCICS
      P        EXEC CICS XCTL
      P            PROGRAM('SM02P')
      P        END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 304 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '2' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (02)                             REALCICS
           MOVE 'SM02P' TO DFH-DATA8 (02)                               REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF DFH-DATA8 (02)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA8 (02) GIVING DFH-SIZE (02)		REALCICS
           MOVE X'0E04' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 002 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS
	   END-IF.

       250-WHENENTER SECTION.
	   IF PAGEI = LOW-VALUES
	       MOVE WS-PAGE TO PAGEI
	   END-IF
	   IF PAGEI NOT = WS-PAGE OR PAGEL = +0
	       MOVE PAGEI TO WS-PG-LIT
	       IF PG-LIT1 IS NUMERIC AND PG-LIT2 IS NUMERIC
		   IF WS-PG-LIT > WS-PAGE
		       COMPUTE WS-COMP = WS-QITEM +
				       ((WS-PG-LIT - 1) - WS-PAGE) * 11
		       IF WS-COMP > WS-QITEM-END
			   PERFORM VARYING WS-INDX FROM WS-QITEM-START
				   BY 1 UNTIL
				WS-INDX > WS-QITEM-END
			       ADD 1 TO WS-TALLY
			   END-PERFORM
			   DIVIDE WS-TALLY BY 11 GIVING WS-REM
			   COMPUTE WS-MAX = WS-REM + 1
			   MOVE WS-MAX TO WS-PAGE
			   MOVE WS-PAGE TO PAGEO
			   COMPUTE WS-QITEM-PAGE = (WS-REM * 11) +
						   WS-QITEM-START
			   PERFORM 500-MOVE-Q-TO-SCREEN
                           MOVE 'THIS IS THE LAST PAGE' TO MSGO
			   PERFORM 100-NEW-MAP
		       ELSE
			   MOVE WS-COMP TO WS-QITEM-PAGE
			   MOVE PAGEI TO WS-PAGE
			   PERFORM 500-MOVE-Q-TO-SCREEN
			   PERFORM 100-NEW-MAP
		       END-IF
		   ELSE
		       IF WS-PG-LIT = 1
			   MOVE PAGEI TO WS-PAGE
			   MOVE WS-QITEM-START TO WS-QITEM-PAGE
			   PERFORM 500-MOVE-Q-TO-SCREEN
                           MOVE 'THIS IS THE FIRST PAGE' TO MSGO
			   PERFORM 100-NEW-MAP
		       ELSE
			   COMPUTE WS-COMP = WS-QITEM-PAGE -
					     (WS-PAGE - WS-PG-LIT) * 11
			   MOVE WS-COMP TO WS-QITEM-PAGE
			   MOVE PAGEI TO WS-PAGE
			   PERFORM 500-MOVE-Q-TO-SCREEN
			   PERFORM 100-NEW-MAP
		       END-IF
		   END-IF
	       ELSE
                   MOVE 'ENTER A NUMERIC PAGE NUMBER' TO MSGO
		   PERFORM 100-NEW-MAP
	       END-IF
	   ELSE
	       MOVE 1 TO WS-INDX
	       PERFORM UNTIL WS-INDX > 11
		   MOVE UCI(WS-INDX) TO WS-CHOICE
                   IF NOT WS-CHOICE = '_'
		       ADD 1 TO WS-COUNTER
		       MOVE WS-INDX TO WS-COUNTER2
		   END-IF
		   ADD 1 TO WS-INDX
	       END-PERFORM
	       IF WS-COUNTER > 1
		   MOVE 1 TO WS-INDX
		   PERFORM UNTIL WS-INDX > 11
                       MOVE '_' TO UCI(WS-INDX)
		       ADD 1 TO WS-INDX
		   END-PERFORM
                   MOVE 'ENTER 1 SELECTION ONLY' TO MSGO
	       ELSE
		   EVALUATE UCI(WS-COUNTER2)
                       WHEN 'U'
                           IF STI(WS-COUNTER2) = 'APPROVED' OR 'ONGOING'
			       PERFORM 600-VALIDATE-USER
			       EVALUATE TRUE
                                   WHEN SERVICE-PROVIDER = 'Y' AND
                                        REQUESTOR = 'Y'
      *$PP-DEBUG							REALCICS
      P 			       EXEC CICS XCTL
      P                                    PROGRAM('SM003P')
      P 			       END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 385 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '2' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (02)                             REALCICS
           MOVE 'SM003P' TO DFH-DATA8 (02)                              REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF DFH-DATA8 (02)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA8 (02) GIVING DFH-SIZE (02)		REALCICS
           MOVE X'0E04' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 002 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS
                                   WHEN SERVICE-PROVIDER = 'Y'
      *$PP-DEBUG							REALCICS
      P 			       EXEC CICS XCTL
      P                                    PROGRAM('SM003P')
      P 			       END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 389 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '2' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (02)                             REALCICS
           MOVE 'SM003P' TO DFH-DATA8 (02)                              REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF DFH-DATA8 (02)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA8 (02) GIVING DFH-SIZE (02)		REALCICS
           MOVE X'0E04' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 002 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS
                                   WHEN REQUESTOR = 'Y'
      *$PP-DEBUG							REALCICS
      P 			       EXEC CICS
      P                                    READ FILE('STF00001')
      P 				   INTO (WS-TIX-REC)
      P 				   RIDFLD (TNI(WS-COUNTER2))
      P 				   RESP(WS-RESPONSE-CODE)
      P 				   EQUAL
      P 			       END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 393 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '8' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (02)                             REALCICS
           MOVE 'STF00001' TO DFH-DATA8 (02)                            REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF DFH-DATA8 (02)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA8 (02) GIVING DFH-SIZE (02)		REALCICS
	   MOVE 001 TO DFH-FLAG (04)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (04)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (04)                              REALCICS
	   SET DFH-ADDR (04) TO ADDRESS OF WS-TIX-REC			REALCICS
	   ADD 0 LENGTH OF WS-TIX-REC GIVING DFH-SIZE (04)		REALCICS
	   MOVE 001 TO DFH-FLAG (06)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (06)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (06)                              REALCICS
	   SET DFH-ADDR (06) TO ADDRESS OF TNI ( WS-COUNTER2 )		REALCICS
	   ADD 0 LENGTH OF TNI ( WS-COUNTER2 ) GIVING DFH-SIZE (06)	REALCICS
	   MOVE 001 TO DFH-FLAG (01)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (01)                               REALCICS
           MOVE 'H ' TO DFH-DATA-CLASS (01)                             REALCICS
	   SET DFH-ADDR (01) TO ADDRESS OF WS-RESPONSE-CODE		REALCICS
	   ADD 0 LENGTH OF WS-RESPONSE-CODE GIVING DFH-SIZE (01)	REALCICS
	   MOVE 002 TO DFH-FLAG (11)					REALCICS
           MOVE '0' TO DFH-DATA-TYPE (11)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (11)                              REALCICS
           MOVE X'0602' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 011 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
	   ADD 0 DFH-RESP GIVING WS-RESPONSE-CODE			REALCICS
      *$PP-LIST 							REALCICS
				       IF WS-USERID = TIX-REQUESTOR
      *$PP-DEBUG							REALCICS
      P 				   EXEC CICS XCTL
      P                                        PROGRAM('SM003P')
      P 				   END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 401 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '2' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (02)                             REALCICS
           MOVE 'SM003P' TO DFH-DATA8 (02)                              REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF DFH-DATA8 (02)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA8 (02) GIVING DFH-SIZE (02)		REALCICS
           MOVE X'0E04' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 002 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS
				       ELSE
                                           MOVE '_' TO UCI(WS-COUNTER2)
                                           MOVE 'INVALID ACCESS' TO MSGO
					   PERFORM 100-NEW-MAP
				       END-IF
				   WHEN OTHER
                                       MOVE '_' TO UCI(WS-COUNTER2)
                                       MOVE 'INVALID ACCESS' TO MSGO
				       PERFORM 100-NEW-MAP
			       END-EVALUATE
			   ELSE
                               MOVE '_' TO UCI(WS-COUNTER2)
                               MOVE 'STATUS MUST BE APPROVED OR ONGOING'
				   TO MSGO
			       PERFORM 100-NEW-MAP
			   END-IF
                       WHEN 'C'
                           IF STI(WS-COUNTER2) = 'COMPLETED'
			       PERFORM 600-VALIDATE-USER
      *$PP-DEBUG							REALCICS
      P 		       EXEC CICS
      P                            READ FILE('STF00001')
      P 			   INTO (WS-TIX-REC)
      P 			   RIDFLD (TNI(WS-COUNTER2))
      P 			   RESP(WS-RESPONSE-CODE)
      P 			   EQUAL
      P 		       END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 423 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '8' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (02)                             REALCICS
           MOVE 'STF00001' TO DFH-DATA8 (02)                            REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF DFH-DATA8 (02)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA8 (02) GIVING DFH-SIZE (02)		REALCICS
	   MOVE 001 TO DFH-FLAG (04)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (04)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (04)                              REALCICS
	   SET DFH-ADDR (04) TO ADDRESS OF WS-TIX-REC			REALCICS
	   ADD 0 LENGTH OF WS-TIX-REC GIVING DFH-SIZE (04)		REALCICS
	   MOVE 001 TO DFH-FLAG (06)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (06)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (06)                              REALCICS
	   SET DFH-ADDR (06) TO ADDRESS OF TNI ( WS-COUNTER2 )		REALCICS
	   ADD 0 LENGTH OF TNI ( WS-COUNTER2 ) GIVING DFH-SIZE (06)	REALCICS
	   MOVE 001 TO DFH-FLAG (01)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (01)                               REALCICS
           MOVE 'H ' TO DFH-DATA-CLASS (01)                             REALCICS
	   SET DFH-ADDR (01) TO ADDRESS OF WS-RESPONSE-CODE		REALCICS
	   ADD 0 LENGTH OF WS-RESPONSE-CODE GIVING DFH-SIZE (01)	REALCICS
	   MOVE 002 TO DFH-FLAG (11)					REALCICS
           MOVE '0' TO DFH-DATA-TYPE (11)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (11)                              REALCICS
           MOVE X'0602' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 011 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
	   ADD 0 DFH-RESP GIVING WS-RESPONSE-CODE			REALCICS
      *$PP-LIST 							REALCICS
			       IF WS-USERID = TIX-REQUESTOR
      *$PP-DEBUG							REALCICS
      P 			   EXEC CICS XCTL
      P                                PROGRAM('SM004P')
      P 			   END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 431 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '2' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (02)                             REALCICS
           MOVE 'SM004P' TO DFH-DATA8 (02)                              REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF DFH-DATA8 (02)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA8 (02) GIVING DFH-SIZE (02)		REALCICS
           MOVE X'0E04' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 002 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS
			       ELSE
                                   MOVE '_' TO UCI(WS-COUNTER2)
                                   MOVE 'INVALID ACCESS' TO MSGO
				   PERFORM 100-NEW-MAP
			       END-IF
			   ELSE
                               MOVE '_' TO UCI(WS-COUNTER2)
                               MOVE 'STATUS MUST BE COMPLETED' TO
				   MSGO
			       PERFORM 100-NEW-MAP
			   END-IF
                       WHEN 'A'
                               IF STI(WS-COUNTER2) = 'CREATED'
			       PERFORM 600-VALIDATE-USER
			       EVALUATE TRUE
                                   WHEN APPROVER = 'Y'
      *$PP-DEBUG							REALCICS
      P 			       EXEC CICS
      P                                    READ FILE('STF00001')
      P 				   INTO (WS-TIX-REC)
      P 				   RIDFLD (TNI(WS-COUNTER2))
      P 				   RESP(WS-RESPONSE-CODE)
      P 				   EQUAL
      P 			       END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 450 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '8' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (02)                             REALCICS
           MOVE 'STF00001' TO DFH-DATA8 (02)                            REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF DFH-DATA8 (02)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA8 (02) GIVING DFH-SIZE (02)		REALCICS
	   MOVE 001 TO DFH-FLAG (04)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (04)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (04)                              REALCICS
	   SET DFH-ADDR (04) TO ADDRESS OF WS-TIX-REC			REALCICS
	   ADD 0 LENGTH OF WS-TIX-REC GIVING DFH-SIZE (04)		REALCICS
	   MOVE 001 TO DFH-FLAG (06)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (06)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (06)                              REALCICS
	   SET DFH-ADDR (06) TO ADDRESS OF TNI ( WS-COUNTER2 )		REALCICS
	   ADD 0 LENGTH OF TNI ( WS-COUNTER2 ) GIVING DFH-SIZE (06)	REALCICS
	   MOVE 001 TO DFH-FLAG (01)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (01)                               REALCICS
           MOVE 'H ' TO DFH-DATA-CLASS (01)                             REALCICS
	   SET DFH-ADDR (01) TO ADDRESS OF WS-RESPONSE-CODE		REALCICS
	   ADD 0 LENGTH OF WS-RESPONSE-CODE GIVING DFH-SIZE (01)	REALCICS
	   MOVE 002 TO DFH-FLAG (11)					REALCICS
           MOVE '0' TO DFH-DATA-TYPE (11)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (11)                              REALCICS
           MOVE X'0602' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 011 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
	   ADD 0 DFH-RESP GIVING WS-RESPONSE-CODE			REALCICS
      *$PP-LIST 							REALCICS
				       IF WS-USERID = TIX-REQUESTOR
      *$PP-DEBUG							REALCICS
      P 				   EXEC CICS XCTL
      P                                        PROGRAM('SM005P')
      P 				   END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 458 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '2' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (02)                             REALCICS
           MOVE 'SM005P' TO DFH-DATA8 (02)                              REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF DFH-DATA8 (02)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA8 (02) GIVING DFH-SIZE (02)		REALCICS
           MOVE X'0E04' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 002 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS
				       ELSE
                                           MOVE '_' TO UCI(WS-COUNTER2)
                                           MOVE 'INVALID ACCESS' TO MSGO
					   PERFORM 100-NEW-MAP
				       END-IF
				   WHEN OTHER
                                       MOVE '_' TO UCI(WS-COUNTER2)
                                       MOVE 'INVALID ACCESS' TO MSGO
				       PERFORM 100-NEW-MAP
			       END-EVALUATE
			   ELSE
                               MOVE '_' TO UCI(WS-COUNTER2)
                               MOVE 'STATUS MUST BE CREATED' TO
				   MSGO
			       PERFORM 100-NEW-MAP
			   END-IF
                       WHEN 'X'
      *$PP-DEBUG							REALCICS
      P 		   EXEC CICS
      P                        READ FILE('STF00001')
      P 		       INTO (WS-TIX-REC)
      P 		       RIDFLD (TNI(WS-COUNTER2))
      P 		       RESP(WS-RESPONSE-CODE)
      P 		       EQUAL
      P 		   END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 478 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '8' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (02)                             REALCICS
           MOVE 'STF00001' TO DFH-DATA8 (02)                            REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF DFH-DATA8 (02)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA8 (02) GIVING DFH-SIZE (02)		REALCICS
	   MOVE 001 TO DFH-FLAG (04)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (04)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (04)                              REALCICS
	   SET DFH-ADDR (04) TO ADDRESS OF WS-TIX-REC			REALCICS
	   ADD 0 LENGTH OF WS-TIX-REC GIVING DFH-SIZE (04)		REALCICS
	   MOVE 001 TO DFH-FLAG (06)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (06)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (06)                              REALCICS
	   SET DFH-ADDR (06) TO ADDRESS OF TNI ( WS-COUNTER2 )		REALCICS
	   ADD 0 LENGTH OF TNI ( WS-COUNTER2 ) GIVING DFH-SIZE (06)	REALCICS
	   MOVE 001 TO DFH-FLAG (01)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (01)                               REALCICS
           MOVE 'H ' TO DFH-DATA-CLASS (01)                             REALCICS
	   SET DFH-ADDR (01) TO ADDRESS OF WS-RESPONSE-CODE		REALCICS
	   ADD 0 LENGTH OF WS-RESPONSE-CODE GIVING DFH-SIZE (01)	REALCICS
	   MOVE 002 TO DFH-FLAG (11)					REALCICS
           MOVE '0' TO DFH-DATA-TYPE (11)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (11)                              REALCICS
           MOVE X'0602' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 011 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
	   ADD 0 DFH-RESP GIVING WS-RESPONSE-CODE			REALCICS
      *$PP-LIST 							REALCICS
			   IF WS-USERID = TIX-REQUESTOR
      *$PP-DEBUG							REALCICS
      P 		       EXEC CICS XCTL
      P                            PROGRAM('SM006P')
      P 		       END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 486 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '2' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (02)                             REALCICS
           MOVE 'SM006P' TO DFH-DATA8 (02)                              REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF DFH-DATA8 (02)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA8 (02) GIVING DFH-SIZE (02)		REALCICS
           MOVE X'0E04' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 002 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS
			   ELSE
                               MOVE '_' TO UCI(WS-COUNTER2)
                               MOVE 'INVALID ACCESS' TO MSGO
			       PERFORM 100-NEW-MAP
			   END-IF
		       WHEN SPACE
                           MOVE '_' TO UCI(WS-COUNTER2)
                           MOVE 'OPTION IS REQUIRED' TO MSGO
			   PERFORM 100-NEW-MAP
		       WHEN OTHER
                           MOVE '_' TO UCI(WS-COUNTER2)
                           MOVE 'ENTER U, C, A, OR X AND PRESS ENTER' TO
				 MSGO
			   PERFORM 100-NEW-MAP
		   END-EVALUATE
	       END-IF
	   END-IF.

       260-WHENF5 SECTION.

       270-WHENF12 SECTION.
	   PERFORM UNTIL WS-QITEM-PAGE < WS-QITEM-START OR
			 WS-QITEM-PAGE = WS-QITEM-START
		       SUBTRACT 11 FROM WS-QITEM-PAGE
	   END-PERFORM
           MOVE 'THIS IS THE FIRST PAGE' TO MSGO
	   MOVE 1 TO WS-PAGE
	   MOVE WS-QITEM-START TO WS-QITEM-PAGE
	    MOVE WS-PAGE TO PAGEO
	    PERFORM 500-MOVE-Q-TO-SCREEN
	    PERFORM 100-NEW-MAP.

       500-MOVE-Q-TO-SCREEN SECTION.

	    MOVE WS-QITEM-PAGE TO WS-QITEM
      *$PP-DEBUG							REALCICS
      P     EXEC CICS READQ TS
      P 	      QUEUE(WS-QNAME)
      P 	      INTO (WS-TIX-REC)
      P 	      ITEM (WS-QITEM)
      P      END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 524 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '2' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (02)                             REALCICS
	   MOVE WS-QNAME TO DFH-DATA8 (02)				REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF DFH-DATA8 (02)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA8 (02) GIVING DFH-SIZE (02)		REALCICS
	   MOVE 001 TO DFH-FLAG (03)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (03)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (03)                              REALCICS
	   SET DFH-ADDR (03) TO ADDRESS OF WS-TIX-REC			REALCICS
	   ADD 0 LENGTH OF WS-TIX-REC GIVING DFH-SIZE (03)		REALCICS
	   MOVE 002 TO DFH-FLAG (06)					REALCICS
           MOVE '8' TO DFH-DATA-TYPE (06)                               REALCICS
           MOVE 'H ' TO DFH-DATA-CLASS (06)                             REALCICS
	   ADD 0 WS-QITEM GIVING DFH-DATAH (06) 			REALCICS
	   SET DFH-ADDR (06) TO ADDRESS OF DFH-DATAH (06)		REALCICS
	   ADD 0 LENGTH OF DFH-DATAH (06) GIVING DFH-SIZE (06)		REALCICS
           MOVE X'0A04' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 006 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS

	    MOVE 1 TO WS-INDX

	    PERFORM UNTIL WS-INDX > 11
      *$PP-START-INSERT CICS NA 					REALCICS
      P 	IF EIBRESP = DFHRESP(NORMAL) AND
      *$PP-END-INSERT CICS NA						REALCICS
		IF EIBRESP =	     000     AND			REALCICS
		   WS-QITEM <= WS-QITEM-END
		   MOVE TIX-ID TO TNI(WS-INDX)
		   MOVE TIX-TITLE TO TTI(WS-INDX)
		   MOVE TIX-STATUS TO STI(WS-INDX)
		   MOVE LAST-UPDATE TO UDI(WS-INDX)
		   MOVE UPDBY2 TO UBI(WS-INDX)
		   ADD 1 TO WS-INDX
		   ADD 1 TO WS-QITEM
      *$PP-DEBUG							REALCICS
      P 	   EXEC CICS READQ TS
      P 		QUEUE(WS-QNAME)
      P 		INTO (WS-TIX-REC)
      P 		ITEM (WS-QITEM)
      P 	  END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 542 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '2' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (02)                             REALCICS
	   MOVE WS-QNAME TO DFH-DATA8 (02)				REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF DFH-DATA8 (02)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA8 (02) GIVING DFH-SIZE (02)		REALCICS
	   MOVE 001 TO DFH-FLAG (03)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (03)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (03)                              REALCICS
	   SET DFH-ADDR (03) TO ADDRESS OF WS-TIX-REC			REALCICS
	   ADD 0 LENGTH OF WS-TIX-REC GIVING DFH-SIZE (03)		REALCICS
	   MOVE 002 TO DFH-FLAG (06)					REALCICS
           MOVE '8' TO DFH-DATA-TYPE (06)                               REALCICS
           MOVE 'H ' TO DFH-DATA-CLASS (06)                             REALCICS
	   ADD 0 WS-QITEM GIVING DFH-DATAH (06) 			REALCICS
	   SET DFH-ADDR (06) TO ADDRESS OF DFH-DATAH (06)		REALCICS
	   ADD 0 LENGTH OF DFH-DATAH (06) GIVING DFH-SIZE (06)		REALCICS
           MOVE X'0A04' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 006 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS
	       ELSE
		  MOVE SPACES TO TNI(WS-INDX)
		  MOVE SPACES TO TTI(WS-INDX)
		  MOVE SPACES TO STI(WS-INDX)
		  MOVE SPACES TO UDI(WS-INDX)
		  MOVE SPACES TO UBI(WS-INDX)
                  MOVE 'THIS IS THE LAST PAGE' TO MSGO
                  MOVE '1' TO WS-LASTPAGE
		  ADD 1 TO WS-INDX
	       END-IF
	    END-PERFORM.

       500-EXIT.
	   EXIT.

       600-VALIDATE-USER.
      *$PP-DEBUG							REALCICS
      P    EXEC CICS ASSIGN
      P        USERID(WS-USERID)
      P    END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 563 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 080 TO DFH-FLAG (02)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (02)                             REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF WS-USERID			REALCICS
	   ADD 0 LENGTH OF WS-USERID GIVING DFH-SIZE (02)		REALCICS
           MOVE X'0208' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 002 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS
      *$PP-DEBUG							REALCICS
      P    EXEC CICS
      P        READ FILE('UAF00001')
      P        INTO (WS-USER-REC)
      P        RIDFLD (WS-USERID)
      P        RESP(WS-RESPONSE-CODE)
      P        GTEQ
      P    END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 566 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '8' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (02)                             REALCICS
           MOVE 'UAF00001' TO DFH-DATA8 (02)                            REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF DFH-DATA8 (02)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA8 (02) GIVING DFH-SIZE (02)		REALCICS
	   MOVE 001 TO DFH-FLAG (04)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (04)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (04)                              REALCICS
	   SET DFH-ADDR (04) TO ADDRESS OF WS-USER-REC			REALCICS
	   ADD 0 LENGTH OF WS-USER-REC GIVING DFH-SIZE (04)		REALCICS
	   MOVE 001 TO DFH-FLAG (06)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (06)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (06)                              REALCICS
	   SET DFH-ADDR (06) TO ADDRESS OF WS-USERID			REALCICS
	   ADD 0 LENGTH OF WS-USERID GIVING DFH-SIZE (06)		REALCICS
	   MOVE 001 TO DFH-FLAG (01)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (01)                               REALCICS
           MOVE 'H ' TO DFH-DATA-CLASS (01)                             REALCICS
	   SET DFH-ADDR (01) TO ADDRESS OF WS-RESPONSE-CODE		REALCICS
	   ADD 0 LENGTH OF WS-RESPONSE-CODE GIVING DFH-SIZE (01)	REALCICS
	   MOVE 001 TO DFH-FLAG (11)					REALCICS
           MOVE '0' TO DFH-DATA-TYPE (11)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (11)                              REALCICS
           MOVE X'0602' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 011 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
	   ADD 0 DFH-RESP GIVING WS-RESPONSE-CODE			REALCICS
      *$PP-LIST 							REALCICS
	   IF NOT WS-RESPONSE-CODE = +00
               MOVE 'INVALID ACCESS' TO MSGO
	       PERFORM 100-NEW-MAP
	   END-IF.

       999-MOVE-FILE-TO-Q SECTION.

	    MOVE LOW-VALUES TO TIX-ID.
      *$PP-DEBUG							REALCICS
      P     EXEC CICS
      P        STARTBR FILE('stf00001')
      P        RIDFLD (TIX-ID)
      P        GTEQ
      P     END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 581 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '8' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (02)                             REALCICS
           MOVE 'STF00001' TO DFH-DATA8 (02)                            REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF DFH-DATA8 (02)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA8 (02) GIVING DFH-SIZE (02)		REALCICS
	   MOVE 001 TO DFH-FLAG (03)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (03)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (03)                              REALCICS
	   SET DFH-ADDR (03) TO ADDRESS OF TIX-ID			REALCICS
	   ADD 0 LENGTH OF TIX-ID GIVING DFH-SIZE (03)			REALCICS
	   MOVE 001 TO DFH-FLAG (08)					REALCICS
           MOVE '0' TO DFH-DATA-TYPE (08)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (08)                              REALCICS
           MOVE X'060C' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 008 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS

      *$PP-DEBUG							REALCICS
      P     EXEC CICS
      P         READNEXT FILE('stf00001')
      P 	INTO (WS-TIX-REC)
      P 	RIDFLD (TIX-ID)
      P     END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 587 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '8' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (02)                             REALCICS
           MOVE 'STF00001' TO DFH-DATA8 (02)                            REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF DFH-DATA8 (02)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA8 (02) GIVING DFH-SIZE (02)		REALCICS
	   MOVE 001 TO DFH-FLAG (03)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (03)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (03)                              REALCICS
	   SET DFH-ADDR (03) TO ADDRESS OF WS-TIX-REC			REALCICS
	   ADD 0 LENGTH OF WS-TIX-REC GIVING DFH-SIZE (03)		REALCICS
	   MOVE 001 TO DFH-FLAG (05)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (05)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (05)                              REALCICS
	   SET DFH-ADDR (05) TO ADDRESS OF TIX-ID			REALCICS
	   ADD 0 LENGTH OF TIX-ID GIVING DFH-SIZE (05)			REALCICS
           MOVE X'060E' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 005 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS

      *$PP-DEBUG							REALCICS
      P    EXEC CICS WRITEQ TS
      P 	     QUEUE(WS-QNAME)
      P 	     FROM (WS-TIX-REC)
      P 	     ITEM (WS-QITEM)
      P    END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 593 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '2' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (02)                             REALCICS
	   MOVE WS-QNAME TO DFH-DATA8 (02)				REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF DFH-DATA8 (02)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA8 (02) GIVING DFH-SIZE (02)		REALCICS
	   MOVE 001 TO DFH-FLAG (03)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (03)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (03)                              REALCICS
	   SET DFH-ADDR (03) TO ADDRESS OF WS-TIX-REC			REALCICS
	   ADD 0 LENGTH OF WS-TIX-REC GIVING DFH-SIZE (03)		REALCICS
	   MOVE 002 TO DFH-FLAG (05)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (05)                               REALCICS
           MOVE 'H ' TO DFH-DATA-CLASS (05)                             REALCICS
	   SET DFH-ADDR (05) TO ADDRESS OF WS-QITEM			REALCICS
	   ADD 0 LENGTH OF WS-QITEM GIVING DFH-SIZE (05)		REALCICS
           MOVE X'0A02' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 005 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS
	   MOVE WS-QITEM TO WS-QITEM-START
      *$PP-START-INSERT CICS NA 					REALCICS
      P    PERFORM UNTIL EIBRESP NOT = DFHRESP(NORMAL)
      *$PP-END-INSERT CICS NA						REALCICS
	   PERFORM UNTIL EIBRESP NOT =	       000			REALCICS
	       MOVE WS-QITEM TO WS-QITEM-END
      *$PP-DEBUG							REALCICS
      P        EXEC CICS
      P             READNEXT FILE('stf00001')
      P 	    INTO (WS-TIX-REC)
      P 	    RIDFLD (TIX-ID)
      P        END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 601 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '8' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (02)                             REALCICS
           MOVE 'STF00001' TO DFH-DATA8 (02)                            REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF DFH-DATA8 (02)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA8 (02) GIVING DFH-SIZE (02)		REALCICS
	   MOVE 001 TO DFH-FLAG (03)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (03)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (03)                              REALCICS
	   SET DFH-ADDR (03) TO ADDRESS OF WS-TIX-REC			REALCICS
	   ADD 0 LENGTH OF WS-TIX-REC GIVING DFH-SIZE (03)		REALCICS
	   MOVE 001 TO DFH-FLAG (05)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (05)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (05)                              REALCICS
	   SET DFH-ADDR (05) TO ADDRESS OF TIX-ID			REALCICS
	   ADD 0 LENGTH OF TIX-ID GIVING DFH-SIZE (05)			REALCICS
           MOVE X'060E' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 005 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS
      *$PP-START-INSERT CICS NA 					REALCICS
      P 	   IF EIBRESP = DFHRESP(NORMAL)
      *$PP-END-INSERT CICS NA						REALCICS
		   IF EIBRESP = 	000				REALCICS
      *$PP-DEBUG							REALCICS
      P 	       EXEC CICS WRITEQ TS
      P 		   QUEUE(WS-QNAME)
      P 		   FROM (WS-TIX-REC)
      P 		   ITEM (WS-QITEM)
      P 	       END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 607 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '2' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (02)                             REALCICS
	   MOVE WS-QNAME TO DFH-DATA8 (02)				REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF DFH-DATA8 (02)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA8 (02) GIVING DFH-SIZE (02)		REALCICS
	   MOVE 001 TO DFH-FLAG (03)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (03)                               REALCICS
           MOVE ' ' TO DFH-DATA-CLASS (03)                              REALCICS
	   SET DFH-ADDR (03) TO ADDRESS OF WS-TIX-REC			REALCICS
	   ADD 0 LENGTH OF WS-TIX-REC GIVING DFH-SIZE (03)		REALCICS
	   MOVE 002 TO DFH-FLAG (05)					REALCICS
           MOVE '1' TO DFH-DATA-TYPE (05)                               REALCICS
           MOVE 'H ' TO DFH-DATA-CLASS (05)                             REALCICS
	   SET DFH-ADDR (05) TO ADDRESS OF WS-QITEM			REALCICS
	   ADD 0 LENGTH OF WS-QITEM GIVING DFH-SIZE (05)		REALCICS
           MOVE X'0A02' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 005 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS
	       END-IF
	   END-PERFORM
      *$PP-DEBUG							REALCICS
      P    EXEC CICS
      P         ENDBR FILE('stf00001')
      P    END-EXEC
      *$PP-NOLIST							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 614 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE 001 TO DFH-FLAG (02)					REALCICS
           MOVE '8' TO DFH-DATA-TYPE (02)                               REALCICS
           MOVE '8 ' TO DFH-DATA-CLASS (02)                             REALCICS
           MOVE 'STF00001' TO DFH-DATA8 (02)                            REALCICS
	   SET DFH-ADDR (02) TO ADDRESS OF DFH-DATA8 (02)		REALCICS
	   ADD 0 LENGTH OF DFH-DATA8 (02) GIVING DFH-SIZE (02)		REALCICS
           MOVE X'0612' TO DFH-COMMAND EIBFN                            REALCICS
	   MOVE 002 TO DFH-VARS-COUNT					REALCICS
           CALL 'CICS_Exec_Std' USING CICSICB GIVING DFH-RETURN-STATUS  REALCICS
           IF DFH-RETURN-STATUS = -1 CALL 'CICS_Link_Abend' USING       REALCICS
	       CICSICB END-IF						REALCICS
	   IF DFH-RETURN-STATUS < 0 STOP RUN				REALCICS
	   ELSE IF DFH-RETURN-STATUS > 0 PERFORM DFH-GOTO-HANDLE	REALCICS
	       END-IF END-IF						REALCICS
      *$PP-LIST 							REALCICS
	   MOVE WS-QITEM-START TO WS-QITEM-PAGE.

       999-EXIT.
	   EXIT.



      *$PP-NOLIST CICS HI						REALCICS
       DFH-END SECTION. 						REALCICS
       DFH-CALL-END.							REALCICS
           MOVE 'SM001P' TO DFH-SOURCE-NAME                             REALCICS
	   MOVE 624 TO DFH-SOURCE-LINE-NUM				REALCICS
	   MOVE LOW-VALUE TO DFH-COMMAND				REALCICS
           CALL 'CICS_Module_End' USING CICSICB GIVING                  REALCICS
	       DFH-RETURN-STATUS					REALCICS
	   GOBACK.							REALCICS
       DFH-GOTO-HANDLE. 						REALCICS
      *$PP-LIST CICS HI 						REALCICS