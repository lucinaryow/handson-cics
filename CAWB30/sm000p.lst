     5	     *	CBL XOPTS(COBOL2)
    20	      IDENTIFICATION DIVISION.
    21	      PROGRAM-ID. SM000P.
    22
    23	      ENVIRONMENT DIVISION.
    24	      CONFIGURATION SECTION.
    25	      SOURCE-COMPUTER.	  IBM-PC.
    26	      OBJECT-COMPUTER.	  IBM-PC.
    27	      DATA DIVISION.
    28	      WORKING-STORAGE SECTION.
    74	      01  WS-TIME			  PIC 9(15) COMP-3.
    75	      01  WS-DATE				PIC 9(7).
    76	      01  WS-DATE-X REDEFINES WS-DATE		PIC X(7).
    77        01  WS-VALID-TIX-FLAG                     PIC X VALUE 'Y'.
    78	      01  WS-LENGTH				PIC S9(4) COMP.
    79	      01  WS-INDEX				PIC 9 VALUE 1.
    80	      01  WS-CHOICE				PIC X(21).
    81	      01  WS-CHOICE-PH.
    82		  05  WS-CHC1				PIC X(21).
    83		  05  WS-CHC2				PIC X(21).
    84		  05  WS-CHC3				PIC X(21).
    85		  05  WS-CHC4				PIC X(21).
    86		  05  WS-CHC5				PIC X(21).
    87		  05  WS-CHC6				PIC X(21).
    88		  05  WS-CHC7				PIC X(21).
    89	      01  WS-USERID				PIC X(7).
    90	      01  WS-TIXID				PIC X(6).
    91	      01  WS-RESPONSE-CODE    PIC S9(8) COMP.
    92	      01  WS-LOGID.
    93		  05  LOGID2				PIC X(6).
    94		  05  FILLER				PIC X.
    95	      01  WS-END				PIC X(15) VALUE
    96            'END PROCESSING'.
    97	      01  WS-INVKEY				PIC X(21) VALUE
    98            'INVALID PFKEY PRESSED'.
    99	      01  WS-INVALID			  PIC X(14) VALUE
   100            'INVALID ACCESS'.
   101	      01  WS-INVALID-TICKET			  PIC X(28) VALUE
   102            'TICKET NUMBER DOES NOT EXIST'.
   103	      01  WS-DUP-TICKET 			  PIC X(28) VALUE
   104            'DUPLICATE TICKET NUMBER'.
   105	      01  WS-INVALID-USER			  PIC X(24) VALUE
   106            'INVALID ACCESS TO TICKET'.
   107	      01  WS-COMMAREA.
   108		  05  WS-CA-PRGNAME	      PIC X(06).
   109		  05  FILLER		      PIC X(19).
   110		  05  WS-DFHSTATE	      PIC X(15).
   111		  05  WS-TRANS		      PIC X(04).
   112		  05  WS-LUSER		      PIC 9(03).
   113		  05  WS-FUSER		      PIC 9(03).
   114		  05  WS-PAGE		      PIC 9(02).
   115		  05  WS-PAGE-END	      PIC 9(01).
   116		  05  WS-QITEM		      PIC S9(4) COMP.
   117		  05  WS-QITEM-START	      PIC S9(4) COMP.
   118		  05  WS-QITEM-END	      PIC S9(4) COMP.
   119		  05  WS-QITEM-PAGE	      PIC S9(4) COMP.
   120		  05  WS-USERID1			 PIC X(7).
   121		  05  WS-USER-REC.
   122		      10  USERID.
   123			  15  USERID1			    PIC X(7).   124			  15  FILLER			    PIC X.
   125		      10  REQUESTOR			    PIC X.
   126		      10  ADMINISTRATOR 		    PIC X.
   127		      10  APPROVER			    PIC X.
   128		      10  SERVICE-PROVIDER		    PIC X.
   129		      10  UPDATED-BY1.
   130			  15  UPDBY1			    PIC X(7).
   131			  15  FILLER			    PIC X.
   132		  05  WS-TIX-REC.
   133		      10  TIX-ID			    PIC X(06).
   134		      10  TIX-REQUESTOR 		    PIC X(08).
   135		      10  TIX-STATUS			    PIC X(10).
   136		      10  TIX-TITLE			    PIC X(25).
   137		      10  TIX-DESC			    PIC X(100).
   138		      10  TIX-DESC-RED REDEFINES TIX-DESC.
   139			  15  TIX-DESC1 		    PIC X(50).
   140			  15  TIX-DESC2 		    PIC X(50).
   141		      10  LAST-UPDATE			    PIC X(20).
   142		      10  LAST-UPDATE-RED REDEFINES LAST-UPDATE.
   143			  15  LAST-UPDATE-DATE		    PIC X(11).
   144			  15  LAST-UPDATE-TIME		    PIC X(09).
   145		      10  UPDATED-BY2.
   146			  15  UPDBY2			    PIC X(7).
   147			  15  FILLER			    PIC X.
   148		      10  LAST-UPDATE-REM		    PIC X(50).
   149		      10  LAST-UPDATE-REMW REDEFINES LAST-UPDATE-REM.
   150			  15  LAST-UPDATE-REM1		    PIC X(25).
   151			  15  LAST-UPDATE-REM2		    PIC X(25).
   152		  05  WS-PROG-STATE			 PIC 9(1).
   153            05  WS-INIT                            PIC X VALUE 'Y'.
   154		  05  WS-TICKET-NUM.
   155		      10  WS-TICKET-NUM1		 PIC X(6).
   156		      10  FILLER			 PIC X.
   157
   158	     *
   159		  COPY SM000S.
   161	     * SYMBOLIC MAP of sm000s Created by CACXBMS Version 6.0.27
   162	      01  SW00MI.
   163		  02  FILLER				     PIC X(12).
   164		  02  OPTCHC1L				     PIC S9(4) COMP.
   165		  02  OPTCHC1F				     PIC X.
   166		  02  FILLER REDEFINES OPTCHC1F.
   167		      03  OPTCHC1A			     PIC X.
   168		  02  OPTCHC1I				     PIC X(021).
   169		  02  OPTNO1L				     PIC S9(4) COMP.
   170		  02  OPTNO1F				     PIC X.
   171		  02  FILLER REDEFINES OPTNO1F.
   172		      03  OPTNO1A			     PIC X.
   173		  02  OPTNO1I				     PIC X(001).
   174		  02  OPTCHC2L				     PIC S9(4) COMP.
   175		  02  OPTCHC2F				     PIC X.
   176		  02  FILLER REDEFINES OPTCHC2F.
   177		      03  OPTCHC2A			     PIC X.
   178		  02  OPTCHC2I				     PIC X(021).
   179		  02  OPTNO2L				     PIC S9(4) COMP.
   180		  02  OPTNO2F				     PIC X.
   181		  02  FILLER REDEFINES OPTNO2F.
   182		      03  OPTNO2A			     PIC X.
   183		  02  OPTNO2I				     PIC X(001).
   184		  02  OPTCHC3L				     PIC S9(4) COMP.   185		  02  OPTCHC3F				     PIC X.
   186		  02  FILLER REDEFINES OPTCHC3F.
   187		      03  OPTCHC3A			     PIC X.
   188		  02  OPTCHC3I				     PIC X(021).
   189		  02  OPTNO3L				     PIC S9(4) COMP.
   190		  02  OPTNO3F				     PIC X.
   191		  02  FILLER REDEFINES OPTNO3F.
   192		      03  OPTNO3A			     PIC X.
   193		  02  OPTNO3I				     PIC X(001).
   194		  02  OPTCHC4L				     PIC S9(4) COMP.
   195		  02  OPTCHC4F				     PIC X.
   196		  02  FILLER REDEFINES OPTCHC4F.
   197		      03  OPTCHC4A			     PIC X.
   198		  02  OPTCHC4I				     PIC X(021).
   199		  02  OPTNO4L				     PIC S9(4) COMP.
   200		  02  OPTNO4F				     PIC X.
   201		  02  FILLER REDEFINES OPTNO4F.
   202		      03  OPTNO4A			     PIC X.
   203		  02  OPTNO4I				     PIC X(001).
   204		  02  OPTCHC5L				     PIC S9(4) COMP.
   205		  02  OPTCHC5F				     PIC X.
   206		  02  FILLER REDEFINES OPTCHC5F.
   207		      03  OPTCHC5A			     PIC X.
   208		  02  OPTCHC5I				     PIC X(021).
   209		  02  OPTNO5L				     PIC S9(4) COMP.
   210		  02  OPTNO5F				     PIC X.
   211		  02  FILLER REDEFINES OPTNO5F.
   212		      03  OPTNO5A			     PIC X.
   213		  02  OPTNO5I				     PIC X(001).
   214		  02  OPTCHC6L				     PIC S9(4) COMP.
   215		  02  OPTCHC6F				     PIC X.
   216		  02  FILLER REDEFINES OPTCHC6F.
   217		      03  OPTCHC6A			     PIC X.
   218		  02  OPTCHC6I				     PIC X(021).
   219		  02  OPTNO6L				     PIC S9(4) COMP.
   220		  02  OPTNO6F				     PIC X.
   221		  02  FILLER REDEFINES OPTNO6F.
   222		      03  OPTNO6A			     PIC X.
   223		  02  OPTNO6I				     PIC X(001).
   224		  02  OPTCHC7L				     PIC S9(4) COMP.
   225		  02  OPTCHC7F				     PIC X.
   226		  02  FILLER REDEFINES OPTCHC7F.
   227		      03  OPTCHC7A			     PIC X.
   228		  02  OPTCHC7I				     PIC X(021).
   229		  02  OPTNO7L				     PIC S9(4) COMP.
   230		  02  OPTNO7F				     PIC X.
   231		  02  FILLER REDEFINES OPTNO7F.
   232		      03  OPTNO7A			     PIC X.
   233		  02  OPTNO7I				     PIC X(001).
   234		  02  OPTIONL				     PIC S9(4) COMP.
   235		  02  OPTIONF				     PIC X.
   236		  02  FILLER REDEFINES OPTIONF.
   237		      03  OPTIONA			     PIC X.
   238		  02  OPTIONI				     PIC X(001).
   239		  02  TIXNOL				     PIC S9(4) COMP.
   240		  02  TIXNOF				     PIC X.
   241		  02  FILLER REDEFINES TIXNOF.
   242		      03  TIXNOA			     PIC X.
   243		  02  TIXNOI				     PIC X(006).
   244		  02  ERRMSGL				     PIC S9(4) COMP.   245		  02  ERRMSGF				     PIC X.
   246		  02  FILLER REDEFINES ERRMSGF.
   247		      03  ERRMSGA			     PIC X.
   248		  02  ERRMSGI				     PIC X(071).
   249		  02  DATEL				     PIC S9(4) COMP.
   250		  02  DATEF				     PIC X.
   251		  02  FILLER REDEFINES DATEF.
   252		      03  DATEA 			     PIC X.
   253		  02  DATEI				     PIC X(010).
   254		  02  TIMEL				     PIC S9(4) COMP.
   255		  02  TIMEF				     PIC X.
   256		  02  FILLER REDEFINES TIMEF.
   257		      03  TIMEA 			     PIC X.
   258		  02  TIMEI				     PIC X(008).
   259	      01  SW00MO REDEFINES SW00MI.
   260		  02  FILLER				     PIC X(12).
   261		  02  FILLER				     PIC XX.
   262		  02  FILLER				     PIC X.
   263		  02  OPTCHC1O				     PIC X(021).
   264		  02  FILLER				     PIC XX.
   265		  02  FILLER				     PIC X.
   266		  02  OPTNO1O				     PIC X(001).
   267		  02  FILLER				     PIC XX.
   268		  02  FILLER				     PIC X.
   269		  02  OPTCHC2O				     PIC X(021).
   270		  02  FILLER				     PIC XX.
   271		  02  FILLER				     PIC X.
   272		  02  OPTNO2O				     PIC X(001).
   273		  02  FILLER				     PIC XX.
   274		  02  FILLER				     PIC X.
   275		  02  OPTCHC3O				     PIC X(021).
   276		  02  FILLER				     PIC XX.
   277		  02  FILLER				     PIC X.
   278		  02  OPTNO3O				     PIC X(001).
   279		  02  FILLER				     PIC XX.
   280		  02  FILLER				     PIC X.
   281		  02  OPTCHC4O				     PIC X(021).
   282		  02  FILLER				     PIC XX.
   283		  02  FILLER				     PIC X.
   284		  02  OPTNO4O				     PIC X(001).
   285		  02  FILLER				     PIC XX.
   286		  02  FILLER				     PIC X.
   287		  02  OPTCHC5O				     PIC X(021).
   288		  02  FILLER				     PIC XX.
   289		  02  FILLER				     PIC X.
   290		  02  OPTNO5O				     PIC X(001).
   291		  02  FILLER				     PIC XX.
   292		  02  FILLER				     PIC X.
   293		  02  OPTCHC6O				     PIC X(021).
   294		  02  FILLER				     PIC XX.
   295		  02  FILLER				     PIC X.
   296		  02  OPTNO6O				     PIC X(001).
   297		  02  FILLER				     PIC XX.
   298		  02  FILLER				     PIC X.
   299		  02  OPTCHC7O				     PIC X(021).
   300		  02  FILLER				     PIC XX.
   301		  02  FILLER				     PIC X.
   302		  02  OPTNO7O				     PIC X(001).
   303		  02  FILLER				     PIC XX.
   304		  02  FILLER				     PIC X.   305		  02  OPTIONO				     PIC X(001).
   306		  02  FILLER				     PIC XX.
   307		  02  FILLER				     PIC X.
   308		  02  TIXNOO				     PIC X(006).
   309		  02  FILLER				     PIC XX.
   310		  02  FILLER				     PIC X.
   311		  02  ERRMSGO				     PIC X(071).
   312		  02  FILLER				     PIC XX.
   313		  02  FILLER				     PIC X.
   314		  02  DATEO				     PIC X(010).
   315		  02  FILLER				     PIC XX.
   316		  02  FILLER				     PIC X.
   317		  02  TIMEO				     PIC X(008).
   319	     *
   320		  COPY DFHAID.
   322	      01  DFHAID.
   323	     *
   324	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   325	     *
   326	     * Revision Information
   327	     * ^{File:dfhaid.cob  }
   328	     * ^{Timestamp:Thu May 15 14:02:52 1997}
   329	     * ^{Revision:2.0}
   330	     *
   331	     *This is the AID constants copy file
   332	     *
   333            05  DFHENTER                  PIC X VALUE ''''.
   334	     *					value APOST
   335            05  DFHCLEAR                  PIC X VALUE '_'.
   336            05  DFHPA1                    PIC X VALUE '%'.
   337            05  DFHPA2                    PIC X VALUE '>'.
   338            05  DFHPA3                    PIC X VALUE ','.
   339            05  DFHPF1                    PIC X VALUE '1'.
   340            05  DFHPF2                    PIC X VALUE '2'.
   341            05  DFHPF3                    PIC X VALUE '3'.
   342            05  DFHPF4                    PIC X VALUE '4'.
   343            05  DFHPF5                    PIC X VALUE '5'.
   344            05  DFHPF6                    PIC X VALUE '6'.
   345            05  DFHPF7                    PIC X VALUE '7'.
   346            05  DFHPF8                    PIC X VALUE '8'.
   347            05  DFHPF9                    PIC X VALUE '9'.
   348            05  DFHPF10                   PIC X VALUE ':'.
   349            05  DFHPF11                   PIC X VALUE '#'.
   350            05  DFHPF12                   PIC X VALUE '@'.
   351            05  DFHPF13                   PIC X VALUE 'A'.
   352            05  DFHPF14                   PIC X VALUE 'B'.
   353            05  DFHPF15                   PIC X VALUE 'C'.
   354            05  DFHPF16                   PIC X VALUE 'D'.
   355            05  DFHPF17                   PIC X VALUE 'E'.
   356            05  DFHPF18                   PIC X VALUE 'F'.
   357            05  DFHPF19                   PIC X VALUE 'G'.
   358            05  DFHPF20                   PIC X VALUE 'H'.
   359            05  DFHPF21                   PIC X VALUE 'I'.
   360            05  DFHPF22                   PIC X VALUE '›'.
   361       *                                  EBCDIC Cent sign x'4A'
   362       *                                  ASCII  Cent sign x'9B'
   363            05  DFHPF23                   PIC X VALUE '.'.
   364            05  DFHPF24                   PIC X VALUE '<'.
   365            05  DFHOPID                   PIC X VALUE 'W'.
   366            05  DFHMSRE                   PIC X VALUE 'X'.   367            05  DFHTRIG                   PIC X VALUE '"'.
   368       *                                        value QUOTE  "
   369            05  DFHPEN                    PIC X VALUE '='.
   370            05  DFHCLRP                   PIC X VALUE 'Ý'.
   371       *                                  EBCDIC x'6A'
   372       *                                  ASCII  x'DD'
   373            05  DFHSTRF                   PIC X VALUE 'h'.
   374	     *	  DFHQUIT is a CA-Realia CICS Extension
   375	     *	  It is set by using <Ctrl>+C or <Ctrl>+<Break> Keys
   376            05  DFHQUIT                   PIC X VALUE '!'.
   377		  05  DFHNULL			PIC X VALUE LOW-VALUE.
   379	     *
   380	      COPY DFHBMSCA.
   382	      01  DFHBMSCA.
   383	     *
   384	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   385	     *
   386	     * Revision Information
   387	     * ^{File:dfhbmsca.cob}
   388	     * ^{Timestamp:Tue Oct 08 15:34:54 1996}
   389	     * ^{Revision:2.0}
   390	     *
   391	     *	Note:This FILE is provided with most values as quoted literals
   392	     *	     so that the file can be used for both ASCII and EBCDIC
   393	     *	     programs
   394	     *
   395	     *	     The only exceptions are some 3270 Data Stream Orders
   396	     *	     They use different Hexadecimal values for ASCII and
   397	     *	     EBCDIC and they cannot be expressed as quoted literals
   398	     *	     as the values are <Line Feed>, <Tab>, <End of File> etc.
   399	     *	     characters in ASCII
   400	     *
   401	     *	     They have their values set up to default to the EBCDIC
   402	     *	     values.
   403	     *
   404	     *	     3270 orders are only needed for EXEC CICS SEND and RECEIVE
   405	     *	     and SEND TEXT with imbedded format orders.
   406	     *	     If you use these values in ASCII programs the values
   407	     *	     must be changed.
   408	     *
   409	     *	     An alternative is to use REPLACING to change the values.
   410	     *
   411	     *	  i.e. COPY DFHBMSCA replacing
   412	     *			    ==005== BY ==009==	*> DFHPT
   413	     *			    ==021== BY ==010==	*> DFHNL
   414	     *			    ==040== BY ==021==	*> DFHSA
   415	     *			    ==041== BY ==031==	*> DFHSFE
   416	     *			    ==044== BY ==023==	*> DFHMF
   417	     *			    ==060== BY ==020==	*> DFHRA
   418	     *			    ==063== BY ==026==. *> DFHSUB
   419	     *
   420	     ******************************************************************
   421	     *BMS and Terminal Control - Order & Attributes constants	      *
   422	     ******************************************************************
   423	     *
   424	     *	  Field Attributes
   425	     *
   426            05  DFHBMASB                          PIC X VALUE '8'.
   427            05  DFHBMASF                          PIC X VALUE '1'.
   428            05  DFHBMASK                          PIC X VALUE '0'.   429            05  DFHBMBRY                          PIC X VALUE 'H'.
   430            05  DFHBMDAR                          PIC X VALUE '<'.
   431            05  DFHBMFSE                          PIC X VALUE 'A'.
   432            05  DFHBMPRF                          PIC X VALUE '/'.
   433            05  DFHBMPRO                          PIC X VALUE '-'.
   434            05  DFHBMUNN                          PIC X VALUE '&'.
   435            05  DFHBMUNP                          PIC X VALUE ' '.
   436            05  DFHUNNUM                          PIC X VALUE 'J'.
   437	     *
   438	     *	  partially supported
   439	     *
   440            05  DFHUNNOD                          PIC X VALUE '('.
   441            05  DFHUNIMD                          PIC X VALUE 'I'.
   442            05  DFHUNINT                          PIC X VALUE 'R'.
   443            05  DFHUNNON                          PIC X VALUE '('.
   444            05  DFHPROTI                          PIC X VALUE 'Y'.
   445            05  DFHPROTN                          PIC X VALUE '%'.
   446	     *
   447	     *	  These values are additions to mainframe constants
   448	     *
   449            05  DFHBMS-ASK-DARK                   PIC X VALUE '@'.
   450            05  DFHBMS-ASK-BRY-FSET               PIC X VALUE '9'.
   451            05  DFHBMS-ASK-DAR-FSET               PIC X VALUE ''''.
   452	     *						      VALUE APOST
   453            05  DFHBMS-PRO-BRY-FSET               PIC X VALUE 'Z'.
   454            05  DFHBMS-PRO-DAR-FSET               PIC X VALUE '_'.
   455            05  DFHBMS-NUM-BRY                    PIC X VALUE 'Q'.
   456            05  DFHBMS-NUM-DAR                    PIC X VALUE '*'.
   457            05  DFHBMS-NUM-DAR-FSET               PIC X VALUE ')'.
   458	     *
   459	     *	  Field Flag values
   460		  05  DFHBMEOF-VAL VALUE 128		PIC S9(4) COMP-4.
   461		  05  FILLER REDEFINES DFHBMEOF-VAL.
   462		      10  FILLER			PIC X.
   463		      10  DFHBMEOF			PIC X.
   464       *                                          x'80'.
   465		  05  DFHBMCUR-VAL VALUE 002		PIC S9(4) COMP-4.
   466		  05  FILLER REDEFINES DFHBMCUR-VAL.
   467		      10  FILLER			PIC X.
   468		      10  DFHBMCUR			PIC X.
   469       *                                          x'02'.
   470		  05  DFHBMMEC-VAL VALUE 130		PIC S9(4) COMP-4.
   471		  05  FILLER REDEFINES DFHBMMEC-VAL.
   472		      10  FILLER			PIC X.
   473		      10  DFHBMMEC			PIC X.
   474       *                                          x'82'.
   475       *                                          x'02'.
   476		  05  DFHBMFLG-VAL  VALUE 0		PIC S9(4) COMP-4.
   477		      88  DFHERASE			VALUES 128 130.
   478       *                                          x'80' X'82'
   479		      88  DFHCURSR			VALUES 002 130.
   480       *                                          x'02' X'82'
   481		  05  FILLER REDEFINES DFHBMFLG-VAL.
   482		      10  FILLER			PIC X.
   483		      10  DFHBMFLG			PIC X.
   484
   485		  05  DFHBMDUP-VAL VALUE 028		PIC S9(4) COMP-4.
   486		  05  FILLER REDEFINES DFHBMDUP-VAL.
   487		      10  FILLER			PIC X.
   488		      10  DFHBMDUP			PIC X.   489       *                                              x'1C'
   490	     *
   491	     ******************************************************************
   492	     *	  supported 327X Extended Attributes
   493	     *
   494	     *	  Extended COLOR Attributes
   495	     *
   496            05  DFHDFCOL                          PIC X VALUE '0'.
   497            05  DFHBLUE                           PIC X VALUE '1'.
   498            05  DFHRED                            PIC X VALUE '2'.
   499            05  DFHPINK                           PIC X VALUE '3'.
   500            05  DFHGREEN                          PIC X VALUE '4'.
   501            05  DFHTURQ                           PIC X VALUE '5'.
   502            05  DFHYELLO                          PIC X VALUE '6'.
   503            05  DFHNEUTR                          PIC X VALUE '7'.
   504	     *
   505	     *	  Extended HILIGHT Attributes
   506	     *
   507            05  DFHDFHI                           PIC X VALUE '0'.
   508            05  DFHBLINK                          PIC X VALUE '1'.
   509            05  DFHREVRS                          PIC X VALUE '2'.
   510            05  DFHUNDLN                          PIC X VALUE '4'.
   511	     *
   512	     ******************************************************************
   513	     *	  supported 327X Data Stream Orders
   514	     *
   515		  05  DFHSBA-VAL VALUE 017		 PIC S9(4) COMP-4.
   516		  05  FILLER REDEFINES DFHSBA-VAL.
   517		      10  FILLER			PIC X.
   518		      10  DFHSBA			PIC X.
   519       *                                              x'11'
   520		  05  DFHEUA-VAL VALUE 018		PIC S9(4) COMP-4.
   521		  05  FILLER REDEFINES DFHEUA-VAL.
   522		      10  FILLER			PIC X.
   523		      10  DFHEUA			PIC X.
   524       *                                              x'12'
   525		  05  DFHIC-VAL VALUE 019		PIC S9(4) COMP-4.
   526		  05  FILLER REDEFINES DFHIC-VAL.
   527		      10  FILLER			PIC X.
   528		      10  DFHIC 			PIC X.
   529       *                                              X'13'.
   530		  05  DFHSF-VAL VALUE 029		PIC S9(4) COMP-4.
   531		  05  FILLER REDEFINES DFHSF-VAL.
   532		      10  FILLER			PIC X.
   533		      10  DFHSF 			PIC X.
   534       *                                              X'1D'.
   535		  05  DFHPT-VAL VALUE 005		PIC S9(4) COMP-4.
   536		      88 DFHPT-VAL-EBCDIC		VALUE 5.
   537		      88 DFHPT-VAL-ASCII		VALUE 9.
   538		  05  FILLER REDEFINES DFHPT-VAL.
   539		      10  FILLER			PIC X.
   540		      10  DFHPT 			PIC X.
   541       *                                              EBCDIC X'05'.
   542       *                                              ASCII  X'09'.
   543		  05  DFHRA-VAL VALUE 060		PIC S9(4) COMP-4.
   544		      88 DFHRA-VAL-EBCDIC		VALUE 60.
   545		      88 DFHRA-VAL-ASCII		VALUE 20.
   546		  05  FILLER REDEFINES DFHRA-VAL.
   547		      10  FILLER			PIC X.
   548		      10  DFHRA 			PIC X.   549       *                                              EBCDIC x'3C'
   550       *                                              ASCII  x'14'
   551		  05  DFHSFE-VAL VALUE 041		PIC S9(4) COMP-4.
   552		      88 DFHSFE-VAL-EBCDIC		VALUE 41.
   553		      88 DFHSFE-VAL-ASCII		VALUE 31.
   554		  05  FILLER REDEFINES DFHSFE-VAL.
   555		      10  FILLER			PIC X.
   556		      10  DFHSFE			PIC X.
   557       *                                              EBCDIC x'29'
   558       *                                              ASCII  x'1F'
   559		  05  DFHMF-VAL VALUE 044		PIC S9(4) COMP-4.
   560		      88 DFHMF-VAL-EBCDIC		VALUE 44.
   561		      88 DFHMF-VAL-ASCII		VALUE 23.
   562		  05  FILLER REDEFINES DFHMF-VAL.
   563		      10  FILLER			PIC X.
   564		      10  DFHMF 			PIC X.
   565       *                                              EBCDIC x'2C'
   566       *                                              ASCII  x'17'
   567	     *
   568	     ******************************************************************
   569	     *	  unsupported 327X Data Stream order codes
   570	     *
   571		  05  DFHSA-VAL VALUE 040		PIC S9(4) COMP-4.
   572		      88 DFHSA-VAL-EBCDIC		VALUE 40.
   573		      88 DFHSA-VAL-ASCII		VALUE 21.
   574		  05  FILLER REDEFINES DFHSA-VAL.
   575		      10  FILLER			PIC X.
   576		      10  DFHSA 			PIC X.
   577       *                                              EBCDIC x'28'
   578       *                                              ASCII  x'15'
   579		  05  DFHGE-VAL VALUE 008		PIC S9(4) COMP-4.
   580		  05  FILLER REDEFINES DFHGE-VAL.
   581		      10  FILLER			PIC X.
   582		      10  DFHGE 			PIC X.
   583       *                                              X'08'.
   584	     *
   585	     ******************************************************************
   586	     *	  SFE and MF supported attribute types
   587	     *
   588            05  DFHCOLOR                          PIC X VALUE 'ƒ'.
   589       *                                              EBCDIC x'42'
   590       *                                              ASCII  x'83'
   591            05  DFHHLT                            PIC X VALUE 'Ö'.
   592       *                                              EBCDIC x'41'
   593       *                                              ASCII  x'D6'
   594            05  DFH3270                           PIC X VALUE '{'.
   595	     *
   596	     *	  supported for SEND TEXT command and printer terminal
   597	     *
   598		  05  DFHBMPNL-VAL VALUE 021		PIC S9(4) COMP-4.
   599		      88 DFHBMPNL-VAL-EBCDIC		VALUE 21.
   600		      88 DFHBMPNL-VAL-ASCII		VALUE 10.
   601		  05  FILLER REDEFINES DFHBMPNL-VAL.
   602		      10  FILLER			PIC X.
   603		      10  DFHBMPNL			PIC X.
   604       *                                              EBCDIC X'15'.
   605       *                                              ASCII  X'0A'.
   606	     *
   607	     ******************************************************************
   608	     *	  Printer terminal data stream only   609	     *
   610		  05  DFHBMPFF-VAL VALUE 012		PIC S9(4) COMP-4.
   611		  05  FILLER REDEFINES DFHBMPFF-VAL.
   612		      10  FILLER			PIC X.
   613		      10  DFHBMPFF			PIC X.
   614       *                                              X'0C'.
   615		  05  DFHBMPCR-VAL VALUE 013		PIC S9(4) COMP-4.
   616		  05  FILLER REDEFINES DFHBMPCR-VAL.
   617		      10  FILLER			PIC X.
   618		      10  DFHBMPCR			PIC X.
   619       *                                              X'0D'.
   620		  05  DFHBMPEM-VAL VALUE 025		PIC S9(4) COMP-4.
   621		  05  FILLER REDEFINES DFHBMPEM-VAL.
   622		      10  FILLER			PIC X.
   623		      10  DFHBMPEM			PIC X.
   624       *                                              X'19'.
   625	     *
   626	     ******************************************************************
   627	     *	  unsupported Miscellaneous attributes and constants
   628	     *
   629		  05  DFHALL				PIC X VALUE LOW-VALUES.
   630            05  DFHBASE                           PIC X VALUE '0'.
   631		  05  DFHBMDET				PIC X VALUE LOW-VALUES.
   632		  05  DFHBMPSOSI-VAL VALUE 3599 	PIC S9(4) COMP-4.
   633		  05  FILLER REDEFINES DFHBMPSOSI-VAL.
   634		      10  DFHBMPSO			PIC X.
   635       *                                              X'0E'.
   636		      10  DFHBMPSI			PIC X.
   637       *                                              X'0F'.
   638		  05  DFHDFT VALUE HIGH-VALUES		PIC X.
   639            05  DFHERROR                          PIC X VALUE '¶'.
   640       *                                              EBCDIC X'1A'.
   641       *                                              ASCII  X'B6'.
   642            05  DFHFIL                            PIC X VALUE '4'.
   643            05  DFHMENT                           PIC X VALUE '2'.
   644            05  DFHMET                            PIC X VALUE '3'.
   645            05  DFHMFE                            PIC X VALUE '6'.
   646            05  DFHMFET                           PIC X VALUE '7'.
   647            05  DFHMFT                            PIC X VALUE '5'.
   648            05  DFHMT                             PIC X VALUE '1'.
   649            05  DFHOUTLN                          PIC X VALUE 'B'.
   650            05  DFHPS                             PIC X VALUE '„'.
   651       *                                              EBCDIC x'43'
   652       *                                              ASCII  x'84'
   653            05  DFHVAL                            PIC X VALUE 'A'.
   654	     *
   655		  05  DFHSUB-VAL   VALUE 063		PIC S9(4) COMP-4.
   656		      88 DFHSUB-VAL-EBCDIC		VALUE 63.
   657		      88 DFHSUB-VAL-ASCII		VALUE 26.
   658		  05  FILLER REDEFINES DFHSUB-VAL.
   659		      10  FILLER			PIC X.
   660		      10  DFHSUB			PIC X.
   661       *                                              EBCDIC X'3F'.
   662       *                                              ASCII  X'1A'.
   663	     *
   664		  05  DFHFM-VAL    VALUE 030		PIC S9(4) COMP-4.
   665		  05  FILLER REDEFINES DFHFM-VAL.
   666		      10  FILLER			PIC X.
   667		      10  DFHFM 			PIC X.
   668       *                                              EBCDIC X'1E'.   669		  05  DFHEO VALUE HIGH-VALUE		PIC X.
   671
   672	      LINKAGE SECTION.
   674	      01  DFHEIBLK.						       R
   675		  05 EIBTIME  PIC S9(7) COMP-3. 			       R
   676		  05 EIBDATE  PIC S9(7) COMP-3. 			       R
   677		  05 EIBTRNID PIC X(4). 				       R
   678		  05 EIBTASKN PIC S9(7) COMP-3. 			       R
   679		  05 EIBTRMID PIC X(4). 				       R
   680		  05 DFHEIGDI PIC S9(4) COMP-4. 			       R
   681		  05 EIBCPOSN PIC S9(4) COMP-4. 			       R
   682		  05 EIBCALEN PIC S9(4) COMP-4. 			       R
   683		  05 EIBAID   PIC X.					       R
   684		  05 EIBFN    PIC X(2). 				       R
   685		  05 EIBRCODE PIC X(6). 				       R
   686		  05 EIBDS    PIC X(8). 				       R
   687		  05 EIBREQID PIC X(8). 				       R
   688		  05 EIBRSRCE PIC X(8). 				       R
   689		  05 EIBSYNC  PIC X.					       R
   690		  05 EIBFREE  PIC X.					       R
   691		  05 EIBRECV  PIC X.					       R
   692		  05 EIBSEND  PIC X.					       R
   693		  05 EIBATT   PIC X.					       R
   694		  05 EIBEOC   PIC X.					       R
   695		  05 EIBFMH   PIC X.					       R
   696		  05 EIBCOMPL PIC X.					       R
   697		  05 EIBSIG   PIC X.					       R
   698		  05 EIBCONF  PIC X.					       R
   699		  05 EIBERR   PIC X.					       R
   700		  05 EIBERRCD PIC X(4). 				       R
   701		  05 EIBSYNRB PIC X.					       R
   702		  05 EIBNODAT PIC X.					       R
   703		  05 EIBRESP  PIC S9(8) COMP-4. 			       R
   704		  05 EIBRESP2 PIC S9(8) COMP-4. 			       R
   705		  05 EIBRLDBK PIC X.					       R
   706		  05 EIBCARESERVED PIC X(32).				       R
   708	      01  DFHCOMMAREA				PIC X(322).
   709	     *
   710	      PROCEDURE DIVISION					       R
   712		  USING DFHEIBLK DFHCOMMAREA.				       R
   737	      000-PROCESS-MENU.
   738	     *
   739            IF EIBTRNID = 'SM00' OR 'SM01' OR 'SM02' OR 'SM03' OR 'SM04'
   740                          OR 'SM05' OR 'SM06' OR 'UA01'
   741		      MOVE LOW-VALUES TO SW00MO
   742		      PERFORM 400-SEARCH-USER
   743		  ELSE
   745		      EXEC CICS SEND TEXT
   746			  FROM (WS-INVALID)
   747			  LENGTH (15)
   748			  ERASE
   749		      END-EXEC
   779		  END-IF
   780
   781		  EVALUATE TRUE
   782		      WHEN EIBCALEN = +0
   783			  MOVE LOW-VALUES TO WS-CHOICE-PH
   784                    MOVE 'ENTER OPTION AND PRESS ENTER' TO ERRMSGO
   785			  PERFORM 100-SEND-MAP
   786		      WHEN EIBAID = DFHPF3   788			  EXEC CICS SEND TEXT
   789			      FROM (WS-END)
   790			      LENGTH (15)
   791			      ERASE
   792			  END-EXEC
   823			  EXEC CICS RETURN END-EXEC
   836		      WHEN EIBAID = DFHENTER
   837			  PERFORM 300-PROCESS-TRAN
   838		      WHEN OTHER
   839			  MOVE WS-INVKEY TO ERRMSGO
   840			  PERFORM 400-SEARCH-USER
   841			  PERFORM 100-SEND-MAP
   842		  END-EVALUATE
   844		  EXEC CICS
   845		      RETURN
   846                    TRANSID('SM00')
   847			  COMMAREA(WS-COMMAREA)
   848		      END-EXEC.
   873	      000-EXIT.
   874		  EXIT.
   875
   876
   877	      100-SEND-MAP.
   878		  MOVE EIBDATE TO WS-DATE.
   879		  MOVE WS-DATE-X TO DATEO.
   881		  EXEC CICS ASKTIME
   882			  ABSTIME      (WS-TIME)
   883		      END-EXEC
   902		      EXEC CICS FORMATTIME
   903			  ABSTIME      (WS-TIME)
   904                    DATESEP      ('-')
   905			  MMDDYY   (DATEO)
   906		      TIME     (TIMEO)
   907                TIMESEP  (':')
   908		  END-EXEC
   948		  MOVE DFHBMASB TO TIMEA
   949		  MOVE DFHBMASB TO DATEA
   950		  MOVE DFHUNIMD TO OPTIONA
   952		  EXEC CICS
   953                SEND MAP('SW00M')
   954                     MAPSET('SW00S')
   955			   FROM(SW00MO)
   956			   ERASE
   957		  END-EXEC.
   994	      100-EXIT.
   995		  EXIT.
   996
   997	      300-PROCESS-TRAN.
   999		  EXEC CICS
  1000               RECEIVE MAP('SW00M')
  1001                       MAPSET('SW00S')
  1002			     INTO (SW00MI)
  1003		  END-EXEC
  1036		  EVALUATE TRUE
  1037		      WHEN OPTIONL = 0 OR OPTIONI = SPACE
  1038                    MOVE 'OPTION IS REQUIRED' TO ERRMSGO
  1039			  MOVE DFHBMBRY TO OPTIONA
  1040		      WHEN OPTIONI = 1
  1041                    IF WS-CHC1 = '- USER MAINTENANCE'
  1042			      PERFORM 700-TRANSFER-PROG  1043			      IF EIBCALEN = +0
  1045				  EXEC CICS XCTL
  1046                                PROGRAM('UA001P')
  1047				  END-EXEC
  1066			      ELSE
  1068				  EXEC CICS XCTL
  1069                                PROGRAM('UA001P')
  1070				      COMMAREA(WS-COMMAREA)
  1071				  END-EXEC
  1095			      END-IF
  1096			  END-IF
  1097                    IF WS-CHC1 = '- SEARCH TICKET'
  1099			      EXEC CICS XCTL
  1100                            PROGRAM('SM001P')
  1101			      END-EXEC
  1120			  END-IF
  1121		      WHEN OPTIONI = 2
  1122                    IF WS-CHC2 = '- ADD TICKET'
  1123			      PERFORM 700-TRANSFER-PROG
  1124			      IF TIXNOL NOT = +0
  1125				  PERFORM 900-NO-TIX
  1126			      END-IF
  1127			      IF EIBCALEN = +0
  1129				  EXEC CICS XCTL
  1130                                PROGRAM('SM02P')
  1131				  END-EXEC
  1150			      ELSE
  1152				  EXEC CICS XCTL
  1153                                PROGRAM('SM02P')
  1154				      COMMAREA(WS-COMMAREA)
  1155				  END-EXEC
  1179			      END-IF
  1180			  END-IF
  1181                    IF WS-CHC2 = '- UPDATE TICKET'
  1182			      PERFORM 700-TRANSFER-PROG
  1183			      IF TIXNOL NOT = +0
  1184				  PERFORM 900-NO-TIX
  1185			      END-IF
  1186			      IF EIBCALEN = +0
  1188				  EXEC CICS XCTL
  1189                                PROGRAM('SM03P')
  1190				  END-EXEC
  1209			      ELSE
  1211				  EXEC CICS XCTL
  1212                                PROGRAM('SM03P')
  1213				      COMMAREA(WS-COMMAREA)
  1214				  END-EXEC
  1238			      END-IF
  1239			  END-IF
  1240                    IF WS-CHC2 = '- APPROVE TICKET'
  1241			      IF TIXNOL NOT = +0
  1242				  PERFORM 700-TRANSFER-PROG
  1243			      END-IF
  1244			      PERFORM 800-NEED-TIX
  1245			      IF EIBCALEN = +0
  1247				  EXEC CICS XCTL
  1248                                PROGRAM('SM005')
  1249				  END-EXEC
  1268			      ELSE
  1270				  EXEC CICS XCTL  1271                                PROGRAM('SM005')
  1272				      COMMAREA(WS-COMMAREA)
  1273				  END-EXEC
  1297			      END-IF
  1298			  END-IF
  1299			  IF WS-CHC2 = LOW-VALUES
  1300                        MOVE 'INVALID OPTION' TO ERRMSGO
  1301			      PERFORM 100-SEND-MAP
  1302			  END-IF
  1303		      WHEN OPTIONI = 3
  1304                    IF WS-CHC3 = '- USER MAINTENANCE'
  1305			      PERFORM 700-TRANSFER-PROG
  1306			      IF EIBCALEN = +0
  1308				  EXEC CICS XCTL
  1309                                PROGRAM('UA001P')
  1310				  END-EXEC
  1329			      ELSE
  1331				  EXEC CICS XCTL
  1332                                PROGRAM('UA001P')
  1333				      COMMAREA(WS-COMMAREA)
  1334				  END-EXEC
  1358			      END-IF
  1359			  END-IF
  1360                    IF WS-CHC3 = '- APPROVE TICKET'
  1361			      PERFORM 700-TRANSFER-PROG
  1362			      IF TIXNOL NOT = +0
  1363				  PERFORM 800-NEED-TIX
  1364			      END-IF
  1365			      IF EIBCALEN = +0
  1367				  EXEC CICS XCTL
  1368                                PROGRAM('SM005')
  1369				  END-EXEC
  1388			      ELSE
  1390				  EXEC CICS XCTL
  1391                                PROGRAM('SM005')
  1392				      COMMAREA(WS-COMMAREA)
  1393				  END-EXEC
  1417			      END-IF
  1418			  END-IF
  1419                    IF WS-CHC3 = '- UPDATE TICKET'
  1420			      PERFORM 700-TRANSFER-PROG
  1421			      IF TIXNOL NOT = +0
  1422				  PERFORM 800-NEED-TIX
  1423			      END-IF
  1424			      IF EIBCALEN = +0
  1426				  EXEC CICS XCTL
  1427                                PROGRAM('SM03P')
  1428				      COMMAREA(WS-COMMAREA)
  1429				  END-EXEC
  1453			      ELSE
  1455				  EXEC CICS XCTL
  1456                                PROGRAM('SM03P')
  1457				      COMMAREA(WS-COMMAREA)
  1458				  END-EXEC
  1482			      END-IF
  1483			  END-IF
  1484			  IF WS-CHC3 = LOW-VALUES
  1485                        MOVE 'INVALID OPTION' TO ERRMSGO
  1486			      PERFORM 100-SEND-MAP
  1487			  END-IF  1488		      WHEN OPTIONI = 4
  1489                    IF WS-CHC4 = '- USER MAINTENANCE'
  1490			      PERFORM 700-TRANSFER-PROG
  1491			      IF EIBCALEN = +0
  1493				  EXEC CICS XCTL
  1494                                PROGRAM('UA001P')
  1495				  END-EXEC
  1514			      ELSE
  1516				  EXEC CICS XCTL
  1517                                PROGRAM('UA001P')
  1518				      COMMAREA(WS-COMMAREA)
  1519				  END-EXEC
  1543			      END-IF
  1544			  END-IF
  1545                    IF WS-CHC4 = '- CLOSE TICKET'
  1546			      PERFORM 700-TRANSFER-PROG
  1547			      IF TIXNOL NOT = +0
  1548				  PERFORM 800-NEED-TIX
  1549			      END-IF
  1550			      IF EIBCALEN = +0
  1552				  EXEC CICS XCTL
  1553                                PROGRAM('SM004')
  1554				      COMMAREA(WS-COMMAREA)
  1555				  END-EXEC
  1579			      ELSE
  1581				  EXEC CICS XCTL
  1582                                PROGRAM('SM004')
  1583				      COMMAREA(WS-COMMAREA)
  1584				  END-EXEC
  1608			      END-IF
  1609			  END-IF
  1610			  IF WS-CHC4 = LOW-VALUES
  1611                        MOVE 'INVALID OPTION' TO ERRMSGO
  1612			      PERFORM 100-SEND-MAP
  1613			  END-IF
  1614		      WHEN OPTIONI = 5
  1615                    IF WS-CHC5 = '- CANCEL TICKET'
  1616			      PERFORM 700-TRANSFER-PROG
  1617			      IF TIXNOL NOT = +0
  1618				  PERFORM 800-NEED-TIX
  1619			      END-IF
  1620			      IF EIBCALEN = +0
  1622				  EXEC CICS XCTL
  1623                                PROGRAM('SM006P')
  1624				  END-EXEC
  1643			      ELSE
  1645				  EXEC CICS XCTL
  1646                                PROGRAM('SM006P')
  1647				      COMMAREA(WS-COMMAREA)
  1648				  END-EXEC
  1672			      END-IF
  1673			  END-IF
  1674			  IF WS-CHC5 = LOW-VALUES
  1675                        MOVE 'INVALID OPTION' TO ERRMSGO
  1676			      PERFORM 100-SEND-MAP
  1677			  END-IF
  1678		      WHEN OPTIONI = 6
  1679                    IF WS-CHC6 = '- APPROVE TICKET'
  1680			      PERFORM 700-TRANSFER-PROG
  1681			      IF TIXNOL NOT = +0  1682				  PERFORM 800-NEED-TIX
  1683			      END-IF
  1684			      IF EIBCALEN = +0
  1686				  EXEC CICS XCTL
  1687                                PROGRAM('SM005')
  1688				  END-EXEC
  1707			      ELSE
  1709				  EXEC CICS XCTL
  1710                                PROGRAM('SM005')
  1711				      COMMAREA(WS-COMMAREA)
  1712				  END-EXEC
  1736			      END-IF
  1737			  END-IF
  1738                    IF WS-CHC6 = '- USER MAINTENANCE'
  1739			      PERFORM 700-TRANSFER-PROG
  1740			      IF EIBCALEN = +0
  1742				  EXEC CICS XCTL
  1743                                PROGRAM('UA001P')
  1744				  END-EXEC
  1763			      ELSE
  1765				  EXEC CICS XCTL
  1766                                PROGRAM('UA001P')
  1767				      COMMAREA(WS-COMMAREA)
  1768				  END-EXEC
  1792			      END-IF
  1793			  END-IF
  1794			  IF WS-CHC6 = LOW-VALUES
  1795                        MOVE 'INVALID OPTION' TO ERRMSGO
  1796			      PERFORM 100-SEND-MAP
  1797			  END-IF
  1798		      WHEN OPTIONI = 7
  1799                    IF WS-CHC7 = '- USER MAINTENANCE'
  1800			      PERFORM 700-TRANSFER-PROG
  1801			      IF EIBCALEN = +0
  1803				  EXEC CICS XCTL
  1804                                PROGRAM('UA001P')
  1805				  END-EXEC
  1824			      ELSE
  1826				  EXEC CICS XCTL
  1827                                PROGRAM('UA001P')
  1828				      COMMAREA(WS-COMMAREA)
  1829				  END-EXEC
  1853			      END-IF
  1854			  END-IF
  1855			  IF WS-CHC7 = LOW-VALUES
  1856                        MOVE 'INVALID OPTION' TO ERRMSGO
  1857			      PERFORM 100-SEND-MAP
  1858			  END-IF
  1859		      WHEN OPTIONI NOT = 1 OR 2 OR 3 OR 4 OR 5 OR 6 OR 7
  1860			  IF WS-CHC7 = LOW-VALUES
  1861                        MOVE 'INVALID OPTION' TO ERRMSGO
  1862			      PERFORM 100-SEND-MAP
  1863			  END-IF
  1864		  END-EVALUATE
  1865		  PERFORM 100-SEND-MAP.
  1866	      300-EXIT.
  1867		  EXIT.
  1868
  1869	      400-SEARCH-USER.
  1871		  EXEC CICS ASSIGN  1872		      USERID(WS-USERID)
  1873		  END-EXEC
  1892		  EXEC CICS
  1893                READ FILE('UAF00001')
  1894		      INTO (WS-USER-REC)
  1895		      RIDFLD (WS-USERID)
  1896		      RESP(WS-RESPONSE-CODE)
  1897		      GTEQ
  1898		  END-EXEC
  1936            IF WS-RESPONSE-CODE NOT = +00 OR (REQUESTOR = 'N' AND
  1937                                      SERVICE-PROVIDER = 'N' AND APPROVER
  1938                                          = 'N' AND ADMINISTRATOR = 'N')
  1940		      EXEC CICS SEND TEXT
  1941			  FROM (WS-INVALID)
  1942			  LENGTH (+25)
  1943			  ERASE
  1944		      END-EXEC
  1975		      EXEC CICS RETURN END-EXEC
  1988		  ELSE
  1989		   MOVE WS-USERID TO USERID
  1990		   MOVE 1 TO WS-PROG-STATE
  1991		  END-IF
  1992            IF REQUESTOR = 'Y'
  1993                MOVE '- SEARCH TICKET' TO WS-CHOICE
  1994		      PERFORM 500-MOVE-CHOICE-VAL
  1995                MOVE '- ADD TICKET' TO WS-CHOICE
  1996		      PERFORM 500-MOVE-CHOICE-VAL
  1997                MOVE '- UPDATE TICKET' TO WS-CHOICE
  1998		      PERFORM 500-MOVE-CHOICE-VAL
  1999                MOVE '- CLOSE TICKET' TO WS-CHOICE
  2000		      PERFORM 500-MOVE-CHOICE-VAL
  2001                MOVE '- CANCEL TICKET' TO WS-CHOICE
  2002		      PERFORM 500-MOVE-CHOICE-VAL
  2003		  END-IF
  2004            IF SERVICE-PROVIDER = 'Y'
  2005                IF NOT REQUESTOR = 'Y'
  2006                    MOVE '- SEARCH TICKET' TO WS-CHOICE
  2007			  PERFORM 500-MOVE-CHOICE-VAL
  2008                    MOVE '- UPDATE TICKET' TO WS-CHOICE
  2009			  PERFORM 500-MOVE-CHOICE-VAL
  2010		      ELSE
  2011			  CONTINUE
  2012		      END-IF
  2013		  END-IF
  2014            IF APPROVER = 'Y'
  2015                IF NOT (REQUESTOR = 'Y' OR SERVICE-PROVIDER = 'Y')
  2016                    MOVE '- SEARCH TICKET' TO WS-CHOICE
  2017			  PERFORM 500-MOVE-CHOICE-VAL
  2018		      ELSE
  2019                    MOVE '- APPROVE TICKET' TO WS-CHOICE
  2020			  PERFORM 500-MOVE-CHOICE-VAL
  2021		      END-IF
  2022		  END-IF
  2023            IF ADMINISTRATOR = 'Y'
  2024                MOVE '- USER MAINTENANCE' TO WS-CHOICE
  2025		      PERFORM 500-MOVE-CHOICE-VAL
  2026		  END-IF.
  2027	      400-EXIT.
  2028		  EXIT.
  2029  2030	      500-MOVE-CHOICE-VAL.
  2031		  EVALUATE TRUE
  2032		      WHEN OPTCHC1O = LOW-VALUES
  2033			  MOVE WS-INDEX TO OPTNO1O
  2034			  MOVE WS-CHOICE TO OPTCHC1O
  2035			  MOVE WS-CHOICE TO WS-CHC1
  2036			  ADD 1 TO WS-INDEX
  2037		      WHEN OPTCHC2O = LOW-VALUES
  2038			  MOVE WS-INDEX TO OPTNO2O
  2039			  MOVE WS-CHOICE TO OPTCHC2O
  2040			  MOVE WS-CHOICE TO WS-CHC2
  2041			  ADD 1 TO WS-INDEX
  2042		      WHEN OPTCHC3O = LOW-VALUES
  2043			  MOVE WS-INDEX TO OPTNO3O
  2044			  MOVE WS-CHOICE TO OPTCHC3O
  2045			  MOVE WS-CHOICE TO WS-CHC3
  2046			  ADD 1 TO WS-INDEX
  2047		      WHEN OPTCHC4O = LOW-VALUES
  2048			  MOVE WS-INDEX TO OPTNO4O
  2049			  MOVE WS-CHOICE TO OPTCHC4O
  2050			  MOVE WS-CHOICE TO WS-CHC4
  2051			  ADD 1 TO WS-INDEX
  2052		      WHEN OPTCHC5O = LOW-VALUES
  2053			  MOVE WS-INDEX TO OPTNO5O
  2054			  MOVE WS-CHOICE TO OPTCHC5O
  2055			  MOVE WS-CHOICE TO WS-CHC5
  2056			  ADD 1 TO WS-INDEX
  2057		      WHEN OPTCHC6O = LOW-VALUES
  2058			  MOVE WS-INDEX TO OPTNO6O
  2059			  MOVE WS-CHOICE TO OPTCHC6O
  2060			  MOVE WS-CHOICE TO WS-CHC6
  2061			  ADD 1 TO WS-INDEX
  2062		      WHEN OPTCHC7O = LOW-VALUES
  2063			  MOVE WS-INDEX TO OPTNO7O
  2064			  MOVE WS-CHOICE TO OPTCHC7O
  2065			  MOVE WS-CHOICE TO WS-CHC7
  2066			  ADD 1 TO WS-INDEX
  2067		  END-EVALUATE.
  2068	      500-EXIT.
  2069		  EXIT.
  2070
  2071	      600-VALIDATE-TICKET.
  2073		  EXEC CICS
  2074                READ FILE('STF00001')
  2075		      INTO (WS-TIX-REC)
  2076		      RIDFLD (WS-TICKET-NUM1)
  2077		      RESP(WS-RESPONSE-CODE)
  2078		      EQUAL
  2079		  END-EXEC
  2118		  IF EIBRESP = DFHRESP(NOTFND)
  2120		  IF EIBRESP =	       013				       R
  2121                MOVE 'N' TO WS-VALID-TIX-FLAG
  2122		  ELSE
  2123                MOVE 'Y' TO WS-VALID-TIX-FLAG
  2124		      MOVE 1 TO WS-PROG-STATE
  2125
  2126                IF WS-CHC2 = '- ADD TICKET'
  2127		       IF WS-TICKET-NUM = SPACES
  2128                  MOVE '0' TO WS-TICKET-NUM
  2129		       END-IF  2130		      END-IF
  2131		  END-IF.
  2132	      600-EXIT.
  2133		  EXIT.
  2134
  2135	      700-TRANSFER-PROG.
  2136		  IF TIXNOI = SPACES OR TIXNOL = ZERO OR TIXNOI = LOW-VALUES
  2137		      MOVE TIXNOI TO WS-TICKET-NUM1
  2138		      MOVE +0 TO EIBCALEN
  2139                MOVE '0' TO WS-TICKET-NUM
  2140		  ELSE
  2141                MOVE 'N' TO WS-INIT
  2142		      MOVE TIXNOI TO WS-TICKET-NUM1
  2143		      PERFORM 600-VALIDATE-TICKET
  2144		  END-IF.
  2145	      700-EXIT.
  2146		  EXIT.
  2147
  2148	      800-NEED-TIX.
  2149            IF WS-VALID-TIX-FLAG = 'N'
  2150		      MOVE WS-INVALID-TICKET TO ERRMSGO
  2151		      PERFORM 600-VALIDATE-TICKET
  2152		      PERFORM 100-SEND-MAP
  2154		      EXEC CICS RETURN
  2155                    TRANSID('SM00')
  2156			  COMMAREA(WS-COMMAREA)
  2157		      END-EXEC
  2181		  END-IF.
  2182	      800-EXIT.
  2183		  EXIT.
  2184
  2185	      900-NO-TIX.
  2186            IF WS-VALID-TIX-FLAG = 'Y'
  2187		      MOVE WS-DUP-TICKET TO ERRMSGO
  2188		      PERFORM 600-VALIDATE-TICKET
  2189		      PERFORM 100-SEND-MAP
  2191		      EXEC CICS RETURN
  2192                    TRANSID('SM00')
  2193			  COMMAREA(WS-COMMAREA)
  2194		      END-EXEC
  2218		  END-IF.
  2219	      900-EXIT.
  2220		  EXIT.CA-Realia COBOL Version 6.0.45	 C:\handson-cics\CAWB30\sm000p.cic     PAGE   20



			Realia COBOL Compiler Version Information

			      Pass 1	 Version 6.072
			      Pass 1a	 Version 6.015
			      Pass 2	 Version 6.068
			      Pass 2a	 Version 6.020
			      Pass 3	 Version 6.094
			      Pass 4	 Version 6.007
			      Pass 5	 Version 6.022


			Compilation Directives in Effect

COMP-4		  DCHK		    OPT 	      NOCALL
NOSUBCHK	  STRCHK	    NOTRUNC	      NOSMALLCOMP
NODCALL 	  NODIVZERO	    NOEPDCALL	      APOST
EBCDIC		  STATABORT	    NOMOVELINK	      NOBLL4K
ARGCHK		  UPLOW 	    NOVERARG	      MDY
LP:   60	  PP		    FCREATE	      NOIEEE
NOLILIAN	  CURRENCY-SIGN=$   WRITEAFTER	      SOSI
NOCOPY68	  NOFLAG-COM	    NOFLAG-SEG	      NOFLAG-FIPS
DEBUGXREF	  DIALECT-VS2

			Error level limit: W

			Source lines compiled:	    2231
			Compilation time (mm:ss.ss):  0:00.06
			Compilation speed (lines/minute): 31000

			Compilation date (yy/mm/dd): 23/12/04
			     Time of day (hh:mm:ss): 09:33:39