     5	     *	CBL XOPTS(COBOL2)
    20	      IDENTIFICATION DIVISION.
    21	      PROGRAM-ID. SM000P.
    22
    23	      ENVIRONMENT DIVISION.
    24	      CONFIGURATION SECTION.
    25	      SOURCE-COMPUTER.	  IBM-PC.
    26	      OBJECT-COMPUTER.	  IBM-PC.
    27	      DATA DIVISION.
    28	      WORKING-STORAGE SECTION.
    74	      01  WS-TIME			  PIC 9(15) COMP-3.
    75	      01  WS-DATE				PIC 9(7).
    76	      01  WS-DATE-X REDEFINES WS-DATE		PIC X(7).
    77	      01  WS-LENGTH				PIC S9(4) COMP.
    78	      01  WS-INDEX				PIC 9 VALUE 1.
    79	      01  WS-CHOICE				PIC X(21).
    80	      01  WS-CHOICE-PH.
    81		  05  WS-CHC1				PIC X(21).
    82		  05  WS-CHC2				PIC X(21).
    83		  05  WS-CHC3				PIC X(21).
    84		  05  WS-CHC4				PIC X(21).
    85		  05  WS-CHC5				PIC X(21).
    86		  05  WS-CHC6				PIC X(21).
    87		  05  WS-CHC7				PIC X(21).
    88	      01  WS-USERID				PIC X(7).
    89	      01  WS-TIXID				PIC X(6).
    90	      01  WS-RESPONSE-CODE    PIC S9(8) COMP.
    91	      01  WS-LOGID.
    92		  05  LOGID2				PIC X(6).
    93		  05  FILLER				PIC X.
    94	      01  WS-USER-REC.
    95		  05  USERID.
    96		      10  USERID1			PIC X(7).
    97		      10  FILLER			PIC X.
    98		  05  REQUESTOR 			PIC X.
    99		  05  SERVICE-PROVIDER			PIC X.
   100		  05  APPROVER				PIC X.
   101		  05  ADMINISTRATOR			PIC X.
   102		  05  UPDATED-BY1.
   103		      10  UPDBY1			PIC X(7).
   104		      10  FILLER			PIC X.
   105	      01  WS-TIX-REC.
   106		  05  TIX-ID				PIC X(06).
   107		  05  TIX-REQUESTOR			PIC X(08).
   108		  05  TIX-STATUS			PIC X(10).
   109		  05  TIX-TITLE 			PIC X(25).
   110		  05  TIX-DESC				PIC X(100).
   111		  05  TIX-DESC-RED REDEFINES TIX-DESC.
   112		      10  TIX-DESC1			PIC X(50).
   113		      10  TIX-DESC2			PIC X(50).
   114		  05  LAST-UPDATE			PIC X(20).
   115		  05  LAST-UPDATE-RED REDEFINES LAST-UPDATE.
   116		      10  LAST-UPDATE-DATE		PIC X(11).
   117		      10  LAST-UPDATE-TIME		PIC X(09).
   118		  05  UPDATED-BY2.
   119		      10  UPDBY2			PIC X(7).
   120		      10  FILLER			PIC X.
   121		  05  LAST-UPDATE-REM			PIC X(50).
   122		  05  LAST-UPDATE-REMW REDEFINES LAST-UPDATE-REM.
   123		      10  LAST-UPDATE-REM1		PIC X(25).   124		      10  LAST-UPDATE-REM2		PIC X(25).
   125	      01  WS-END				PIC X(15) VALUE
   126            'END PROCESSING'.
   127	      01  WS-INVKEY				PIC X(21) VALUE
   128            'INVALID PFKEY PRESSED'.
   129	      01  WS-INVALID			  PIC X(14) VALUE
   130            'INVALID ACCESS'.
   131	      01  WS-INVALID-TICKET			  PIC X(28) VALUE
   132            'TICKET NUMBER DOES NOT EXIST'.
   133	      01  WS-INVALID-USER			  PIC X(24) VALUE
   134            'INVALID ACCESS TO TICKET'.
   135	      01  WS-COMMAREA.
   136		  05  WS-USERID1			 PIC X(7).
   137		  05  WS-TICKET-NUM.
   138		      10  WS-TICKET-NUM1		 PIC X(6).
   139		      10  FILLER			 PIC X.
   140		  05  WS-PROG-STATE			 PIC 9(1).
   141            05  WS-INIT                            PIC X VALUE 'Y'.
   142
   143	     *
   144		  COPY SM000S.
   146	     * SYMBOLIC MAP of sm000s Created by CACXBMS Version 6.0.27
   147	      01  SW00MI.
   148		  02  FILLER				     PIC X(12).
   149		  02  OPTCHC1L				     PIC S9(4) COMP.
   150		  02  OPTCHC1F				     PIC X.
   151		  02  FILLER REDEFINES OPTCHC1F.
   152		      03  OPTCHC1A			     PIC X.
   153		  02  OPTCHC1I				     PIC X(021).
   154		  02  OPTNO1L				     PIC S9(4) COMP.
   155		  02  OPTNO1F				     PIC X.
   156		  02  FILLER REDEFINES OPTNO1F.
   157		      03  OPTNO1A			     PIC X.
   158		  02  OPTNO1I				     PIC X(001).
   159		  02  OPTCHC2L				     PIC S9(4) COMP.
   160		  02  OPTCHC2F				     PIC X.
   161		  02  FILLER REDEFINES OPTCHC2F.
   162		      03  OPTCHC2A			     PIC X.
   163		  02  OPTCHC2I				     PIC X(021).
   164		  02  OPTNO2L				     PIC S9(4) COMP.
   165		  02  OPTNO2F				     PIC X.
   166		  02  FILLER REDEFINES OPTNO2F.
   167		      03  OPTNO2A			     PIC X.
   168		  02  OPTNO2I				     PIC X(001).
   169		  02  OPTCHC3L				     PIC S9(4) COMP.
   170		  02  OPTCHC3F				     PIC X.
   171		  02  FILLER REDEFINES OPTCHC3F.
   172		      03  OPTCHC3A			     PIC X.
   173		  02  OPTCHC3I				     PIC X(021).
   174		  02  OPTNO3L				     PIC S9(4) COMP.
   175		  02  OPTNO3F				     PIC X.
   176		  02  FILLER REDEFINES OPTNO3F.
   177		      03  OPTNO3A			     PIC X.
   178		  02  OPTNO3I				     PIC X(001).
   179		  02  OPTCHC4L				     PIC S9(4) COMP.
   180		  02  OPTCHC4F				     PIC X.
   181		  02  FILLER REDEFINES OPTCHC4F.
   182		      03  OPTCHC4A			     PIC X.
   183		  02  OPTCHC4I				     PIC X(021).
   184		  02  OPTNO4L				     PIC S9(4) COMP.   185		  02  OPTNO4F				     PIC X.
   186		  02  FILLER REDEFINES OPTNO4F.
   187		      03  OPTNO4A			     PIC X.
   188		  02  OPTNO4I				     PIC X(001).
   189		  02  OPTCHC5L				     PIC S9(4) COMP.
   190		  02  OPTCHC5F				     PIC X.
   191		  02  FILLER REDEFINES OPTCHC5F.
   192		      03  OPTCHC5A			     PIC X.
   193		  02  OPTCHC5I				     PIC X(021).
   194		  02  OPTNO5L				     PIC S9(4) COMP.
   195		  02  OPTNO5F				     PIC X.
   196		  02  FILLER REDEFINES OPTNO5F.
   197		      03  OPTNO5A			     PIC X.
   198		  02  OPTNO5I				     PIC X(001).
   199		  02  OPTCHC6L				     PIC S9(4) COMP.
   200		  02  OPTCHC6F				     PIC X.
   201		  02  FILLER REDEFINES OPTCHC6F.
   202		      03  OPTCHC6A			     PIC X.
   203		  02  OPTCHC6I				     PIC X(021).
   204		  02  OPTNO6L				     PIC S9(4) COMP.
   205		  02  OPTNO6F				     PIC X.
   206		  02  FILLER REDEFINES OPTNO6F.
   207		      03  OPTNO6A			     PIC X.
   208		  02  OPTNO6I				     PIC X(001).
   209		  02  OPTCHC7L				     PIC S9(4) COMP.
   210		  02  OPTCHC7F				     PIC X.
   211		  02  FILLER REDEFINES OPTCHC7F.
   212		      03  OPTCHC7A			     PIC X.
   213		  02  OPTCHC7I				     PIC X(021).
   214		  02  OPTNO7L				     PIC S9(4) COMP.
   215		  02  OPTNO7F				     PIC X.
   216		  02  FILLER REDEFINES OPTNO7F.
   217		      03  OPTNO7A			     PIC X.
   218		  02  OPTNO7I				     PIC X(001).
   219		  02  OPTIONL				     PIC S9(4) COMP.
   220		  02  OPTIONF				     PIC X.
   221		  02  FILLER REDEFINES OPTIONF.
   222		      03  OPTIONA			     PIC X.
   223		  02  OPTIONI				     PIC X(001).
   224		  02  TIXNOL				     PIC S9(4) COMP.
   225		  02  TIXNOF				     PIC X.
   226		  02  FILLER REDEFINES TIXNOF.
   227		      03  TIXNOA			     PIC X.
   228		  02  TIXNOI				     PIC X(006).
   229		  02  ERRMSGL				     PIC S9(4) COMP.
   230		  02  ERRMSGF				     PIC X.
   231		  02  FILLER REDEFINES ERRMSGF.
   232		      03  ERRMSGA			     PIC X.
   233		  02  ERRMSGI				     PIC X(071).
   234		  02  DATEL				     PIC S9(4) COMP.
   235		  02  DATEF				     PIC X.
   236		  02  FILLER REDEFINES DATEF.
   237		      03  DATEA 			     PIC X.
   238		  02  DATEI				     PIC X(010).
   239		  02  TIMEL				     PIC S9(4) COMP.
   240		  02  TIMEF				     PIC X.
   241		  02  FILLER REDEFINES TIMEF.
   242		      03  TIMEA 			     PIC X.
   243		  02  TIMEI				     PIC X(008).
   244	      01  SW00MO REDEFINES SW00MI.   245		  02  FILLER				     PIC X(12).
   246		  02  FILLER				     PIC XX.
   247		  02  FILLER				     PIC X.
   248		  02  OPTCHC1O				     PIC X(021).
   249		  02  FILLER				     PIC XX.
   250		  02  FILLER				     PIC X.
   251		  02  OPTNO1O				     PIC X(001).
   252		  02  FILLER				     PIC XX.
   253		  02  FILLER				     PIC X.
   254		  02  OPTCHC2O				     PIC X(021).
   255		  02  FILLER				     PIC XX.
   256		  02  FILLER				     PIC X.
   257		  02  OPTNO2O				     PIC X(001).
   258		  02  FILLER				     PIC XX.
   259		  02  FILLER				     PIC X.
   260		  02  OPTCHC3O				     PIC X(021).
   261		  02  FILLER				     PIC XX.
   262		  02  FILLER				     PIC X.
   263		  02  OPTNO3O				     PIC X(001).
   264		  02  FILLER				     PIC XX.
   265		  02  FILLER				     PIC X.
   266		  02  OPTCHC4O				     PIC X(021).
   267		  02  FILLER				     PIC XX.
   268		  02  FILLER				     PIC X.
   269		  02  OPTNO4O				     PIC X(001).
   270		  02  FILLER				     PIC XX.
   271		  02  FILLER				     PIC X.
   272		  02  OPTCHC5O				     PIC X(021).
   273		  02  FILLER				     PIC XX.
   274		  02  FILLER				     PIC X.
   275		  02  OPTNO5O				     PIC X(001).
   276		  02  FILLER				     PIC XX.
   277		  02  FILLER				     PIC X.
   278		  02  OPTCHC6O				     PIC X(021).
   279		  02  FILLER				     PIC XX.
   280		  02  FILLER				     PIC X.
   281		  02  OPTNO6O				     PIC X(001).
   282		  02  FILLER				     PIC XX.
   283		  02  FILLER				     PIC X.
   284		  02  OPTCHC7O				     PIC X(021).
   285		  02  FILLER				     PIC XX.
   286		  02  FILLER				     PIC X.
   287		  02  OPTNO7O				     PIC X(001).
   288		  02  FILLER				     PIC XX.
   289		  02  FILLER				     PIC X.
   290		  02  OPTIONO				     PIC X(001).
   291		  02  FILLER				     PIC XX.
   292		  02  FILLER				     PIC X.
   293		  02  TIXNOO				     PIC X(006).
   294		  02  FILLER				     PIC XX.
   295		  02  FILLER				     PIC X.
   296		  02  ERRMSGO				     PIC X(071).
   297		  02  FILLER				     PIC XX.
   298		  02  FILLER				     PIC X.
   299		  02  DATEO				     PIC X(010).
   300		  02  FILLER				     PIC XX.
   301		  02  FILLER				     PIC X.
   302		  02  TIMEO				     PIC X(008).
   304	     *
   305		  COPY DFHAID.   307	      01  DFHAID.
   308	     *
   309	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   310	     *
   311	     * Revision Information
   312	     * ^{File:dfhaid.cob  }
   313	     * ^{Timestamp:Thu May 15 14:02:52 1997}
   314	     * ^{Revision:2.0}
   315	     *
   316	     *This is the AID constants copy file
   317	     *
   318            05  DFHENTER                  PIC X VALUE ''''.
   319	     *					value APOST
   320            05  DFHCLEAR                  PIC X VALUE '_'.
   321            05  DFHPA1                    PIC X VALUE '%'.
   322            05  DFHPA2                    PIC X VALUE '>'.
   323            05  DFHPA3                    PIC X VALUE ','.
   324            05  DFHPF1                    PIC X VALUE '1'.
   325            05  DFHPF2                    PIC X VALUE '2'.
   326            05  DFHPF3                    PIC X VALUE '3'.
   327            05  DFHPF4                    PIC X VALUE '4'.
   328            05  DFHPF5                    PIC X VALUE '5'.
   329            05  DFHPF6                    PIC X VALUE '6'.
   330            05  DFHPF7                    PIC X VALUE '7'.
   331            05  DFHPF8                    PIC X VALUE '8'.
   332            05  DFHPF9                    PIC X VALUE '9'.
   333            05  DFHPF10                   PIC X VALUE ':'.
   334            05  DFHPF11                   PIC X VALUE '#'.
   335            05  DFHPF12                   PIC X VALUE '@'.
   336            05  DFHPF13                   PIC X VALUE 'A'.
   337            05  DFHPF14                   PIC X VALUE 'B'.
   338            05  DFHPF15                   PIC X VALUE 'C'.
   339            05  DFHPF16                   PIC X VALUE 'D'.
   340            05  DFHPF17                   PIC X VALUE 'E'.
   341            05  DFHPF18                   PIC X VALUE 'F'.
   342            05  DFHPF19                   PIC X VALUE 'G'.
   343            05  DFHPF20                   PIC X VALUE 'H'.
   344            05  DFHPF21                   PIC X VALUE 'I'.
   345            05  DFHPF22                   PIC X VALUE '›'.
   346       *                                  EBCDIC Cent sign x'4A'
   347       *                                  ASCII  Cent sign x'9B'
   348            05  DFHPF23                   PIC X VALUE '.'.
   349            05  DFHPF24                   PIC X VALUE '<'.
   350            05  DFHOPID                   PIC X VALUE 'W'.
   351            05  DFHMSRE                   PIC X VALUE 'X'.
   352            05  DFHTRIG                   PIC X VALUE '"'.
   353       *                                        value QUOTE  "
   354            05  DFHPEN                    PIC X VALUE '='.
   355            05  DFHCLRP                   PIC X VALUE 'Ý'.
   356       *                                  EBCDIC x'6A'
   357       *                                  ASCII  x'DD'
   358            05  DFHSTRF                   PIC X VALUE 'h'.
   359	     *	  DFHQUIT is a CA-Realia CICS Extension
   360	     *	  It is set by using <Ctrl>+C or <Ctrl>+<Break> Keys
   361            05  DFHQUIT                   PIC X VALUE '!'.
   362		  05  DFHNULL			PIC X VALUE LOW-VALUE.
   364	     *
   365	      COPY DFHBMSCA.
   367	      01  DFHBMSCA.
   368	     *   369	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   370	     *
   371	     * Revision Information
   372	     * ^{File:dfhbmsca.cob}
   373	     * ^{Timestamp:Tue Oct 08 15:34:54 1996}
   374	     * ^{Revision:2.0}
   375	     *
   376	     *	Note:This FILE is provided with most values as quoted literals
   377	     *	     so that the file can be used for both ASCII and EBCDIC
   378	     *	     programs
   379	     *
   380	     *	     The only exceptions are some 3270 Data Stream Orders
   381	     *	     They use different Hexadecimal values for ASCII and
   382	     *	     EBCDIC and they cannot be expressed as quoted literals
   383	     *	     as the values are <Line Feed>, <Tab>, <End of File> etc.
   384	     *	     characters in ASCII
   385	     *
   386	     *	     They have their values set up to default to the EBCDIC
   387	     *	     values.
   388	     *
   389	     *	     3270 orders are only needed for EXEC CICS SEND and RECEIVE
   390	     *	     and SEND TEXT with imbedded format orders.
   391	     *	     If you use these values in ASCII programs the values
   392	     *	     must be changed.
   393	     *
   394	     *	     An alternative is to use REPLACING to change the values.
   395	     *
   396	     *	  i.e. COPY DFHBMSCA replacing
   397	     *			    ==005== BY ==009==	*> DFHPT
   398	     *			    ==021== BY ==010==	*> DFHNL
   399	     *			    ==040== BY ==021==	*> DFHSA
   400	     *			    ==041== BY ==031==	*> DFHSFE
   401	     *			    ==044== BY ==023==	*> DFHMF
   402	     *			    ==060== BY ==020==	*> DFHRA
   403	     *			    ==063== BY ==026==. *> DFHSUB
   404	     *
   405	     ******************************************************************
   406	     *BMS and Terminal Control - Order & Attributes constants	      *
   407	     ******************************************************************
   408	     *
   409	     *	  Field Attributes
   410	     *
   411            05  DFHBMASB                          PIC X VALUE '8'.
   412            05  DFHBMASF                          PIC X VALUE '1'.
   413            05  DFHBMASK                          PIC X VALUE '0'.
   414            05  DFHBMBRY                          PIC X VALUE 'H'.
   415            05  DFHBMDAR                          PIC X VALUE '<'.
   416            05  DFHBMFSE                          PIC X VALUE 'A'.
   417            05  DFHBMPRF                          PIC X VALUE '/'.
   418            05  DFHBMPRO                          PIC X VALUE '-'.
   419            05  DFHBMUNN                          PIC X VALUE '&'.
   420            05  DFHBMUNP                          PIC X VALUE ' '.
   421            05  DFHUNNUM                          PIC X VALUE 'J'.
   422	     *
   423	     *	  partially supported
   424	     *
   425            05  DFHUNNOD                          PIC X VALUE '('.
   426            05  DFHUNIMD                          PIC X VALUE 'I'.
   427            05  DFHUNINT                          PIC X VALUE 'R'.
   428            05  DFHUNNON                          PIC X VALUE '('.   429            05  DFHPROTI                          PIC X VALUE 'Y'.
   430            05  DFHPROTN                          PIC X VALUE '%'.
   431	     *
   432	     *	  These values are additions to mainframe constants
   433	     *
   434            05  DFHBMS-ASK-DARK                   PIC X VALUE '@'.
   435            05  DFHBMS-ASK-BRY-FSET               PIC X VALUE '9'.
   436            05  DFHBMS-ASK-DAR-FSET               PIC X VALUE ''''.
   437	     *						      VALUE APOST
   438            05  DFHBMS-PRO-BRY-FSET               PIC X VALUE 'Z'.
   439            05  DFHBMS-PRO-DAR-FSET               PIC X VALUE '_'.
   440            05  DFHBMS-NUM-BRY                    PIC X VALUE 'Q'.
   441            05  DFHBMS-NUM-DAR                    PIC X VALUE '*'.
   442            05  DFHBMS-NUM-DAR-FSET               PIC X VALUE ')'.
   443	     *
   444	     *	  Field Flag values
   445		  05  DFHBMEOF-VAL VALUE 128		PIC S9(4) COMP-4.
   446		  05  FILLER REDEFINES DFHBMEOF-VAL.
   447		      10  FILLER			PIC X.
   448		      10  DFHBMEOF			PIC X.
   449       *                                          x'80'.
   450		  05  DFHBMCUR-VAL VALUE 002		PIC S9(4) COMP-4.
   451		  05  FILLER REDEFINES DFHBMCUR-VAL.
   452		      10  FILLER			PIC X.
   453		      10  DFHBMCUR			PIC X.
   454       *                                          x'02'.
   455		  05  DFHBMMEC-VAL VALUE 130		PIC S9(4) COMP-4.
   456		  05  FILLER REDEFINES DFHBMMEC-VAL.
   457		      10  FILLER			PIC X.
   458		      10  DFHBMMEC			PIC X.
   459       *                                          x'82'.
   460       *                                          x'02'.
   461		  05  DFHBMFLG-VAL  VALUE 0		PIC S9(4) COMP-4.
   462		      88  DFHERASE			VALUES 128 130.
   463       *                                          x'80' X'82'
   464		      88  DFHCURSR			VALUES 002 130.
   465       *                                          x'02' X'82'
   466		  05  FILLER REDEFINES DFHBMFLG-VAL.
   467		      10  FILLER			PIC X.
   468		      10  DFHBMFLG			PIC X.
   469
   470		  05  DFHBMDUP-VAL VALUE 028		PIC S9(4) COMP-4.
   471		  05  FILLER REDEFINES DFHBMDUP-VAL.
   472		      10  FILLER			PIC X.
   473		      10  DFHBMDUP			PIC X.
   474       *                                              x'1C'
   475	     *
   476	     ******************************************************************
   477	     *	  supported 327X Extended Attributes
   478	     *
   479	     *	  Extended COLOR Attributes
   480	     *
   481            05  DFHDFCOL                          PIC X VALUE '0'.
   482            05  DFHBLUE                           PIC X VALUE '1'.
   483            05  DFHRED                            PIC X VALUE '2'.
   484            05  DFHPINK                           PIC X VALUE '3'.
   485            05  DFHGREEN                          PIC X VALUE '4'.
   486            05  DFHTURQ                           PIC X VALUE '5'.
   487            05  DFHYELLO                          PIC X VALUE '6'.
   488            05  DFHNEUTR                          PIC X VALUE '7'.   489	     *
   490	     *	  Extended HILIGHT Attributes
   491	     *
   492            05  DFHDFHI                           PIC X VALUE '0'.
   493            05  DFHBLINK                          PIC X VALUE '1'.
   494            05  DFHREVRS                          PIC X VALUE '2'.
   495            05  DFHUNDLN                          PIC X VALUE '4'.
   496	     *
   497	     ******************************************************************
   498	     *	  supported 327X Data Stream Orders
   499	     *
   500		  05  DFHSBA-VAL VALUE 017		 PIC S9(4) COMP-4.
   501		  05  FILLER REDEFINES DFHSBA-VAL.
   502		      10  FILLER			PIC X.
   503		      10  DFHSBA			PIC X.
   504       *                                              x'11'
   505		  05  DFHEUA-VAL VALUE 018		PIC S9(4) COMP-4.
   506		  05  FILLER REDEFINES DFHEUA-VAL.
   507		      10  FILLER			PIC X.
   508		      10  DFHEUA			PIC X.
   509       *                                              x'12'
   510		  05  DFHIC-VAL VALUE 019		PIC S9(4) COMP-4.
   511		  05  FILLER REDEFINES DFHIC-VAL.
   512		      10  FILLER			PIC X.
   513		      10  DFHIC 			PIC X.
   514       *                                              X'13'.
   515		  05  DFHSF-VAL VALUE 029		PIC S9(4) COMP-4.
   516		  05  FILLER REDEFINES DFHSF-VAL.
   517		      10  FILLER			PIC X.
   518		      10  DFHSF 			PIC X.
   519       *                                              X'1D'.
   520		  05  DFHPT-VAL VALUE 005		PIC S9(4) COMP-4.
   521		      88 DFHPT-VAL-EBCDIC		VALUE 5.
   522		      88 DFHPT-VAL-ASCII		VALUE 9.
   523		  05  FILLER REDEFINES DFHPT-VAL.
   524		      10  FILLER			PIC X.
   525		      10  DFHPT 			PIC X.
   526       *                                              EBCDIC X'05'.
   527       *                                              ASCII  X'09'.
   528		  05  DFHRA-VAL VALUE 060		PIC S9(4) COMP-4.
   529		      88 DFHRA-VAL-EBCDIC		VALUE 60.
   530		      88 DFHRA-VAL-ASCII		VALUE 20.
   531		  05  FILLER REDEFINES DFHRA-VAL.
   532		      10  FILLER			PIC X.
   533		      10  DFHRA 			PIC X.
   534       *                                              EBCDIC x'3C'
   535       *                                              ASCII  x'14'
   536		  05  DFHSFE-VAL VALUE 041		PIC S9(4) COMP-4.
   537		      88 DFHSFE-VAL-EBCDIC		VALUE 41.
   538		      88 DFHSFE-VAL-ASCII		VALUE 31.
   539		  05  FILLER REDEFINES DFHSFE-VAL.
   540		      10  FILLER			PIC X.
   541		      10  DFHSFE			PIC X.
   542       *                                              EBCDIC x'29'
   543       *                                              ASCII  x'1F'
   544		  05  DFHMF-VAL VALUE 044		PIC S9(4) COMP-4.
   545		      88 DFHMF-VAL-EBCDIC		VALUE 44.
   546		      88 DFHMF-VAL-ASCII		VALUE 23.
   547		  05  FILLER REDEFINES DFHMF-VAL.
   548		      10  FILLER			PIC X.   549		      10  DFHMF 			PIC X.
   550       *                                              EBCDIC x'2C'
   551       *                                              ASCII  x'17'
   552	     *
   553	     ******************************************************************
   554	     *	  unsupported 327X Data Stream order codes
   555	     *
   556		  05  DFHSA-VAL VALUE 040		PIC S9(4) COMP-4.
   557		      88 DFHSA-VAL-EBCDIC		VALUE 40.
   558		      88 DFHSA-VAL-ASCII		VALUE 21.
   559		  05  FILLER REDEFINES DFHSA-VAL.
   560		      10  FILLER			PIC X.
   561		      10  DFHSA 			PIC X.
   562       *                                              EBCDIC x'28'
   563       *                                              ASCII  x'15'
   564		  05  DFHGE-VAL VALUE 008		PIC S9(4) COMP-4.
   565		  05  FILLER REDEFINES DFHGE-VAL.
   566		      10  FILLER			PIC X.
   567		      10  DFHGE 			PIC X.
   568       *                                              X'08'.
   569	     *
   570	     ******************************************************************
   571	     *	  SFE and MF supported attribute types
   572	     *
   573            05  DFHCOLOR                          PIC X VALUE 'ƒ'.
   574       *                                              EBCDIC x'42'
   575       *                                              ASCII  x'83'
   576            05  DFHHLT                            PIC X VALUE 'Ö'.
   577       *                                              EBCDIC x'41'
   578       *                                              ASCII  x'D6'
   579            05  DFH3270                           PIC X VALUE '{'.
   580	     *
   581	     *	  supported for SEND TEXT command and printer terminal
   582	     *
   583		  05  DFHBMPNL-VAL VALUE 021		PIC S9(4) COMP-4.
   584		      88 DFHBMPNL-VAL-EBCDIC		VALUE 21.
   585		      88 DFHBMPNL-VAL-ASCII		VALUE 10.
   586		  05  FILLER REDEFINES DFHBMPNL-VAL.
   587		      10  FILLER			PIC X.
   588		      10  DFHBMPNL			PIC X.
   589       *                                              EBCDIC X'15'.
   590       *                                              ASCII  X'0A'.
   591	     *
   592	     ******************************************************************
   593	     *	  Printer terminal data stream only
   594	     *
   595		  05  DFHBMPFF-VAL VALUE 012		PIC S9(4) COMP-4.
   596		  05  FILLER REDEFINES DFHBMPFF-VAL.
   597		      10  FILLER			PIC X.
   598		      10  DFHBMPFF			PIC X.
   599       *                                              X'0C'.
   600		  05  DFHBMPCR-VAL VALUE 013		PIC S9(4) COMP-4.
   601		  05  FILLER REDEFINES DFHBMPCR-VAL.
   602		      10  FILLER			PIC X.
   603		      10  DFHBMPCR			PIC X.
   604       *                                              X'0D'.
   605		  05  DFHBMPEM-VAL VALUE 025		PIC S9(4) COMP-4.
   606		  05  FILLER REDEFINES DFHBMPEM-VAL.
   607		      10  FILLER			PIC X.
   608		      10  DFHBMPEM			PIC X.   609       *                                              X'19'.
   610	     *
   611	     ******************************************************************
   612	     *	  unsupported Miscellaneous attributes and constants
   613	     *
   614		  05  DFHALL				PIC X VALUE LOW-VALUES.
   615            05  DFHBASE                           PIC X VALUE '0'.
   616		  05  DFHBMDET				PIC X VALUE LOW-VALUES.
   617		  05  DFHBMPSOSI-VAL VALUE 3599 	PIC S9(4) COMP-4.
   618		  05  FILLER REDEFINES DFHBMPSOSI-VAL.
   619		      10  DFHBMPSO			PIC X.
   620       *                                              X'0E'.
   621		      10  DFHBMPSI			PIC X.
   622       *                                              X'0F'.
   623		  05  DFHDFT VALUE HIGH-VALUES		PIC X.
   624            05  DFHERROR                          PIC X VALUE '¶'.
   625       *                                              EBCDIC X'1A'.
   626       *                                              ASCII  X'B6'.
   627            05  DFHFIL                            PIC X VALUE '4'.
   628            05  DFHMENT                           PIC X VALUE '2'.
   629            05  DFHMET                            PIC X VALUE '3'.
   630            05  DFHMFE                            PIC X VALUE '6'.
   631            05  DFHMFET                           PIC X VALUE '7'.
   632            05  DFHMFT                            PIC X VALUE '5'.
   633            05  DFHMT                             PIC X VALUE '1'.
   634            05  DFHOUTLN                          PIC X VALUE 'B'.
   635            05  DFHPS                             PIC X VALUE '„'.
   636       *                                              EBCDIC x'43'
   637       *                                              ASCII  x'84'
   638            05  DFHVAL                            PIC X VALUE 'A'.
   639	     *
   640		  05  DFHSUB-VAL   VALUE 063		PIC S9(4) COMP-4.
   641		      88 DFHSUB-VAL-EBCDIC		VALUE 63.
   642		      88 DFHSUB-VAL-ASCII		VALUE 26.
   643		  05  FILLER REDEFINES DFHSUB-VAL.
   644		      10  FILLER			PIC X.
   645		      10  DFHSUB			PIC X.
   646       *                                              EBCDIC X'3F'.
   647       *                                              ASCII  X'1A'.
   648	     *
   649		  05  DFHFM-VAL    VALUE 030		PIC S9(4) COMP-4.
   650		  05  FILLER REDEFINES DFHFM-VAL.
   651		      10  FILLER			PIC X.
   652		      10  DFHFM 			PIC X.
   653       *                                              EBCDIC X'1E'.
   654		  05  DFHEO VALUE HIGH-VALUE		PIC X.
   656
   657	      LINKAGE SECTION.
   659	      01  DFHEIBLK.						       R
   660		  05 EIBTIME  PIC S9(7) COMP-3. 			       R
   661		  05 EIBDATE  PIC S9(7) COMP-3. 			       R
   662		  05 EIBTRNID PIC X(4). 				       R
   663		  05 EIBTASKN PIC S9(7) COMP-3. 			       R
   664		  05 EIBTRMID PIC X(4). 				       R
   665		  05 DFHEIGDI PIC S9(4) COMP-4. 			       R
   666		  05 EIBCPOSN PIC S9(4) COMP-4. 			       R
   667		  05 EIBCALEN PIC S9(4) COMP-4. 			       R
   668		  05 EIBAID   PIC X.					       R
   669		  05 EIBFN    PIC X(2). 				       R
   670		  05 EIBRCODE PIC X(6). 				       R   671		  05 EIBDS    PIC X(8). 				       R
   672		  05 EIBREQID PIC X(8). 				       R
   673		  05 EIBRSRCE PIC X(8). 				       R
   674		  05 EIBSYNC  PIC X.					       R
   675		  05 EIBFREE  PIC X.					       R
   676		  05 EIBRECV  PIC X.					       R
   677		  05 EIBSEND  PIC X.					       R
   678		  05 EIBATT   PIC X.					       R
   679		  05 EIBEOC   PIC X.					       R
   680		  05 EIBFMH   PIC X.					       R
   681		  05 EIBCOMPL PIC X.					       R
   682		  05 EIBSIG   PIC X.					       R
   683		  05 EIBCONF  PIC X.					       R
   684		  05 EIBERR   PIC X.					       R
   685		  05 EIBERRCD PIC X(4). 				       R
   686		  05 EIBSYNRB PIC X.					       R
   687		  05 EIBNODAT PIC X.					       R
   688		  05 EIBRESP  PIC S9(8) COMP-4. 			       R
   689		  05 EIBRESP2 PIC S9(8) COMP-4. 			       R
   690		  05 EIBRLDBK PIC X.					       R
   691		  05 EIBCARESERVED PIC X(32).				       R
   693	      01  DFHCOMMAREA				PIC X(20).
   694	     *
   695	      PROCEDURE DIVISION					       R
   697		  USING DFHEIBLK DFHCOMMAREA.				       R
   722	      000-PROCESS-MENU.
   723	     *
   724            IF EIBTRNID = 'SM00' OR 'SM01' OR 'SM02' OR 'SM03' OR 'SM04'
   725                          OR 'SM05' OR 'SM06' OR 'UA01'
   726		      MOVE LOW-VALUES TO SW00MO
   727		      PERFORM 400-SEARCH-USER
   728		  ELSE
   730		      EXEC CICS SEND TEXT
   731			  FROM (WS-INVALID)
   732			  LENGTH (15)
   733			  ERASE
   734		      END-EXEC
   764		  END-IF
   765
   766		  EVALUATE TRUE
   767		      WHEN EIBCALEN = +0
   768			  MOVE LOW-VALUES TO WS-CHOICE-PH
   769                    MOVE 'ENTER OPTION AND PRESS ENTER' TO ERRMSGO
   770			  PERFORM 100-SEND-MAP
   771		      WHEN EIBAID = DFHPF3
   773			  EXEC CICS SEND TEXT
   774			      FROM (WS-END)
   775			      LENGTH (15)
   776			      ERASE
   777			  END-EXEC
   807		      WHEN EIBAID = DFHENTER
   808			  PERFORM 300-PROCESS-TRAN
   809		      WHEN OTHER
   811			  EXEC CICS SEND TEXT
   812			      ERASE
   813			      FROM (WS-INVKEY)
   814			      LENGTH (22)
   815			  END-EXEC
   845		  END-EVALUATE
   847		  EXEC CICS   848		      RETURN
   849                    TRANSID('SM00')
   850			  COMMAREA(WS-COMMAREA)
   851		      END-EXEC.
   876	      000-EXIT.
   877		  EXIT.
   878
   879
   880	      100-SEND-MAP.
   881		  MOVE EIBDATE TO WS-DATE.
   882		  MOVE WS-DATE-X TO DATEO.
   884		  EXEC CICS ASKTIME
   885			  ABSTIME      (WS-TIME)
   886		      END-EXEC
   905		      EXEC CICS FORMATTIME
   906			  ABSTIME      (WS-TIME)
   907                    DATESEP      ('-')
   908			  MMDDYY   (DATEO)
   909		      TIME     (TIMEO)
   910                TIMESEP  (':')
   911		  END-EXEC
   951		  MOVE DFHBMASB TO TIMEA
   952		  MOVE DFHBMASB TO DATEA
   953		  MOVE DFHUNIMD TO OPTIONA
   955		  EXEC CICS
   956                SEND MAP('SW00M')
   957                     MAPSET('SW00S')
   958			   FROM(SW00MO)
   959			   ERASE
   960		  END-EXEC.
   997	      100-EXIT.
   998		  EXIT.
   999
  1000	      300-PROCESS-TRAN.
  1002		  EXEC CICS
  1003               RECEIVE MAP('SW00M')
  1004                       MAPSET('SW00S')
  1005			     INTO (SW00MI)
  1006		  END-EXEC
  1039		  MOVE 1 TO WS-INDEX
  1040		  PERFORM 400-SEARCH-USER
  1041		  EVALUATE TRUE
  1042		      WHEN OPTIONL = 0 OR OPTIONI = SPACE
  1043                    MOVE 'OPTION IS REQUIRED' TO ERRMSGO
  1044			  MOVE DFHBMBRY TO OPTIONA
  1045		      WHEN OPTIONI = 1
  1046                    IF WS-CHC1 = '- USER MAINTENANCE'
  1047			      PERFORM 700-TRANSFER-PROG
  1048			      IF EIBCALEN = +0
  1050				  EXEC CICS XCTL
  1051                                PROGRAM('UA001P')
  1052				  END-EXEC
  1071			      ELSE
  1073				  EXEC CICS XCTL
  1074                                PROGRAM('UA001P')
  1075				      COMMAREA(WS-COMMAREA)
  1076				  END-EXEC
  1100			      END-IF
  1101			  END-IF
  1102                    IF WS-CHC1 = '- SEARCH TICKET'  1103			      PERFORM 700-TRANSFER-PROG
  1104			      IF EIBCALEN = +0
  1106				  EXEC CICS XCTL
  1107                                PROGRAM('SM001')
  1108				  END-EXEC
  1127			      ELSE
  1129				  EXEC CICS XCTL
  1130                                PROGRAM('SM001')
  1131				      COMMAREA(WS-COMMAREA)
  1132				  END-EXEC
  1156			      END-IF
  1157			  END-IF
  1158		      WHEN OPTIONI = 2
  1159                    IF WS-CHC2 = '- ADD TICKET'
  1160			      PERFORM 700-TRANSFER-PROG
  1161			      IF EIBCALEN = +0
  1163				  EXEC CICS XCTL
  1164                                PROGRAM('SM02P')
  1165				  END-EXEC
  1184			      ELSE
  1186				  EXEC CICS XCTL
  1187                                PROGRAM('SM02P')
  1188				      COMMAREA(WS-COMMAREA)
  1189				  END-EXEC
  1213			      END-IF
  1214			  END-IF
  1215                    IF WS-CHC2 = '- UPDATE TICKET'
  1216			      PERFORM 700-TRANSFER-PROG
  1217			      IF EIBCALEN = +0
  1219				  EXEC CICS XCTL
  1220                                PROGRAM('SM003')
  1221				  END-EXEC
  1240			      ELSE
  1242				  EXEC CICS XCTL
  1243                                PROGRAM('SM003')
  1244				      COMMAREA(WS-COMMAREA)
  1245				  END-EXEC
  1269			      END-IF
  1270			  END-IF
  1271                    IF WS-CHC2 = '- APPROVE TICKET'
  1272			      PERFORM 700-TRANSFER-PROG
  1273			      IF EIBCALEN = +0
  1275				  EXEC CICS XCTL
  1276                                PROGRAM('SM005')
  1277				  END-EXEC
  1296			      ELSE
  1298				  EXEC CICS XCTL
  1299                                PROGRAM('SM005')
  1300				      COMMAREA(WS-COMMAREA)
  1301				  END-EXEC
  1325			      END-IF
  1326			  END-IF
  1327			  IF WS-CHC2 = LOW-VALUES
  1328                        MOVE 'INVALID OPTION' TO ERRMSGO
  1329			      PERFORM 100-SEND-MAP
  1330			  END-IF
  1331		      WHEN OPTIONI = 3
  1332                    IF WS-CHC3 = '- USER MAINTENANCE'
  1333			      PERFORM 700-TRANSFER-PROG
  1334			      IF EIBCALEN = +0  1336				  EXEC CICS XCTL
  1337                                PROGRAM('UA001P')
  1338				  END-EXEC
  1357			      ELSE
  1359				  EXEC CICS XCTL
  1360                                PROGRAM('UA001P')
  1361				      COMMAREA(WS-COMMAREA)
  1362				  END-EXEC
  1386			      END-IF
  1387			  END-IF
  1388                    IF WS-CHC3 = '- APPROVE TICKET'
  1389			      PERFORM 700-TRANSFER-PROG
  1390			      IF EIBCALEN = +0
  1392				  EXEC CICS XCTL
  1393                                PROGRAM('SM005')
  1394				  END-EXEC
  1413			      ELSE
  1415				  EXEC CICS XCTL
  1416                                PROGRAM('SM005')
  1417				      COMMAREA(WS-COMMAREA)
  1418				  END-EXEC
  1442			      END-IF
  1443			  END-IF
  1444                    IF WS-CHC3 = '- UPDATE TICKET'
  1445			      PERFORM 700-TRANSFER-PROG
  1446			      IF EIBCALEN = +0
  1448				  EXEC CICS XCTL
  1449                                PROGRAM('SM003')
  1450				  END-EXEC
  1469			      ELSE
  1471				  EXEC CICS XCTL
  1472                                PROGRAM('SM003')
  1473				      COMMAREA(WS-COMMAREA)
  1474				  END-EXEC
  1498			      END-IF
  1499			  END-IF
  1500			  IF WS-CHC3 = LOW-VALUES
  1501                        MOVE 'INVALID OPTION' TO ERRMSGO
  1502			      PERFORM 100-SEND-MAP
  1503			  END-IF
  1504		      WHEN OPTIONI = 4
  1505                    IF WS-CHC4 = '- USER MAINTENANCE'
  1506			      PERFORM 700-TRANSFER-PROG
  1507			      IF EIBCALEN = +0
  1509				  EXEC CICS XCTL
  1510                                PROGRAM('UA001P')
  1511				  END-EXEC
  1530			      ELSE
  1532				  EXEC CICS XCTL
  1533                                PROGRAM('UA001P')
  1534				      COMMAREA(WS-COMMAREA)
  1535				  END-EXEC
  1559			      END-IF
  1560			  END-IF
  1561                    IF WS-CHC4 = '- CLOSE TICKET'
  1562			      PERFORM 700-TRANSFER-PROG
  1563			      IF EIBCALEN = +0
  1565				  EXEC CICS XCTL
  1566                                PROGRAM('SM004')
  1567				  END-EXEC  1586			      ELSE
  1588				  EXEC CICS XCTL
  1589                                PROGRAM('SM004')
  1590				      COMMAREA(WS-COMMAREA)
  1591				  END-EXEC
  1615			      END-IF
  1616			  END-IF
  1617			  IF WS-CHC4 = LOW-VALUES
  1618                        MOVE 'INVALID OPTION' TO ERRMSGO
  1619			      PERFORM 100-SEND-MAP
  1620			  END-IF
  1621		      WHEN OPTIONI = 5
  1622                    IF WS-CHC5 = '- CANCEL TICKET'
  1623			      PERFORM 700-TRANSFER-PROG
  1624			      IF EIBCALEN = +0
  1626				  EXEC CICS XCTL
  1627                                PROGRAM('SM006P')
  1628				  END-EXEC
  1647			      ELSE
  1649				  EXEC CICS XCTL
  1650                                PROGRAM('SM006P')
  1651				      COMMAREA(WS-COMMAREA)
  1652				  END-EXEC
  1676			      END-IF
  1677			  END-IF
  1678			  IF WS-CHC5 = LOW-VALUES
  1679                        MOVE 'INVALID OPTION' TO ERRMSGO
  1680			      PERFORM 100-SEND-MAP
  1681			  END-IF
  1682		      WHEN OPTIONI = 6
  1683                    IF WS-CHC6 = '- APPROVE TICKET'
  1684			      PERFORM 700-TRANSFER-PROG
  1685			      IF EIBCALEN = +0
  1687				  EXEC CICS XCTL
  1688                                PROGRAM('SM005')
  1689				  END-EXEC
  1708			      ELSE
  1710				  EXEC CICS XCTL
  1711                                PROGRAM('SM005')
  1712				      COMMAREA(WS-COMMAREA)
  1713				  END-EXEC
  1737			      END-IF
  1738			  END-IF
  1739                    IF WS-CHC6 = '- USER MAINTENANCE'
  1740			      PERFORM 700-TRANSFER-PROG
  1741			      IF EIBCALEN = +0
  1743				  EXEC CICS XCTL
  1744                                PROGRAM('UA001P')
  1745				  END-EXEC
  1764			      ELSE
  1766				  EXEC CICS XCTL
  1767                                PROGRAM('UA001P')
  1768				      COMMAREA(WS-COMMAREA)
  1769				  END-EXEC
  1793			      END-IF
  1794			  END-IF
  1795			  IF WS-CHC6 = LOW-VALUES
  1796                        MOVE 'INVALID OPTION' TO ERRMSGO
  1797			      PERFORM 100-SEND-MAP
  1798			  END-IF  1799		      WHEN OPTIONI = 7
  1800                    IF WS-CHC7 = '- USER MAINTENANCE'
  1801			      PERFORM 700-TRANSFER-PROG
  1802			      IF EIBCALEN = +0
  1804				  EXEC CICS XCTL
  1805                                PROGRAM('UA001P')
  1806				  END-EXEC
  1825			      ELSE
  1827				  EXEC CICS XCTL
  1828                                PROGRAM('UA001P')
  1829				      COMMAREA(WS-COMMAREA)
  1830				  END-EXEC
  1854			      END-IF
  1855			  END-IF
  1856			  IF WS-CHC7 = LOW-VALUES
  1857                        MOVE 'INVALID OPTION' TO ERRMSGO
  1858			      PERFORM 100-SEND-MAP
  1859			  END-IF
  1860		      WHEN OPTIONI NOT = 1 OR 2 OR 3 OR 4 OR 5 OR 6 OR 7
  1861			  IF WS-CHC7 = LOW-VALUES
  1862                        MOVE 'INVALID OPTION' TO ERRMSGO
  1863			      PERFORM 100-SEND-MAP
  1864			  END-IF
  1865		  END-EVALUATE
  1866		  PERFORM 100-SEND-MAP.
  1867	      300-EXIT.
  1868		  EXIT.
  1869
  1870	      400-SEARCH-USER.
  1872		  EXEC CICS ASSIGN
  1873		      USERID(WS-USERID)
  1874		  END-EXEC
  1893		  EXEC CICS
  1894                READ FILE('UAF00001')
  1895		      INTO (WS-USER-REC)
  1896		      RIDFLD (WS-USERID)
  1897		      RESP(WS-RESPONSE-CODE)
  1898		      GTEQ
  1899		  END-EXEC
  1937            IF WS-RESPONSE-CODE NOT = +00 OR (REQUESTOR = 'N' AND
  1938                                      SERVICE-PROVIDER = 'N' AND APPROVER
  1939                                          = 'N' AND ADMINISTRATOR = 'N')
  1941		      EXEC CICS SEND TEXT
  1942			  FROM (WS-INVALID)
  1943			  LENGTH (+25)
  1944			  ERASE
  1945		      END-EXEC
  1976		      EXEC CICS RETURN END-EXEC
  1989		  END-IF
  1990            IF REQUESTOR = 'Y'
  1991                MOVE '- SEARCH TICKET' TO WS-CHOICE
  1992		      PERFORM 500-MOVE-CHOICE-VAL
  1993                MOVE '- ADD TICKET' TO WS-CHOICE
  1994		      PERFORM 500-MOVE-CHOICE-VAL
  1995                MOVE '- UPDATE TICKET' TO WS-CHOICE
  1996		      PERFORM 500-MOVE-CHOICE-VAL
  1997                MOVE '- CLOSE TICKET' TO WS-CHOICE
  1998		      PERFORM 500-MOVE-CHOICE-VAL
  1999                MOVE '- CANCEL TICKET' TO WS-CHOICE
  2000		      PERFORM 500-MOVE-CHOICE-VAL  2001		  END-IF
  2002            IF SERVICE-PROVIDER = 'Y'
  2003                IF NOT REQUESTOR = 'Y'
  2004                    MOVE '- SEARCH TICKET' TO WS-CHOICE
  2005			  PERFORM 500-MOVE-CHOICE-VAL
  2006                    MOVE '- UPDATE TICKET' TO WS-CHOICE
  2007			  PERFORM 500-MOVE-CHOICE-VAL
  2008		      ELSE
  2009			  CONTINUE
  2010		      END-IF
  2011		  END-IF
  2012            IF APPROVER = 'Y'
  2013                IF NOT (REQUESTOR = 'Y' OR SERVICE-PROVIDER = 'Y')
  2014                    MOVE '- SEARCH TICKET' TO WS-CHOICE
  2015			  PERFORM 500-MOVE-CHOICE-VAL
  2016		      ELSE
  2017                    MOVE '- APPROVE TICKET' TO WS-CHOICE
  2018			  PERFORM 500-MOVE-CHOICE-VAL
  2019		      END-IF
  2020		  END-IF
  2021            IF ADMINISTRATOR = 'Y'
  2022                MOVE '- USER MAINTENANCE' TO WS-CHOICE
  2023		      PERFORM 500-MOVE-CHOICE-VAL
  2024		  END-IF.
  2025	      400-EXIT.
  2026		  EXIT.
  2027
  2028	      500-MOVE-CHOICE-VAL.
  2029		  EVALUATE TRUE
  2030		      WHEN OPTCHC1O = LOW-VALUES
  2031			  MOVE WS-INDEX TO OPTNO1O
  2032			  MOVE WS-CHOICE TO OPTCHC1O
  2033			  MOVE WS-CHOICE TO WS-CHC1
  2034			  ADD 1 TO WS-INDEX
  2035		      WHEN OPTCHC2O = LOW-VALUES
  2036			  MOVE WS-INDEX TO OPTNO2O
  2037			  MOVE WS-CHOICE TO OPTCHC2O
  2038			  MOVE WS-CHOICE TO WS-CHC2
  2039			  ADD 1 TO WS-INDEX
  2040		      WHEN OPTCHC3O = LOW-VALUES
  2041			  MOVE WS-INDEX TO OPTNO3O
  2042			  MOVE WS-CHOICE TO OPTCHC3O
  2043			  MOVE WS-CHOICE TO WS-CHC3
  2044			  ADD 1 TO WS-INDEX
  2045		      WHEN OPTCHC4O = LOW-VALUES
  2046			  MOVE WS-INDEX TO OPTNO4O
  2047			  MOVE WS-CHOICE TO OPTCHC4O
  2048			  MOVE WS-CHOICE TO WS-CHC4
  2049			  ADD 1 TO WS-INDEX
  2050		      WHEN OPTCHC5O = LOW-VALUES
  2051			  MOVE WS-INDEX TO OPTNO5O
  2052			  MOVE WS-CHOICE TO OPTCHC5O
  2053			  MOVE WS-CHOICE TO WS-CHC5
  2054			  ADD 1 TO WS-INDEX
  2055		      WHEN OPTCHC6O = LOW-VALUES
  2056			  MOVE WS-INDEX TO OPTNO6O
  2057			  MOVE WS-CHOICE TO OPTCHC6O
  2058			  MOVE WS-CHOICE TO WS-CHC6
  2059			  ADD 1 TO WS-INDEX
  2060		      WHEN OPTCHC7O = LOW-VALUES  2061			  MOVE WS-INDEX TO OPTNO7O
  2062			  MOVE WS-CHOICE TO OPTCHC7O
  2063			  MOVE WS-CHOICE TO WS-CHC7
  2064			  ADD 1 TO WS-INDEX
  2065		  END-EVALUATE.
  2066	      500-EXIT.
  2067		  EXIT.
  2068
  2069	      600-VALIDATE-TICKET.
  2071		  EXEC CICS
  2072                READ FILE('STF00001')
  2073		      INTO (WS-TIX-REC)
  2074		      RIDFLD (WS-TICKET-NUM)
  2075		      RESP(WS-RESPONSE-CODE)
  2076		      GTEQ
  2077		  END-EXEC
  2116		  IF EIBRESP = DFHRESP(NOTFND)
  2118		  IF EIBRESP =	       013				       R
  2119		      MOVE WS-INVALID-TICKET TO ERRMSGO
  2120		      MOVE EIBDATE TO WS-DATE
  2121		      MOVE WS-DATE-X TO DATEO
  2123		      EXEC CICS ASKTIME
  2124			      ABSTIME  (WS-TIME)
  2125			  END-EXEC
  2144			  EXEC CICS FORMATTIME
  2145			      ABSTIME  (WS-TIME)
  2146                        DATESEP  ('-')
  2147			      MMDDYY   (DATEO)
  2148			  TIME	   (TIMEO)
  2149                    TIMESEP  (':')
  2150		      END-EXEC
  2190		      MOVE DFHBMASB TO TIMEA
  2191		      MOVE DFHBMASB TO DATEA
  2192		      MOVE DFHUNIMD TO OPTIONA
  2194		      EXEC CICS
  2195                    SEND MAP('SW00M')
  2196                         MAPSET('SW00S')
  2197			       FROM(SW00MO)
  2198			       ERASE
  2199		      END-EXEC
  2236		      EXEC CICS RETURN
  2237                    TRANSID('SM00')
  2238			  COMMAREA(WS-COMMAREA)
  2239		      END-EXEC
  2263		  ELSE
  2264		      MOVE 1 TO WS-PROG-STATE
  2265		  END-IF.
  2266	      600-EXIT.
  2267		  EXIT.
  2268
  2269	      700-TRANSFER-PROG.
  2270		  IF TIXNOI = SPACES OR TIXNOL = ZERO
  2271		      MOVE +0 TO EIBCALEN
  2272		  ELSE
  2273                MOVE 'N' TO WS-INIT
  2274		      MOVE TIXNOI TO WS-TICKET-NUM
  2275		      PERFORM 600-VALIDATE-TICKET
  2276		  END-IF.
  2277	      700-EXIT.
  2278		  EXIT.CA-Realia COBOL Version 6.0.45	 C:\CAWB30\sm000p.cic		       PAGE   19



			Realia COBOL Compiler Version Information

			      Pass 1	 Version 6.072
			      Pass 1a	 Version 6.015
			      Pass 2	 Version 6.068
			      Pass 2a	 Version 6.020
			      Pass 3	 Version 6.094
			      Pass 4	 Version 6.007
			      Pass 5	 Version 6.022


			Compilation Directives in Effect

COMP-4		  DCHK		    OPT 	      NOCALL
NOSUBCHK	  STRCHK	    NOTRUNC	      NOSMALLCOMP
NODCALL 	  NODIVZERO	    NOEPDCALL	      APOST
EBCDIC		  STATABORT	    NOMOVELINK	      NOBLL4K
ARGCHK		  UPLOW 	    NOVERARG	      MDY
LP:   60	  PP		    FCREATE	      NOIEEE
NOLILIAN	  CURRENCY-SIGN=$   WRITEAFTER	      SOSI
NOCOPY68	  NOFLAG-COM	    NOFLAG-SEG	      NOFLAG-FIPS
DEBUGXREF	  DIALECT-VS2

			Error level limit: W

			Source lines compiled:	    2289
			Compilation time (mm:ss.ss):  0:00.39
			Compilation speed (lines/minute): 52153

			Compilation date (yy/mm/dd): 23/11/22
			     Time of day (hh:mm:ss): 13:37:32