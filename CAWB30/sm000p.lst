     5	     *	CBL XOPTS(COBOL2)
    20	      IDENTIFICATION DIVISION.
    21	      PROGRAM-ID. SM000P.
    22
    23	      ENVIRONMENT DIVISION.
    24	      CONFIGURATION SECTION.
    25	      SOURCE-COMPUTER.	  IBM-PC.
    26	      OBJECT-COMPUTER.	  IBM-PC.
    27	      DATA DIVISION.
    28	      WORKING-STORAGE SECTION.
    74	      01  WS-TIME			  PIC 9(15) COMP-3.
    75	      01  WS-DATE				PIC 9(7).
    76	      01  WS-DATE-X REDEFINES WS-DATE		PIC X(7).
    77        01  WS-VALID-TIX-FLAG                     PIC X VALUE 'Y'.
    78	      01  WS-LENGTH				PIC S9(4) COMP.
    79	      01  WS-INDEX				PIC 9 VALUE 1.
    80	      01  WS-CHOICE				PIC X(21).
    81	      01  WS-CHOICE-PH.
    82		  05  WS-CHC1				PIC X(21).
    83		  05  WS-CHC2				PIC X(21).
    84		  05  WS-CHC3				PIC X(21).
    85		  05  WS-CHC4				PIC X(21).
    86		  05  WS-CHC5				PIC X(21).
    87		  05  WS-CHC6				PIC X(21).
    88		  05  WS-CHC7				PIC X(21).
    89	      01  WS-USERID				PIC X(7).
    90	      01  WS-TIXID				PIC X(6).
    91	      01  WS-RESPONSE-CODE    PIC S9(8) COMP.
    92	      01  WS-LOGID.
    93		  05  LOGID2				PIC X(6).
    94		  05  FILLER				PIC X.
    95
    96	      01  WS-END				PIC X(15) VALUE
    97            'END PROCESSING'.
    98	      01  WS-INVKEY				PIC X(21) VALUE
    99            'INVALID PFKEY PRESSED'.
   100	      01  WS-INVALID			  PIC X(14) VALUE
   101            'INVALID ACCESS'.
   102	      01  WS-INVALID-TICKET			  PIC X(28) VALUE
   103            'TICKET NUMBER DOES NOT EXIST'.
   104	      01  WS-DUP-TICKET 			  PIC X(28) VALUE
   105            'DUPLICATE TICKET NUMBER'.
   106	      01  WS-INVALID-USER			  PIC X(24) VALUE
   107            'INVALID ACCESS TO TICKET'.
   108	      01  WS-COMMAREA.
   109		  05  WS-CA-PRGNAME	      PIC X(06).
   110		  05  FILLER		      PIC X(19).
   111		  05  WS-DFHSTATE	      PIC X(15).
   112		  05  WS-TRANS		      PIC X(04).
   113		  05  WS-LUSER		      PIC 9(03).
   114		  05  WS-FUSER		      PIC 9(03).
   115		  05  WS-PAGE		      PIC 9(02).
   116		  05  WS-PAGE-END	      PIC 9(01).
   117		  05  WS-QITEM		      PIC S9(4) COMP.
   118		  05  WS-QITEM-START	      PIC S9(4) COMP.
   119		  05  WS-QITEM-END	      PIC S9(4) COMP.
   120		  05  WS-QITEM-PAGE	      PIC S9(4) COMP.
   121		  05  WS-USERID1			 PIC X(7).
   122		  05  WS-USER-REC.
   123		      10  USERID.   124			  15  USERID1			    PIC X(7).
   125			  15  FILLER			    PIC X.
   126		      10  REQUESTOR			    PIC X.
   127		      10  ADMINISTRATOR 		    PIC X.
   128		      10  APPROVER			    PIC X.
   129		      10  SERVICE-PROVIDER		    PIC X.
   130		      10  UPDATED-BY1.
   131			  15  UPDBY1			    PIC X(7).
   132			  15  FILLER			    PIC X.
   133		  05  WS-TIX-REC.
   134		      10  TIX-ID			    PIC X(06).
   135		      10  TIX-REQUESTOR 		    PIC X(08).
   136		      10  TIX-STATUS			    PIC X(10).
   137		      10  TIX-TITLE			    PIC X(25).
   138		      10  TIX-DESC			    PIC X(100).
   139		      10  TIX-DESC-RED REDEFINES TIX-DESC.
   140			  15  TIX-DESC1 		    PIC X(50).
   141			  15  TIX-DESC2 		    PIC X(50).
   142		      10  LAST-UPDATE			    PIC X(20).
   143		      10  LAST-UPDATE-RED REDEFINES LAST-UPDATE.
   144			  15  LAST-UPDATE-DATE		    PIC X(11).
   145			  15  LAST-UPDATE-TIME		    PIC X(09).
   146		      10  UPDATED-BY2.
   147			  15  UPDBY2			    PIC X(7).
   148			  15  FILLER			    PIC X.
   149		      10  LAST-UPDATE-REM		    PIC X(50).
   150		      10  LAST-UPDATE-REMW REDEFINES LAST-UPDATE-REM.
   151			  15  LAST-UPDATE-REM1		    PIC X(25).
   152			  15  LAST-UPDATE-REM2		    PIC X(25).
   153		  05  WS-USER			      PIC X(7).
   154		  05  WS-TICKET-NUM.
   155		      10  WS-TICKET-NUM1		 PIC X(6).
   156		      10  FILLER			 PIC X.
   157		  05  WS-PROG-STATE			 PIC 9(1).
   158            05  WS-INIT                            PIC X VALUE 'Y'.
   159		  05  WS-ID			       PIC X(4).
   160            05  READ1  PIC X VALUE 'N'.
   161		  05  WS-TNUM  PIC X(06).
   162		  05  WS-TCKID				 PIC X(6).
   163		  05  WS-TCKREQ 			 PIC X(8).
   164		  05  WS-TCKSTAT			 PIC X(10).
   165		  05  WS-TCKTTL 			 PIC X(25).
   166		  05  WS-TCKDESC			 PIC X(100).
   167		  05  WS-LSTUPD 			 PIC X(20).
   168		  05  WS-STUPDBY			 PIC X(8).
   169		  05  WS-LSTUPDRMK			 PIC X(50).
   170		  05  WS-REQUESTOR			 PIC X.
   171		  05  WS-ADMINISTRATOR			 PIC X.
   172		  05  WS-APPROVER			 PIC X.
   173		  05  WS-SERVICE-PROVIDER		 PIC X.
   174
   175	     *
   176		  COPY SM000S.
   178	     * SYMBOLIC MAP of sm000s Created by CACXBMS Version 6.0.27
   179	      01  SW00MI.
   180		  02  FILLER				     PIC X(12).
   181		  02  OPTCHC1L				     PIC S9(4) COMP.
   182		  02  OPTCHC1F				     PIC X.
   183		  02  FILLER REDEFINES OPTCHC1F.
   184		      03  OPTCHC1A			     PIC X.   185		  02  OPTCHC1I				     PIC X(021).
   186		  02  OPTNO1L				     PIC S9(4) COMP.
   187		  02  OPTNO1F				     PIC X.
   188		  02  FILLER REDEFINES OPTNO1F.
   189		      03  OPTNO1A			     PIC X.
   190		  02  OPTNO1I				     PIC X(001).
   191		  02  OPTCHC2L				     PIC S9(4) COMP.
   192		  02  OPTCHC2F				     PIC X.
   193		  02  FILLER REDEFINES OPTCHC2F.
   194		      03  OPTCHC2A			     PIC X.
   195		  02  OPTCHC2I				     PIC X(021).
   196		  02  OPTNO2L				     PIC S9(4) COMP.
   197		  02  OPTNO2F				     PIC X.
   198		  02  FILLER REDEFINES OPTNO2F.
   199		      03  OPTNO2A			     PIC X.
   200		  02  OPTNO2I				     PIC X(001).
   201		  02  OPTCHC3L				     PIC S9(4) COMP.
   202		  02  OPTCHC3F				     PIC X.
   203		  02  FILLER REDEFINES OPTCHC3F.
   204		      03  OPTCHC3A			     PIC X.
   205		  02  OPTCHC3I				     PIC X(021).
   206		  02  OPTNO3L				     PIC S9(4) COMP.
   207		  02  OPTNO3F				     PIC X.
   208		  02  FILLER REDEFINES OPTNO3F.
   209		      03  OPTNO3A			     PIC X.
   210		  02  OPTNO3I				     PIC X(001).
   211		  02  OPTCHC4L				     PIC S9(4) COMP.
   212		  02  OPTCHC4F				     PIC X.
   213		  02  FILLER REDEFINES OPTCHC4F.
   214		      03  OPTCHC4A			     PIC X.
   215		  02  OPTCHC4I				     PIC X(021).
   216		  02  OPTNO4L				     PIC S9(4) COMP.
   217		  02  OPTNO4F				     PIC X.
   218		  02  FILLER REDEFINES OPTNO4F.
   219		      03  OPTNO4A			     PIC X.
   220		  02  OPTNO4I				     PIC X(001).
   221		  02  OPTCHC5L				     PIC S9(4) COMP.
   222		  02  OPTCHC5F				     PIC X.
   223		  02  FILLER REDEFINES OPTCHC5F.
   224		      03  OPTCHC5A			     PIC X.
   225		  02  OPTCHC5I				     PIC X(021).
   226		  02  OPTNO5L				     PIC S9(4) COMP.
   227		  02  OPTNO5F				     PIC X.
   228		  02  FILLER REDEFINES OPTNO5F.
   229		      03  OPTNO5A			     PIC X.
   230		  02  OPTNO5I				     PIC X(001).
   231		  02  OPTCHC6L				     PIC S9(4) COMP.
   232		  02  OPTCHC6F				     PIC X.
   233		  02  FILLER REDEFINES OPTCHC6F.
   234		      03  OPTCHC6A			     PIC X.
   235		  02  OPTCHC6I				     PIC X(021).
   236		  02  OPTNO6L				     PIC S9(4) COMP.
   237		  02  OPTNO6F				     PIC X.
   238		  02  FILLER REDEFINES OPTNO6F.
   239		      03  OPTNO6A			     PIC X.
   240		  02  OPTNO6I				     PIC X(001).
   241		  02  OPTCHC7L				     PIC S9(4) COMP.
   242		  02  OPTCHC7F				     PIC X.
   243		  02  FILLER REDEFINES OPTCHC7F.
   244		      03  OPTCHC7A			     PIC X.   245		  02  OPTCHC7I				     PIC X(021).
   246		  02  OPTNO7L				     PIC S9(4) COMP.
   247		  02  OPTNO7F				     PIC X.
   248		  02  FILLER REDEFINES OPTNO7F.
   249		      03  OPTNO7A			     PIC X.
   250		  02  OPTNO7I				     PIC X(001).
   251		  02  OPTIONL				     PIC S9(4) COMP.
   252		  02  OPTIONF				     PIC X.
   253		  02  FILLER REDEFINES OPTIONF.
   254		      03  OPTIONA			     PIC X.
   255		  02  OPTIONI				     PIC X(001).
   256		  02  TIXNOL				     PIC S9(4) COMP.
   257		  02  TIXNOF				     PIC X.
   258		  02  FILLER REDEFINES TIXNOF.
   259		      03  TIXNOA			     PIC X.
   260		  02  TIXNOI				     PIC X(006).
   261		  02  ERRMSGL				     PIC S9(4) COMP.
   262		  02  ERRMSGF				     PIC X.
   263		  02  FILLER REDEFINES ERRMSGF.
   264		      03  ERRMSGA			     PIC X.
   265		  02  ERRMSGI				     PIC X(071).
   266		  02  DATEL				     PIC S9(4) COMP.
   267		  02  DATEF				     PIC X.
   268		  02  FILLER REDEFINES DATEF.
   269		      03  DATEA 			     PIC X.
   270		  02  DATEI				     PIC X(010).
   271		  02  TIMEL				     PIC S9(4) COMP.
   272		  02  TIMEF				     PIC X.
   273		  02  FILLER REDEFINES TIMEF.
   274		      03  TIMEA 			     PIC X.
   275		  02  TIMEI				     PIC X(008).
   276	      01  SW00MO REDEFINES SW00MI.
   277		  02  FILLER				     PIC X(12).
   278		  02  FILLER				     PIC XX.
   279		  02  FILLER				     PIC X.
   280		  02  OPTCHC1O				     PIC X(021).
   281		  02  FILLER				     PIC XX.
   282		  02  FILLER				     PIC X.
   283		  02  OPTNO1O				     PIC X(001).
   284		  02  FILLER				     PIC XX.
   285		  02  FILLER				     PIC X.
   286		  02  OPTCHC2O				     PIC X(021).
   287		  02  FILLER				     PIC XX.
   288		  02  FILLER				     PIC X.
   289		  02  OPTNO2O				     PIC X(001).
   290		  02  FILLER				     PIC XX.
   291		  02  FILLER				     PIC X.
   292		  02  OPTCHC3O				     PIC X(021).
   293		  02  FILLER				     PIC XX.
   294		  02  FILLER				     PIC X.
   295		  02  OPTNO3O				     PIC X(001).
   296		  02  FILLER				     PIC XX.
   297		  02  FILLER				     PIC X.
   298		  02  OPTCHC4O				     PIC X(021).
   299		  02  FILLER				     PIC XX.
   300		  02  FILLER				     PIC X.
   301		  02  OPTNO4O				     PIC X(001).
   302		  02  FILLER				     PIC XX.
   303		  02  FILLER				     PIC X.
   304		  02  OPTCHC5O				     PIC X(021).   305		  02  FILLER				     PIC XX.
   306		  02  FILLER				     PIC X.
   307		  02  OPTNO5O				     PIC X(001).
   308		  02  FILLER				     PIC XX.
   309		  02  FILLER				     PIC X.
   310		  02  OPTCHC6O				     PIC X(021).
   311		  02  FILLER				     PIC XX.
   312		  02  FILLER				     PIC X.
   313		  02  OPTNO6O				     PIC X(001).
   314		  02  FILLER				     PIC XX.
   315		  02  FILLER				     PIC X.
   316		  02  OPTCHC7O				     PIC X(021).
   317		  02  FILLER				     PIC XX.
   318		  02  FILLER				     PIC X.
   319		  02  OPTNO7O				     PIC X(001).
   320		  02  FILLER				     PIC XX.
   321		  02  FILLER				     PIC X.
   322		  02  OPTIONO				     PIC X(001).
   323		  02  FILLER				     PIC XX.
   324		  02  FILLER				     PIC X.
   325		  02  TIXNOO				     PIC X(006).
   326		  02  FILLER				     PIC XX.
   327		  02  FILLER				     PIC X.
   328		  02  ERRMSGO				     PIC X(071).
   329		  02  FILLER				     PIC XX.
   330		  02  FILLER				     PIC X.
   331		  02  DATEO				     PIC X(010).
   332		  02  FILLER				     PIC XX.
   333		  02  FILLER				     PIC X.
   334		  02  TIMEO				     PIC X(008).
   336	     *
   337		  COPY DFHAID.
   339	      01  DFHAID.
   340	     *
   341	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   342	     *
   343	     * Revision Information
   344	     * ^{File:dfhaid.cob  }
   345	     * ^{Timestamp:Thu May 15 14:02:52 1997}
   346	     * ^{Revision:2.0}
   347	     *
   348	     *This is the AID constants copy file
   349	     *
   350            05  DFHENTER                  PIC X VALUE ''''.
   351	     *					value APOST
   352            05  DFHCLEAR                  PIC X VALUE '_'.
   353            05  DFHPA1                    PIC X VALUE '%'.
   354            05  DFHPA2                    PIC X VALUE '>'.
   355            05  DFHPA3                    PIC X VALUE ','.
   356            05  DFHPF1                    PIC X VALUE '1'.
   357            05  DFHPF2                    PIC X VALUE '2'.
   358            05  DFHPF3                    PIC X VALUE '3'.
   359            05  DFHPF4                    PIC X VALUE '4'.
   360            05  DFHPF5                    PIC X VALUE '5'.
   361            05  DFHPF6                    PIC X VALUE '6'.
   362            05  DFHPF7                    PIC X VALUE '7'.
   363            05  DFHPF8                    PIC X VALUE '8'.
   364            05  DFHPF9                    PIC X VALUE '9'.
   365            05  DFHPF10                   PIC X VALUE ':'.
   366            05  DFHPF11                   PIC X VALUE '#'.   367            05  DFHPF12                   PIC X VALUE '@'.
   368            05  DFHPF13                   PIC X VALUE 'A'.
   369            05  DFHPF14                   PIC X VALUE 'B'.
   370            05  DFHPF15                   PIC X VALUE 'C'.
   371            05  DFHPF16                   PIC X VALUE 'D'.
   372            05  DFHPF17                   PIC X VALUE 'E'.
   373            05  DFHPF18                   PIC X VALUE 'F'.
   374            05  DFHPF19                   PIC X VALUE 'G'.
   375            05  DFHPF20                   PIC X VALUE 'H'.
   376            05  DFHPF21                   PIC X VALUE 'I'.
   377            05  DFHPF22                   PIC X VALUE '›'.
   378       *                                  EBCDIC Cent sign x'4A'
   379       *                                  ASCII  Cent sign x'9B'
   380            05  DFHPF23                   PIC X VALUE '.'.
   381            05  DFHPF24                   PIC X VALUE '<'.
   382            05  DFHOPID                   PIC X VALUE 'W'.
   383            05  DFHMSRE                   PIC X VALUE 'X'.
   384            05  DFHTRIG                   PIC X VALUE '"'.
   385       *                                        value QUOTE  "
   386            05  DFHPEN                    PIC X VALUE '='.
   387            05  DFHCLRP                   PIC X VALUE 'Ý'.
   388       *                                  EBCDIC x'6A'
   389       *                                  ASCII  x'DD'
   390            05  DFHSTRF                   PIC X VALUE 'h'.
   391	     *	  DFHQUIT is a CA-Realia CICS Extension
   392	     *	  It is set by using <Ctrl>+C or <Ctrl>+<Break> Keys
   393            05  DFHQUIT                   PIC X VALUE '!'.
   394		  05  DFHNULL			PIC X VALUE LOW-VALUE.
   396	     *
   397	      COPY DFHBMSCA.
   399	      01  DFHBMSCA.
   400	     *
   401	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   402	     *
   403	     * Revision Information
   404	     * ^{File:dfhbmsca.cob}
   405	     * ^{Timestamp:Tue Oct 08 15:34:54 1996}
   406	     * ^{Revision:2.0}
   407	     *
   408	     *	Note:This FILE is provided with most values as quoted literals
   409	     *	     so that the file can be used for both ASCII and EBCDIC
   410	     *	     programs
   411	     *
   412	     *	     The only exceptions are some 3270 Data Stream Orders
   413	     *	     They use different Hexadecimal values for ASCII and
   414	     *	     EBCDIC and they cannot be expressed as quoted literals
   415	     *	     as the values are <Line Feed>, <Tab>, <End of File> etc.
   416	     *	     characters in ASCII
   417	     *
   418	     *	     They have their values set up to default to the EBCDIC
   419	     *	     values.
   420	     *
   421	     *	     3270 orders are only needed for EXEC CICS SEND and RECEIVE
   422	     *	     and SEND TEXT with imbedded format orders.
   423	     *	     If you use these values in ASCII programs the values
   424	     *	     must be changed.
   425	     *
   426	     *	     An alternative is to use REPLACING to change the values.
   427	     *
   428	     *	  i.e. COPY DFHBMSCA replacing   429	     *			    ==005== BY ==009==	*> DFHPT
   430	     *			    ==021== BY ==010==	*> DFHNL
   431	     *			    ==040== BY ==021==	*> DFHSA
   432	     *			    ==041== BY ==031==	*> DFHSFE
   433	     *			    ==044== BY ==023==	*> DFHMF
   434	     *			    ==060== BY ==020==	*> DFHRA
   435	     *			    ==063== BY ==026==. *> DFHSUB
   436	     *
   437	     ******************************************************************
   438	     *BMS and Terminal Control - Order & Attributes constants	      *
   439	     ******************************************************************
   440	     *
   441	     *	  Field Attributes
   442	     *
   443            05  DFHBMASB                          PIC X VALUE '8'.
   444            05  DFHBMASF                          PIC X VALUE '1'.
   445            05  DFHBMASK                          PIC X VALUE '0'.
   446            05  DFHBMBRY                          PIC X VALUE 'H'.
   447            05  DFHBMDAR                          PIC X VALUE '<'.
   448            05  DFHBMFSE                          PIC X VALUE 'A'.
   449            05  DFHBMPRF                          PIC X VALUE '/'.
   450            05  DFHBMPRO                          PIC X VALUE '-'.
   451            05  DFHBMUNN                          PIC X VALUE '&'.
   452            05  DFHBMUNP                          PIC X VALUE ' '.
   453            05  DFHUNNUM                          PIC X VALUE 'J'.
   454	     *
   455	     *	  partially supported
   456	     *
   457            05  DFHUNNOD                          PIC X VALUE '('.
   458            05  DFHUNIMD                          PIC X VALUE 'I'.
   459            05  DFHUNINT                          PIC X VALUE 'R'.
   460            05  DFHUNNON                          PIC X VALUE '('.
   461            05  DFHPROTI                          PIC X VALUE 'Y'.
   462            05  DFHPROTN                          PIC X VALUE '%'.
   463	     *
   464	     *	  These values are additions to mainframe constants
   465	     *
   466            05  DFHBMS-ASK-DARK                   PIC X VALUE '@'.
   467            05  DFHBMS-ASK-BRY-FSET               PIC X VALUE '9'.
   468            05  DFHBMS-ASK-DAR-FSET               PIC X VALUE ''''.
   469	     *						      VALUE APOST
   470            05  DFHBMS-PRO-BRY-FSET               PIC X VALUE 'Z'.
   471            05  DFHBMS-PRO-DAR-FSET               PIC X VALUE '_'.
   472            05  DFHBMS-NUM-BRY                    PIC X VALUE 'Q'.
   473            05  DFHBMS-NUM-DAR                    PIC X VALUE '*'.
   474            05  DFHBMS-NUM-DAR-FSET               PIC X VALUE ')'.
   475	     *
   476	     *	  Field Flag values
   477		  05  DFHBMEOF-VAL VALUE 128		PIC S9(4) COMP-4.
   478		  05  FILLER REDEFINES DFHBMEOF-VAL.
   479		      10  FILLER			PIC X.
   480		      10  DFHBMEOF			PIC X.
   481       *                                          x'80'.
   482		  05  DFHBMCUR-VAL VALUE 002		PIC S9(4) COMP-4.
   483		  05  FILLER REDEFINES DFHBMCUR-VAL.
   484		      10  FILLER			PIC X.
   485		      10  DFHBMCUR			PIC X.
   486       *                                          x'02'.
   487		  05  DFHBMMEC-VAL VALUE 130		PIC S9(4) COMP-4.
   488		  05  FILLER REDEFINES DFHBMMEC-VAL.   489		      10  FILLER			PIC X.
   490		      10  DFHBMMEC			PIC X.
   491       *                                          x'82'.
   492       *                                          x'02'.
   493		  05  DFHBMFLG-VAL  VALUE 0		PIC S9(4) COMP-4.
   494		      88  DFHERASE			VALUES 128 130.
   495       *                                          x'80' X'82'
   496		      88  DFHCURSR			VALUES 002 130.
   497       *                                          x'02' X'82'
   498		  05  FILLER REDEFINES DFHBMFLG-VAL.
   499		      10  FILLER			PIC X.
   500		      10  DFHBMFLG			PIC X.
   501
   502		  05  DFHBMDUP-VAL VALUE 028		PIC S9(4) COMP-4.
   503		  05  FILLER REDEFINES DFHBMDUP-VAL.
   504		      10  FILLER			PIC X.
   505		      10  DFHBMDUP			PIC X.
   506       *                                              x'1C'
   507	     *
   508	     ******************************************************************
   509	     *	  supported 327X Extended Attributes
   510	     *
   511	     *	  Extended COLOR Attributes
   512	     *
   513            05  DFHDFCOL                          PIC X VALUE '0'.
   514            05  DFHBLUE                           PIC X VALUE '1'.
   515            05  DFHRED                            PIC X VALUE '2'.
   516            05  DFHPINK                           PIC X VALUE '3'.
   517            05  DFHGREEN                          PIC X VALUE '4'.
   518            05  DFHTURQ                           PIC X VALUE '5'.
   519            05  DFHYELLO                          PIC X VALUE '6'.
   520            05  DFHNEUTR                          PIC X VALUE '7'.
   521	     *
   522	     *	  Extended HILIGHT Attributes
   523	     *
   524            05  DFHDFHI                           PIC X VALUE '0'.
   525            05  DFHBLINK                          PIC X VALUE '1'.
   526            05  DFHREVRS                          PIC X VALUE '2'.
   527            05  DFHUNDLN                          PIC X VALUE '4'.
   528	     *
   529	     ******************************************************************
   530	     *	  supported 327X Data Stream Orders
   531	     *
   532		  05  DFHSBA-VAL VALUE 017		 PIC S9(4) COMP-4.
   533		  05  FILLER REDEFINES DFHSBA-VAL.
   534		      10  FILLER			PIC X.
   535		      10  DFHSBA			PIC X.
   536       *                                              x'11'
   537		  05  DFHEUA-VAL VALUE 018		PIC S9(4) COMP-4.
   538		  05  FILLER REDEFINES DFHEUA-VAL.
   539		      10  FILLER			PIC X.
   540		      10  DFHEUA			PIC X.
   541       *                                              x'12'
   542		  05  DFHIC-VAL VALUE 019		PIC S9(4) COMP-4.
   543		  05  FILLER REDEFINES DFHIC-VAL.
   544		      10  FILLER			PIC X.
   545		      10  DFHIC 			PIC X.
   546       *                                              X'13'.
   547		  05  DFHSF-VAL VALUE 029		PIC S9(4) COMP-4.
   548		  05  FILLER REDEFINES DFHSF-VAL.   549		      10  FILLER			PIC X.
   550		      10  DFHSF 			PIC X.
   551       *                                              X'1D'.
   552		  05  DFHPT-VAL VALUE 005		PIC S9(4) COMP-4.
   553		      88 DFHPT-VAL-EBCDIC		VALUE 5.
   554		      88 DFHPT-VAL-ASCII		VALUE 9.
   555		  05  FILLER REDEFINES DFHPT-VAL.
   556		      10  FILLER			PIC X.
   557		      10  DFHPT 			PIC X.
   558       *                                              EBCDIC X'05'.
   559       *                                              ASCII  X'09'.
   560		  05  DFHRA-VAL VALUE 060		PIC S9(4) COMP-4.
   561		      88 DFHRA-VAL-EBCDIC		VALUE 60.
   562		      88 DFHRA-VAL-ASCII		VALUE 20.
   563		  05  FILLER REDEFINES DFHRA-VAL.
   564		      10  FILLER			PIC X.
   565		      10  DFHRA 			PIC X.
   566       *                                              EBCDIC x'3C'
   567       *                                              ASCII  x'14'
   568		  05  DFHSFE-VAL VALUE 041		PIC S9(4) COMP-4.
   569		      88 DFHSFE-VAL-EBCDIC		VALUE 41.
   570		      88 DFHSFE-VAL-ASCII		VALUE 31.
   571		  05  FILLER REDEFINES DFHSFE-VAL.
   572		      10  FILLER			PIC X.
   573		      10  DFHSFE			PIC X.
   574       *                                              EBCDIC x'29'
   575       *                                              ASCII  x'1F'
   576		  05  DFHMF-VAL VALUE 044		PIC S9(4) COMP-4.
   577		      88 DFHMF-VAL-EBCDIC		VALUE 44.
   578		      88 DFHMF-VAL-ASCII		VALUE 23.
   579		  05  FILLER REDEFINES DFHMF-VAL.
   580		      10  FILLER			PIC X.
   581		      10  DFHMF 			PIC X.
   582       *                                              EBCDIC x'2C'
   583       *                                              ASCII  x'17'
   584	     *
   585	     ******************************************************************
   586	     *	  unsupported 327X Data Stream order codes
   587	     *
   588		  05  DFHSA-VAL VALUE 040		PIC S9(4) COMP-4.
   589		      88 DFHSA-VAL-EBCDIC		VALUE 40.
   590		      88 DFHSA-VAL-ASCII		VALUE 21.
   591		  05  FILLER REDEFINES DFHSA-VAL.
   592		      10  FILLER			PIC X.
   593		      10  DFHSA 			PIC X.
   594       *                                              EBCDIC x'28'
   595       *                                              ASCII  x'15'
   596		  05  DFHGE-VAL VALUE 008		PIC S9(4) COMP-4.
   597		  05  FILLER REDEFINES DFHGE-VAL.
   598		      10  FILLER			PIC X.
   599		      10  DFHGE 			PIC X.
   600       *                                              X'08'.
   601	     *
   602	     ******************************************************************
   603	     *	  SFE and MF supported attribute types
   604	     *
   605            05  DFHCOLOR                          PIC X VALUE 'ƒ'.
   606       *                                              EBCDIC x'42'
   607       *                                              ASCII  x'83'
   608            05  DFHHLT                            PIC X VALUE 'Ö'.   609       *                                              EBCDIC x'41'
   610       *                                              ASCII  x'D6'
   611            05  DFH3270                           PIC X VALUE '{'.
   612	     *
   613	     *	  supported for SEND TEXT command and printer terminal
   614	     *
   615		  05  DFHBMPNL-VAL VALUE 021		PIC S9(4) COMP-4.
   616		      88 DFHBMPNL-VAL-EBCDIC		VALUE 21.
   617		      88 DFHBMPNL-VAL-ASCII		VALUE 10.
   618		  05  FILLER REDEFINES DFHBMPNL-VAL.
   619		      10  FILLER			PIC X.
   620		      10  DFHBMPNL			PIC X.
   621       *                                              EBCDIC X'15'.
   622       *                                              ASCII  X'0A'.
   623	     *
   624	     ******************************************************************
   625	     *	  Printer terminal data stream only
   626	     *
   627		  05  DFHBMPFF-VAL VALUE 012		PIC S9(4) COMP-4.
   628		  05  FILLER REDEFINES DFHBMPFF-VAL.
   629		      10  FILLER			PIC X.
   630		      10  DFHBMPFF			PIC X.
   631       *                                              X'0C'.
   632		  05  DFHBMPCR-VAL VALUE 013		PIC S9(4) COMP-4.
   633		  05  FILLER REDEFINES DFHBMPCR-VAL.
   634		      10  FILLER			PIC X.
   635		      10  DFHBMPCR			PIC X.
   636       *                                              X'0D'.
   637		  05  DFHBMPEM-VAL VALUE 025		PIC S9(4) COMP-4.
   638		  05  FILLER REDEFINES DFHBMPEM-VAL.
   639		      10  FILLER			PIC X.
   640		      10  DFHBMPEM			PIC X.
   641       *                                              X'19'.
   642	     *
   643	     ******************************************************************
   644	     *	  unsupported Miscellaneous attributes and constants
   645	     *
   646		  05  DFHALL				PIC X VALUE LOW-VALUES.
   647            05  DFHBASE                           PIC X VALUE '0'.
   648		  05  DFHBMDET				PIC X VALUE LOW-VALUES.
   649		  05  DFHBMPSOSI-VAL VALUE 3599 	PIC S9(4) COMP-4.
   650		  05  FILLER REDEFINES DFHBMPSOSI-VAL.
   651		      10  DFHBMPSO			PIC X.
   652       *                                              X'0E'.
   653		      10  DFHBMPSI			PIC X.
   654       *                                              X'0F'.
   655		  05  DFHDFT VALUE HIGH-VALUES		PIC X.
   656            05  DFHERROR                          PIC X VALUE '¶'.
   657       *                                              EBCDIC X'1A'.
   658       *                                              ASCII  X'B6'.
   659            05  DFHFIL                            PIC X VALUE '4'.
   660            05  DFHMENT                           PIC X VALUE '2'.
   661            05  DFHMET                            PIC X VALUE '3'.
   662            05  DFHMFE                            PIC X VALUE '6'.
   663            05  DFHMFET                           PIC X VALUE '7'.
   664            05  DFHMFT                            PIC X VALUE '5'.
   665            05  DFHMT                             PIC X VALUE '1'.
   666            05  DFHOUTLN                          PIC X VALUE 'B'.
   667            05  DFHPS                             PIC X VALUE '„'.
   668       *                                              EBCDIC x'43'   669       *                                              ASCII  x'84'
   670            05  DFHVAL                            PIC X VALUE 'A'.
   671	     *
   672		  05  DFHSUB-VAL   VALUE 063		PIC S9(4) COMP-4.
   673		      88 DFHSUB-VAL-EBCDIC		VALUE 63.
   674		      88 DFHSUB-VAL-ASCII		VALUE 26.
   675		  05  FILLER REDEFINES DFHSUB-VAL.
   676		      10  FILLER			PIC X.
   677		      10  DFHSUB			PIC X.
   678       *                                              EBCDIC X'3F'.
   679       *                                              ASCII  X'1A'.
   680	     *
   681		  05  DFHFM-VAL    VALUE 030		PIC S9(4) COMP-4.
   682		  05  FILLER REDEFINES DFHFM-VAL.
   683		      10  FILLER			PIC X.
   684		      10  DFHFM 			PIC X.
   685       *                                              EBCDIC X'1E'.
   686		  05  DFHEO VALUE HIGH-VALUE		PIC X.
   688
   689	      LINKAGE SECTION.
   691	      01  DFHEIBLK.						       R
   692		  05 EIBTIME  PIC S9(7) COMP-3. 			       R
   693		  05 EIBDATE  PIC S9(7) COMP-3. 			       R
   694		  05 EIBTRNID PIC X(4). 				       R
   695		  05 EIBTASKN PIC S9(7) COMP-3. 			       R
   696		  05 EIBTRMID PIC X(4). 				       R
   697		  05 DFHEIGDI PIC S9(4) COMP-4. 			       R
   698		  05 EIBCPOSN PIC S9(4) COMP-4. 			       R
   699		  05 EIBCALEN PIC S9(4) COMP-4. 			       R
   700		  05 EIBAID   PIC X.					       R
   701		  05 EIBFN    PIC X(2). 				       R
   702		  05 EIBRCODE PIC X(6). 				       R
   703		  05 EIBDS    PIC X(8). 				       R
   704		  05 EIBREQID PIC X(8). 				       R
   705		  05 EIBRSRCE PIC X(8). 				       R
   706		  05 EIBSYNC  PIC X.					       R
   707		  05 EIBFREE  PIC X.					       R
   708		  05 EIBRECV  PIC X.					       R
   709		  05 EIBSEND  PIC X.					       R
   710		  05 EIBATT   PIC X.					       R
   711		  05 EIBEOC   PIC X.					       R
   712		  05 EIBFMH   PIC X.					       R
   713		  05 EIBCOMPL PIC X.					       R
   714		  05 EIBSIG   PIC X.					       R
   715		  05 EIBCONF  PIC X.					       R
   716		  05 EIBERR   PIC X.					       R
   717		  05 EIBERRCD PIC X(4). 				       R
   718		  05 EIBSYNRB PIC X.					       R
   719		  05 EIBNODAT PIC X.					       R
   720		  05 EIBRESP  PIC S9(8) COMP-4. 			       R
   721		  05 EIBRESP2 PIC S9(8) COMP-4. 			       R
   722		  05 EIBRLDBK PIC X.					       R
   723		  05 EIBCARESERVED PIC X(32).				       R
   725	      01  DFHCOMMAREA				PIC X(247).
   726	     *
   727	      PROCEDURE DIVISION					       R
   729		  USING DFHEIBLK DFHCOMMAREA.				       R
   754	      000-PROCESS-MENU.
   755	     *
   756            IF EIBTRNID = 'SM00' OR 'SM01' OR 'SM02' OR 'SM03' OR 'SM04'   757                          OR 'SM05' OR 'SM06' OR 'UA01'
   758		      MOVE LOW-VALUES TO SW00MO
   759		      PERFORM 400-SEARCH-USER
   760		  ELSE
   762		      EXEC CICS SEND TEXT
   763			  FROM (WS-INVALID)
   764			  LENGTH (15)
   765			  ERASE
   766		      END-EXEC
   796		  END-IF
   797
   798		  EVALUATE TRUE
   799		      WHEN EIBCALEN = +0
   800			  MOVE LOW-VALUES TO WS-CHOICE-PH
   801                    MOVE 'ENTER OPTION AND PRESS ENTER' TO ERRMSGO
   802			  PERFORM 100-SEND-MAP
   803		      WHEN EIBAID = DFHPF3
   805			  EXEC CICS SEND TEXT
   806			      FROM (WS-END)
   807			      LENGTH (15)
   808			      ERASE
   809			  END-EXEC
   840			  EXEC CICS RETURN END-EXEC
   853		      WHEN EIBAID = DFHENTER
   854			  PERFORM 300-PROCESS-TRAN
   855		      WHEN OTHER
   857			  EXEC CICS SEND TEXT
   858			      ERASE
   859			      FROM (WS-INVKEY)
   860			      LENGTH (22)
   861			  END-EXEC
   891		  END-EVALUATE
   893		  EXEC CICS
   894		      RETURN
   895                    TRANSID('SM00')
   896			  COMMAREA(WS-COMMAREA)
   897		      END-EXEC.
   922	      000-EXIT.
   923		  EXIT.
   924
   925
   926	      100-SEND-MAP.
   927		  MOVE EIBDATE TO WS-DATE.
   928		  MOVE WS-DATE-X TO DATEO.
   930		  EXEC CICS ASKTIME
   931			  ABSTIME      (WS-TIME)
   932		      END-EXEC
   951		      EXEC CICS FORMATTIME
   952			  ABSTIME      (WS-TIME)
   953                    DATESEP      ('-')
   954			  MMDDYY   (DATEO)
   955		      TIME     (TIMEO)
   956                TIMESEP  (':')
   957		  END-EXEC
   997		  MOVE DFHBMASB TO TIMEA
   998		  MOVE DFHBMASB TO DATEA
   999		  MOVE DFHUNIMD TO OPTIONA
  1001		  EXEC CICS
  1002                SEND MAP('SW00M')
  1003                     MAPSET('SW00S')  1004			   FROM(SW00MO)
  1005			   ERASE
  1006		  END-EXEC.
  1043	      100-EXIT.
  1044		  EXIT.
  1045
  1046	      300-PROCESS-TRAN.
  1048		  EXEC CICS
  1049               RECEIVE MAP('SW00M')
  1050                       MAPSET('SW00S')
  1051			     INTO (SW00MI)
  1052		  END-EXEC
  1085		  EVALUATE TRUE
  1086		      WHEN OPTIONL = 0 OR OPTIONI = SPACE
  1087                    MOVE 'OPTION IS REQUIRED' TO ERRMSGO
  1088			  MOVE DFHBMBRY TO OPTIONA
  1089		      WHEN OPTIONI = 1
  1090                    IF WS-CHC1 = '- USER MAINTENANCE'
  1091			      PERFORM 700-TRANSFER-PROG
  1092			      IF EIBCALEN = +0
  1094				  EXEC CICS XCTL
  1095                                PROGRAM('UA001P')
  1096				  END-EXEC
  1115			      ELSE
  1117				  EXEC CICS XCTL
  1118                                PROGRAM('UA001P')
  1119				      COMMAREA(WS-COMMAREA)
  1120				  END-EXEC
  1144			      END-IF
  1145			  END-IF
  1146                    IF WS-CHC1 = '- SEARCH TICKET'
  1147			      PERFORM 700-TRANSFER-PROG
  1148			      IF WS-TICKET-NUM1 NOT = SPACES OR
  1149				  WS-TICKET-NUM1 NOT = LOW-VALUES
  1150				  PERFORM 800-NEED-TIX
  1151			      END-IF
  1152			      IF EIBCALEN = +0
  1154				  EXEC CICS XCTL
  1155                                PROGRAM('SM001')
  1156				  END-EXEC
  1175			      ELSE
  1177				  EXEC CICS XCTL
  1178                                PROGRAM('SM001')
  1179				      COMMAREA(WS-COMMAREA)
  1180				  END-EXEC
  1204			      END-IF
  1205			  END-IF
  1206		      WHEN OPTIONI = 2
  1207                    IF WS-CHC2 = '- ADD TICKET'
  1208			      PERFORM 700-TRANSFER-PROG
  1209			      IF WS-TICKET-NUM1 = SPACES OR
  1210				  WS-TICKET-NUM1 = LOW-VALUES
  1211				  PERFORM 900-NO-TIX
  1212			      END-IF
  1213			      IF EIBCALEN = +0
  1214
  1216				  EXEC CICS XCTL
  1217                                PROGRAM('SM02P')
  1218				      COMMAREA(WS-COMMAREA)
  1219				  END-EXEC  1243			      ELSE
  1245				  EXEC CICS XCTL
  1246                                PROGRAM('SM02P')
  1247				      COMMAREA(WS-COMMAREA)
  1248				  END-EXEC
  1272			      END-IF
  1273			  END-IF
  1274                    IF WS-CHC2 = '- UPDATE TICKET'
  1275			      PERFORM 700-TRANSFER-PROG
  1276			      IF WS-TICKET-NUM1 NOT = SPACES OR
  1277				  WS-TICKET-NUM1 NOT = LOW-VALUES
  1278				  PERFORM 900-NO-TIX
  1279			      END-IF
  1280			      IF EIBCALEN = +0
  1282				  EXEC CICS XCTL
  1283                                PROGRAM('SM03P')
  1284				  END-EXEC
  1303			      ELSE
  1305				  EXEC CICS XCTL
  1306                                PROGRAM('SM03P')
  1307				      COMMAREA(WS-COMMAREA)
  1308				  END-EXEC
  1332			      END-IF
  1333			  END-IF
  1334                    IF WS-CHC2 = '- APPROVE TICKET'
  1335			      IF WS-TICKET-NUM1 NOT = SPACES OR
  1336				  WS-TICKET-NUM1 NOT = LOW-VALUES
  1337				  PERFORM 700-TRANSFER-PROG
  1338			      END-IF
  1339			      PERFORM 800-NEED-TIX
  1340			      IF EIBCALEN = +0
  1342				  EXEC CICS XCTL
  1343                                PROGRAM('SM005')
  1344				  END-EXEC
  1363			      ELSE
  1365				  EXEC CICS XCTL
  1366                                PROGRAM('SM005')
  1367				      COMMAREA(WS-COMMAREA)
  1368				  END-EXEC
  1392			      END-IF
  1393			  END-IF
  1394			  IF WS-CHC2 = LOW-VALUES
  1395                        MOVE 'INVALID OPTION' TO ERRMSGO
  1396			      PERFORM 100-SEND-MAP
  1397			  END-IF
  1398		      WHEN OPTIONI = 3
  1399                    IF WS-CHC3 = '- USER MAINTENANCE'
  1400			      PERFORM 700-TRANSFER-PROG
  1401			      IF EIBCALEN = +0
  1403				  EXEC CICS XCTL
  1404                                PROGRAM('UA001P')
  1405				  END-EXEC
  1424			      ELSE
  1426				  EXEC CICS XCTL
  1427                                PROGRAM('UA001P')
  1428				      COMMAREA(WS-COMMAREA)
  1429				  END-EXEC
  1453			      END-IF
  1454			  END-IF
  1455                    IF WS-CHC3 = '- APPROVE TICKET'  1456			      PERFORM 700-TRANSFER-PROG
  1457			      IF WS-TICKET-NUM1 NOT = SPACES OR
  1458				  WS-TICKET-NUM1 NOT = LOW-VALUES
  1459				  PERFORM 800-NEED-TIX
  1460			      END-IF
  1461			      IF EIBCALEN = +0
  1463				  EXEC CICS XCTL
  1464                                PROGRAM('SM005')
  1465				  END-EXEC
  1484			      ELSE
  1486				  EXEC CICS XCTL
  1487                                PROGRAM('SM005')
  1488				      COMMAREA(WS-COMMAREA)
  1489				  END-EXEC
  1513			      END-IF
  1514			  END-IF
  1515                    IF WS-CHC3 = '- UPDATE TICKET'
  1516			      PERFORM 700-TRANSFER-PROG
  1517			      IF WS-TICKET-NUM1 NOT = SPACES OR
  1518				  WS-TICKET-NUM1 NOT = LOW-VALUES
  1519				  PERFORM 800-NEED-TIX
  1520			      END-IF
  1521			      IF EIBCALEN = +0
  1523				  EXEC CICS XCTL
  1524                                PROGRAM('SM03P')
  1525				      COMMAREA(WS-COMMAREA)
  1526				  END-EXEC
  1550			      ELSE
  1552				  EXEC CICS XCTL
  1553                                PROGRAM('SM03P')
  1554				      COMMAREA(WS-COMMAREA)
  1555				  END-EXEC
  1579			      END-IF
  1580			  END-IF
  1581			  IF WS-CHC3 = LOW-VALUES
  1582                        MOVE 'INVALID OPTION' TO ERRMSGO
  1583			      PERFORM 100-SEND-MAP
  1584			  END-IF
  1585		      WHEN OPTIONI = 4
  1586                    IF WS-CHC4 = '- USER MAINTENANCE'
  1587			      PERFORM 700-TRANSFER-PROG
  1588			      IF EIBCALEN = +0
  1590				  EXEC CICS XCTL
  1591                                PROGRAM('UA001P')
  1592				  END-EXEC
  1611			      ELSE
  1613				  EXEC CICS XCTL
  1614                                PROGRAM('UA001P')
  1615				      COMMAREA(WS-COMMAREA)
  1616				  END-EXEC
  1640			      END-IF
  1641			  END-IF
  1642                    IF WS-CHC4 = '- CLOSE TICKET'
  1643			      PERFORM 700-TRANSFER-PROG
  1644			      IF WS-TICKET-NUM1 NOT = SPACES OR
  1645				  WS-TICKET-NUM1 NOT = LOW-VALUES
  1646				  PERFORM 800-NEED-TIX
  1647			      END-IF
  1648			      IF EIBCALEN = +0
  1650				  EXEC CICS XCTL  1651                                PROGRAM('SM004')
  1652				      COMMAREA(WS-COMMAREA)
  1653				  END-EXEC
  1677			      ELSE
  1679				  EXEC CICS XCTL
  1680                                PROGRAM('SM004')
  1681				      COMMAREA(WS-COMMAREA)
  1682				  END-EXEC
  1706			      END-IF
  1707			  END-IF
  1708			  IF WS-CHC4 = LOW-VALUES
  1709                        MOVE 'INVALID OPTION' TO ERRMSGO
  1710			      PERFORM 100-SEND-MAP
  1711			  END-IF
  1712		      WHEN OPTIONI = 5
  1713                    IF WS-CHC5 = '- CANCEL TICKET'
  1714			      PERFORM 700-TRANSFER-PROG
  1715			      IF WS-TICKET-NUM1 NOT = SPACES OR
  1716				  WS-TICKET-NUM1 NOT = LOW-VALUES
  1717				  PERFORM 800-NEED-TIX
  1718			      END-IF
  1719			      IF EIBCALEN = +0
  1721				  EXEC CICS XCTL
  1722                                PROGRAM('SM006P')
  1723				  END-EXEC
  1742			      ELSE
  1744				  EXEC CICS XCTL
  1745                                PROGRAM('SM006P')
  1746				      COMMAREA(WS-COMMAREA)
  1747				  END-EXEC
  1771			      END-IF
  1772			  END-IF
  1773			  IF WS-CHC5 = LOW-VALUES
  1774                        MOVE 'INVALID OPTION' TO ERRMSGO
  1775			      PERFORM 100-SEND-MAP
  1776			  END-IF
  1777		      WHEN OPTIONI = 6
  1778                    IF WS-CHC6 = '- APPROVE TICKET'
  1779			      PERFORM 700-TRANSFER-PROG
  1780			      IF WS-TICKET-NUM1 NOT = SPACES OR
  1781				  WS-TICKET-NUM1 NOT = LOW-VALUES
  1782				  PERFORM 800-NEED-TIX
  1783			      END-IF
  1784			      IF EIBCALEN = +0
  1786				  EXEC CICS XCTL
  1787                                PROGRAM('SM005')
  1788				  END-EXEC
  1807			      ELSE
  1809				  EXEC CICS XCTL
  1810                                PROGRAM('SM005')
  1811				      COMMAREA(WS-COMMAREA)
  1812				  END-EXEC
  1836			      END-IF
  1837			  END-IF
  1838                    IF WS-CHC6 = '- USER MAINTENANCE'
  1839			      PERFORM 700-TRANSFER-PROG
  1840			      IF EIBCALEN = +0
  1842				  EXEC CICS XCTL
  1843                                PROGRAM('UA001P')
  1844				  END-EXEC  1863			      ELSE
  1865				  EXEC CICS XCTL
  1866                                PROGRAM('UA001P')
  1867				      COMMAREA(WS-COMMAREA)
  1868				  END-EXEC
  1892			      END-IF
  1893			  END-IF
  1894			  IF WS-CHC6 = LOW-VALUES
  1895                        MOVE 'INVALID OPTION' TO ERRMSGO
  1896			      PERFORM 100-SEND-MAP
  1897			  END-IF
  1898		      WHEN OPTIONI = 7
  1899                    IF WS-CHC7 = '- USER MAINTENANCE'
  1900			      PERFORM 700-TRANSFER-PROG
  1901			      IF EIBCALEN = +0
  1903				  EXEC CICS XCTL
  1904                                PROGRAM('UA001P')
  1905				  END-EXEC
  1924			      ELSE
  1926				  EXEC CICS XCTL
  1927                                PROGRAM('UA001P')
  1928				      COMMAREA(WS-COMMAREA)
  1929				  END-EXEC
  1953			      END-IF
  1954			  END-IF
  1955			  IF WS-CHC7 = LOW-VALUES
  1956                        MOVE 'INVALID OPTION' TO ERRMSGO
  1957			      PERFORM 100-SEND-MAP
  1958			  END-IF
  1959		      WHEN OPTIONI NOT = 1 OR 2 OR 3 OR 4 OR 5 OR 6 OR 7
  1960			  IF WS-CHC7 = LOW-VALUES
  1961                        MOVE 'INVALID OPTION' TO ERRMSGO
  1962			      PERFORM 100-SEND-MAP
  1963			  END-IF
  1964		  END-EVALUATE
  1965		  PERFORM 100-SEND-MAP.
  1966	      300-EXIT.
  1967		  EXIT.
  1968
  1969	      400-SEARCH-USER.
  1971		  EXEC CICS ASSIGN
  1972		      USERID(WS-USERID)
  1973		  END-EXEC
  1992		  EXEC CICS
  1993                READ FILE('UAF00001')
  1994		      INTO (WS-USER-REC)
  1995		      RIDFLD (WS-USERID)
  1996		      RESP(WS-RESPONSE-CODE)
  1997		      GTEQ
  1998		  END-EXEC
  2036            IF WS-RESPONSE-CODE NOT = +00 OR (REQUESTOR = 'N' AND
  2037                                      SERVICE-PROVIDER = 'N' AND APPROVER
  2038                                          = 'N' AND ADMINISTRATOR = 'N')
  2040		      EXEC CICS SEND TEXT
  2041			  FROM (WS-INVALID)
  2042			  LENGTH (+25)
  2043			  ERASE
  2044		      END-EXEC
  2075		      EXEC CICS RETURN END-EXEC
  2088		  ELSE  2089		   MOVE WS-USERID TO WS-USERID1
  2090		   MOVE REQUESTOR TO WS-REQUESTOR
  2091		   MOVE ADMINISTRATOR TO WS-ADMINISTRATOR
  2092		   MOVE APPROVER TO WS-APPROVER
  2093		   MOVE SERVICE-PROVIDER TO WS-SERVICE-PROVIDER
  2094		   MOVE 1 TO WS-PROG-STATE
  2095		  END-IF
  2096            IF REQUESTOR = 'Y'
  2097                MOVE '- SEARCH TICKET' TO WS-CHOICE
  2098		      PERFORM 500-MOVE-CHOICE-VAL
  2099                MOVE '- ADD TICKET' TO WS-CHOICE
  2100		      PERFORM 500-MOVE-CHOICE-VAL
  2101                MOVE '- UPDATE TICKET' TO WS-CHOICE
  2102		      PERFORM 500-MOVE-CHOICE-VAL
  2103                MOVE '- CLOSE TICKET' TO WS-CHOICE
  2104		      PERFORM 500-MOVE-CHOICE-VAL
  2105                MOVE '- CANCEL TICKET' TO WS-CHOICE
  2106		      PERFORM 500-MOVE-CHOICE-VAL
  2107		  END-IF
  2108            IF SERVICE-PROVIDER = 'Y'
  2109                IF NOT REQUESTOR = 'Y'
  2110                    MOVE '- SEARCH TICKET' TO WS-CHOICE
  2111			  PERFORM 500-MOVE-CHOICE-VAL
  2112                    MOVE '- UPDATE TICKET' TO WS-CHOICE
  2113			  PERFORM 500-MOVE-CHOICE-VAL
  2114		      ELSE
  2115			  CONTINUE
  2116		      END-IF
  2117		  END-IF
  2118            IF APPROVER = 'Y'
  2119                IF NOT (REQUESTOR = 'Y' OR SERVICE-PROVIDER = 'Y')
  2120                    MOVE '- SEARCH TICKET' TO WS-CHOICE
  2121			  PERFORM 500-MOVE-CHOICE-VAL
  2122		      ELSE
  2123                    MOVE '- APPROVE TICKET' TO WS-CHOICE
  2124			  PERFORM 500-MOVE-CHOICE-VAL
  2125		      END-IF
  2126		  END-IF
  2127            IF ADMINISTRATOR = 'Y'
  2128                MOVE '- USER MAINTENANCE' TO WS-CHOICE
  2129		      PERFORM 500-MOVE-CHOICE-VAL
  2130		  END-IF.
  2131	      400-EXIT.
  2132		  EXIT.
  2133
  2134	      500-MOVE-CHOICE-VAL.
  2135		  EVALUATE TRUE
  2136		      WHEN OPTCHC1O = LOW-VALUES
  2137			  MOVE WS-INDEX TO OPTNO1O
  2138			  MOVE WS-CHOICE TO OPTCHC1O
  2139			  MOVE WS-CHOICE TO WS-CHC1
  2140			  ADD 1 TO WS-INDEX
  2141		      WHEN OPTCHC2O = LOW-VALUES
  2142			  MOVE WS-INDEX TO OPTNO2O
  2143			  MOVE WS-CHOICE TO OPTCHC2O
  2144			  MOVE WS-CHOICE TO WS-CHC2
  2145			  ADD 1 TO WS-INDEX
  2146		      WHEN OPTCHC3O = LOW-VALUES
  2147			  MOVE WS-INDEX TO OPTNO3O
  2148			  MOVE WS-CHOICE TO OPTCHC3O  2149			  MOVE WS-CHOICE TO WS-CHC3
  2150			  ADD 1 TO WS-INDEX
  2151		      WHEN OPTCHC4O = LOW-VALUES
  2152			  MOVE WS-INDEX TO OPTNO4O
  2153			  MOVE WS-CHOICE TO OPTCHC4O
  2154			  MOVE WS-CHOICE TO WS-CHC4
  2155			  ADD 1 TO WS-INDEX
  2156		      WHEN OPTCHC5O = LOW-VALUES
  2157			  MOVE WS-INDEX TO OPTNO5O
  2158			  MOVE WS-CHOICE TO OPTCHC5O
  2159			  MOVE WS-CHOICE TO WS-CHC5
  2160			  ADD 1 TO WS-INDEX
  2161		      WHEN OPTCHC6O = LOW-VALUES
  2162			  MOVE WS-INDEX TO OPTNO6O
  2163			  MOVE WS-CHOICE TO OPTCHC6O
  2164			  MOVE WS-CHOICE TO WS-CHC6
  2165			  ADD 1 TO WS-INDEX
  2166		      WHEN OPTCHC7O = LOW-VALUES
  2167			  MOVE WS-INDEX TO OPTNO7O
  2168			  MOVE WS-CHOICE TO OPTCHC7O
  2169			  MOVE WS-CHOICE TO WS-CHC7
  2170			  ADD 1 TO WS-INDEX
  2171		  END-EVALUATE.
  2172	      500-EXIT.
  2173		  EXIT.
  2174
  2175	      600-VALIDATE-TICKET.
  2177		  EXEC CICS
  2178                READ FILE('STF00001')
  2179		      INTO (WS-TIX-REC)
  2180		      RIDFLD (WS-TICKET-NUM1)
  2181		      RESP(WS-RESPONSE-CODE)
  2182		      EQUAL
  2183		  END-EXEC
  2222		  IF EIBRESP = DFHRESP(NOTFND)
  2224		  IF EIBRESP =	       013				       R
  2225                MOVE 'N' TO WS-VALID-TIX-FLAG
  2226		  ELSE
  2227                MOVE 'Y' TO WS-VALID-TIX-FLAG
  2228		      MOVE 2 TO WS-PROG-STATE
  2229		      MOVE TIX-REQUESTOR TO WS-TCKREQ
  2230		      MOVE TIX-STATUS TO WS-TCKSTAT
  2231		      MOVE TIX-TITLE TO WS-TCKTTL
  2232		      MOVE TIX-DESC TO WS-TCKDESC
  2233		      MOVE LAST-UPDATE TO WS-LSTUPD
  2234		      MOVE UPDATED-BY2 TO WS-STUPDBY
  2235		      MOVE LAST-UPDATE-REMW TO WS-LSTUPDRMK
  2236
  2237		  END-IF.
  2238	      600-EXIT.
  2239		  EXIT.
  2240
  2241	      700-TRANSFER-PROG.
  2242		  IF TIXNOI = SPACES OR TIXNOL = ZERO OR TIXNOI = LOW-VALUES
  2243		      MOVE TIXNOI TO WS-TICKET-NUM1
  2244		      MOVE +0 TO EIBCALEN
  2245                IF WS-CHC2 = '- ADD TICKET'
  2246                 MOVE '0' TO WS-TICKET-NUM
  2247		      END-IF
  2248		  ELSE  2249                MOVE 'N' TO WS-INIT
  2250		      MOVE TIXNOI TO WS-TICKET-NUM1
  2251		      PERFORM 600-VALIDATE-TICKET
  2252		  END-IF.
  2253	      700-EXIT.
  2254		  EXIT.
  2255
  2256	      800-NEED-TIX.
  2257            IF WS-VALID-TIX-FLAG = 'N'
  2258		      MOVE WS-INVALID-TICKET TO ERRMSGO
  2259		      PERFORM 600-VALIDATE-TICKET
  2260		      PERFORM 100-SEND-MAP
  2262		      EXEC CICS RETURN
  2263                    TRANSID('SM00')
  2264			  COMMAREA(WS-COMMAREA)
  2265		      END-EXEC
  2289		  END-IF.
  2290	      800-EXIT.
  2291		  EXIT.
  2292
  2293	      900-NO-TIX.
  2294            IF WS-VALID-TIX-FLAG = 'Y'
  2295		      MOVE WS-DUP-TICKET TO ERRMSGO
  2296		      PERFORM 600-VALIDATE-TICKET
  2297		      PERFORM 100-SEND-MAP
  2299		      EXEC CICS RETURN
  2300                    TRANSID('SM00')
  2301			  COMMAREA(WS-COMMAREA)
  2302		      END-EXEC
  2326		  END-IF.
  2327	      900-EXIT.
  2328		  EXIT.CA-Realia COBOL Version 6.0.45	 C:\handson-cics\CAWB30\sm000p.cic     PAGE   21



			Realia COBOL Compiler Version Information

			      Pass 1	 Version 6.072
			      Pass 1a	 Version 6.015
			      Pass 2	 Version 6.068
			      Pass 2a	 Version 6.020
			      Pass 3	 Version 6.094
			      Pass 4	 Version 6.007
			      Pass 5	 Version 6.022


			Compilation Directives in Effect

COMP-4		  DCHK		    OPT 	      NOCALL
NOSUBCHK	  STRCHK	    NOTRUNC	      NOSMALLCOMP
NODCALL 	  NODIVZERO	    NOEPDCALL	      APOST
EBCDIC		  STATABORT	    NOMOVELINK	      NOBLL4K
ARGCHK		  UPLOW 	    NOVERARG	      MDY
LP:   60	  PP		    FCREATE	      NOIEEE
NOLILIAN	  CURRENCY-SIGN=$   WRITEAFTER	      SOSI
NOCOPY68	  NOFLAG-COM	    NOFLAG-SEG	      NOFLAG-FIPS
DEBUGXREF	  DIALECT-VS2

			Error level limit: W

			Source lines compiled:	    2339
			Compilation time (mm:ss.ss):  0:00.18
			Compilation speed (lines/minute): 79666

			Compilation date (yy/mm/dd): 23/12/05
			     Time of day (hh:mm:ss): 16:42:32