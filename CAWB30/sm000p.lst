     5	     *	CBL XOPTS(COBOL2)
    20	      IDENTIFICATION DIVISION.
    21	      PROGRAM-ID. SM000P.
    22
    23	      ENVIRONMENT DIVISION.
    24	      CONFIGURATION SECTION.
    25	      SOURCE-COMPUTER.	  IBM-PC.
    26	      OBJECT-COMPUTER.	  IBM-PC.
    27	      DATA DIVISION.
    28	      WORKING-STORAGE SECTION.
    74	      01  WS-TIME			  PIC 9(15) COMP-3.
    75	      01  WS-DATE				PIC 9(7).
    76	      01  WS-DATE-X REDEFINES WS-DATE		PIC X(7).
    77        01  WS-VALID-TIX-FLAG                     PIC X VALUE 'Y'.
    78	      01  WS-LENGTH				PIC S9(4) COMP.
    79	      01  WS-INDEX				PIC 9 VALUE 1.
    80	      01  WS-CHOICE				PIC X(21).
    81	      01  WS-FILLER				PIC X(80).
    82	      01  WS-CHOICE-PH.
    83		  05  WS-CHC1				PIC X(21).
    84		  05  WS-CHC2				PIC X(21).
    85		  05  WS-CHC3				PIC X(21).
    86		  05  WS-CHC4				PIC X(21).
    87		  05  WS-CHC5				PIC X(21).
    88		  05  WS-CHC6				PIC X(21).
    89		  05  WS-CHC7				PIC X(21).
    90	      01  WS-USERID				PIC X(7).
    91	      01  WS-TIXID				PIC X(6).
    92	      01  WS-RESPONSE-CODE    PIC S9(8) COMP.
    93	      01  WS-LOGID.
    94		  05  LOGID2				PIC X(6).
    95		  05  FILLER				PIC X.
    96	      01  WS-END				PIC X(15) VALUE
    97            'END PROCESSING'.
    98	      01  WS-INVKEY				PIC X(21) VALUE
    99            'INVALID PFKEY PRESSED'.
   100	      01  WS-INVALID			  PIC X(14) VALUE
   101            'INVALID ACCESS'.
   102	      01  WS-INVALID-TICKET			  PIC X(28) VALUE
   103            'TICKET NUMBER DOES NOT EXIST'.
   104	      01  WS-DUP-TICKET 			  PIC X(28) VALUE
   105            'DUPLICATE TICKET NUMBER'.
   106	      01  WS-INVALID-USER			  PIC X(24) VALUE
   107            'INVALID ACCESS TO TICKET'.
   108	      01  WS-COMMAREA.
   109		  05  WS-CA-PRGNAME	      PIC X(06).
   110		  05  FILLER		      PIC X(19).
   111		  05  WS-DFHSTATE	      PIC X(15).
   112		  05  WS-TRANS		      PIC X(04).
   113		  05  WS-LUSER		      PIC 9(03).
   114		  05  WS-FUSER		      PIC 9(03).
   115		  05  WS-PAGE		      PIC 9(02).
   116		  05  WS-PAGE-END	      PIC 9(01).
   117		  05  WS-QITEM		      PIC S9(4) COMP.
   118		  05  WS-QITEM-START	      PIC S9(4) COMP.
   119		  05  WS-QITEM-END	      PIC S9(4) COMP.
   120		  05  WS-QITEM-PAGE	      PIC S9(4) COMP.
   121		  05  WS-USERID1			 PIC X(7).
   122		  05  WS-USER-REC.
   123		      10  USERID.   124			  15  USERID1			    PIC X(7).
   125			  15  FILLER			    PIC X.
   126		      10  REQUESTOR			    PIC X.
   127		      10  ADMINISTRATOR 		    PIC X.
   128		      10  APPROVER			    PIC X.
   129		      10  SERVICE-PROVIDER		    PIC X.
   130		      10  UPDATED-BY1.
   131			  15  UPDBY1			    PIC X(7).
   132			  15  FILLER			    PIC X.
   133		  05  WS-TIX-REC.
   134		      10  TIX-ID			    PIC X(06).
   135		      10  TIX-REQUESTOR 		    PIC X(08).
   136		      10  TIX-STATUS			    PIC X(10).
   137		      10  TIX-TITLE			    PIC X(25).
   138		      10  TIX-DESC			    PIC X(100).
   139		      10  TIX-DESC-RED REDEFINES TIX-DESC.
   140			  15  TIX-DESC1 		    PIC X(50).
   141			  15  TIX-DESC2 		    PIC X(50).
   142		      10  LAST-UPDATE			    PIC X(20).
   143		      10  LAST-UPDATE-RED REDEFINES LAST-UPDATE.
   144			  15  LAST-UPDATE-DATE		    PIC X(11).
   145			  15  LAST-UPDATE-TIME		    PIC X(09).
   146		      10  UPDATED-BY2.
   147			  15  UPDBY2			    PIC X(7).
   148			  15  FILLER			    PIC X.
   149		      10  LAST-UPDATE-REM		    PIC X(50).
   150		      10  LAST-UPDATE-REMW REDEFINES LAST-UPDATE-REM.
   151			  15  LAST-UPDATE-REM1		    PIC X(25).
   152			  15  LAST-UPDATE-REM2		    PIC X(25).
   153		  05  WS-PROG-STATE			 PIC 9(1).
   154            05  WS-INIT                            PIC X VALUE 'Y'.
   155		  05  WS-TICKET-NUM.
   156		      10  WS-TICKET-NUM1		 PIC X(6).
   157		      10  FILLER			 PIC X.
   158
   159	     *
   160		  COPY SM000S.
   162	     * SYMBOLIC MAP of sm000s Created by CACXBMS Version 6.0.27
   163	      01  SW00MI.
   164		  02  FILLER				     PIC X(12).
   165		  02  OPTCHC1L				     PIC S9(4) COMP.
   166		  02  OPTCHC1F				     PIC X.
   167		  02  FILLER REDEFINES OPTCHC1F.
   168		      03  OPTCHC1A			     PIC X.
   169		  02  OPTCHC1I				     PIC X(021).
   170		  02  OPTNO1L				     PIC S9(4) COMP.
   171		  02  OPTNO1F				     PIC X.
   172		  02  FILLER REDEFINES OPTNO1F.
   173		      03  OPTNO1A			     PIC X.
   174		  02  OPTNO1I				     PIC X(001).
   175		  02  OPTCHC2L				     PIC S9(4) COMP.
   176		  02  OPTCHC2F				     PIC X.
   177		  02  FILLER REDEFINES OPTCHC2F.
   178		      03  OPTCHC2A			     PIC X.
   179		  02  OPTCHC2I				     PIC X(021).
   180		  02  OPTNO2L				     PIC S9(4) COMP.
   181		  02  OPTNO2F				     PIC X.
   182		  02  FILLER REDEFINES OPTNO2F.
   183		      03  OPTNO2A			     PIC X.
   184		  02  OPTNO2I				     PIC X(001).   185		  02  OPTCHC3L				     PIC S9(4) COMP.
   186		  02  OPTCHC3F				     PIC X.
   187		  02  FILLER REDEFINES OPTCHC3F.
   188		      03  OPTCHC3A			     PIC X.
   189		  02  OPTCHC3I				     PIC X(021).
   190		  02  OPTNO3L				     PIC S9(4) COMP.
   191		  02  OPTNO3F				     PIC X.
   192		  02  FILLER REDEFINES OPTNO3F.
   193		      03  OPTNO3A			     PIC X.
   194		  02  OPTNO3I				     PIC X(001).
   195		  02  OPTCHC4L				     PIC S9(4) COMP.
   196		  02  OPTCHC4F				     PIC X.
   197		  02  FILLER REDEFINES OPTCHC4F.
   198		      03  OPTCHC4A			     PIC X.
   199		  02  OPTCHC4I				     PIC X(021).
   200		  02  OPTNO4L				     PIC S9(4) COMP.
   201		  02  OPTNO4F				     PIC X.
   202		  02  FILLER REDEFINES OPTNO4F.
   203		      03  OPTNO4A			     PIC X.
   204		  02  OPTNO4I				     PIC X(001).
   205		  02  OPTCHC5L				     PIC S9(4) COMP.
   206		  02  OPTCHC5F				     PIC X.
   207		  02  FILLER REDEFINES OPTCHC5F.
   208		      03  OPTCHC5A			     PIC X.
   209		  02  OPTCHC5I				     PIC X(021).
   210		  02  OPTNO5L				     PIC S9(4) COMP.
   211		  02  OPTNO5F				     PIC X.
   212		  02  FILLER REDEFINES OPTNO5F.
   213		      03  OPTNO5A			     PIC X.
   214		  02  OPTNO5I				     PIC X(001).
   215		  02  OPTCHC6L				     PIC S9(4) COMP.
   216		  02  OPTCHC6F				     PIC X.
   217		  02  FILLER REDEFINES OPTCHC6F.
   218		      03  OPTCHC6A			     PIC X.
   219		  02  OPTCHC6I				     PIC X(021).
   220		  02  OPTNO6L				     PIC S9(4) COMP.
   221		  02  OPTNO6F				     PIC X.
   222		  02  FILLER REDEFINES OPTNO6F.
   223		      03  OPTNO6A			     PIC X.
   224		  02  OPTNO6I				     PIC X(001).
   225		  02  OPTCHC7L				     PIC S9(4) COMP.
   226		  02  OPTCHC7F				     PIC X.
   227		  02  FILLER REDEFINES OPTCHC7F.
   228		      03  OPTCHC7A			     PIC X.
   229		  02  OPTCHC7I				     PIC X(021).
   230		  02  OPTNO7L				     PIC S9(4) COMP.
   231		  02  OPTNO7F				     PIC X.
   232		  02  FILLER REDEFINES OPTNO7F.
   233		      03  OPTNO7A			     PIC X.
   234		  02  OPTNO7I				     PIC X(001).
   235		  02  OPTIONL				     PIC S9(4) COMP.
   236		  02  OPTIONF				     PIC X.
   237		  02  FILLER REDEFINES OPTIONF.
   238		      03  OPTIONA			     PIC X.
   239		  02  OPTIONI				     PIC X(001).
   240		  02  TIXNOL				     PIC S9(4) COMP.
   241		  02  TIXNOF				     PIC X.
   242		  02  FILLER REDEFINES TIXNOF.
   243		      03  TIXNOA			     PIC X.
   244		  02  TIXNOI				     PIC X(006).   245		  02  ERRMSGL				     PIC S9(4) COMP.
   246		  02  ERRMSGF				     PIC X.
   247		  02  FILLER REDEFINES ERRMSGF.
   248		      03  ERRMSGA			     PIC X.
   249		  02  ERRMSGI				     PIC X(071).
   250		  02  DATEL				     PIC S9(4) COMP.
   251		  02  DATEF				     PIC X.
   252		  02  FILLER REDEFINES DATEF.
   253		      03  DATEA 			     PIC X.
   254		  02  DATEI				     PIC X(010).
   255		  02  TIMEL				     PIC S9(4) COMP.
   256		  02  TIMEF				     PIC X.
   257		  02  FILLER REDEFINES TIMEF.
   258		      03  TIMEA 			     PIC X.
   259		  02  TIMEI				     PIC X(008).
   260	      01  SW00MO REDEFINES SW00MI.
   261		  02  FILLER				     PIC X(12).
   262		  02  FILLER				     PIC XX.
   263		  02  FILLER				     PIC X.
   264		  02  OPTCHC1O				     PIC X(021).
   265		  02  FILLER				     PIC XX.
   266		  02  FILLER				     PIC X.
   267		  02  OPTNO1O				     PIC X(001).
   268		  02  FILLER				     PIC XX.
   269		  02  FILLER				     PIC X.
   270		  02  OPTCHC2O				     PIC X(021).
   271		  02  FILLER				     PIC XX.
   272		  02  FILLER				     PIC X.
   273		  02  OPTNO2O				     PIC X(001).
   274		  02  FILLER				     PIC XX.
   275		  02  FILLER				     PIC X.
   276		  02  OPTCHC3O				     PIC X(021).
   277		  02  FILLER				     PIC XX.
   278		  02  FILLER				     PIC X.
   279		  02  OPTNO3O				     PIC X(001).
   280		  02  FILLER				     PIC XX.
   281		  02  FILLER				     PIC X.
   282		  02  OPTCHC4O				     PIC X(021).
   283		  02  FILLER				     PIC XX.
   284		  02  FILLER				     PIC X.
   285		  02  OPTNO4O				     PIC X(001).
   286		  02  FILLER				     PIC XX.
   287		  02  FILLER				     PIC X.
   288		  02  OPTCHC5O				     PIC X(021).
   289		  02  FILLER				     PIC XX.
   290		  02  FILLER				     PIC X.
   291		  02  OPTNO5O				     PIC X(001).
   292		  02  FILLER				     PIC XX.
   293		  02  FILLER				     PIC X.
   294		  02  OPTCHC6O				     PIC X(021).
   295		  02  FILLER				     PIC XX.
   296		  02  FILLER				     PIC X.
   297		  02  OPTNO6O				     PIC X(001).
   298		  02  FILLER				     PIC XX.
   299		  02  FILLER				     PIC X.
   300		  02  OPTCHC7O				     PIC X(021).
   301		  02  FILLER				     PIC XX.
   302		  02  FILLER				     PIC X.
   303		  02  OPTNO7O				     PIC X(001).
   304		  02  FILLER				     PIC XX.   305		  02  FILLER				     PIC X.
   306		  02  OPTIONO				     PIC X(001).
   307		  02  FILLER				     PIC XX.
   308		  02  FILLER				     PIC X.
   309		  02  TIXNOO				     PIC X(006).
   310		  02  FILLER				     PIC XX.
   311		  02  FILLER				     PIC X.
   312		  02  ERRMSGO				     PIC X(071).
   313		  02  FILLER				     PIC XX.
   314		  02  FILLER				     PIC X.
   315		  02  DATEO				     PIC X(010).
   316		  02  FILLER				     PIC XX.
   317		  02  FILLER				     PIC X.
   318		  02  TIMEO				     PIC X(008).
   320	     *
   321		  COPY DFHAID.
   323	      01  DFHAID.
   324	     *
   325	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   326	     *
   327	     * Revision Information
   328	     * ^{File:dfhaid.cob  }
   329	     * ^{Timestamp:Thu May 15 14:02:52 1997}
   330	     * ^{Revision:2.0}
   331	     *
   332	     *This is the AID constants copy file
   333	     *
   334            05  DFHENTER                  PIC X VALUE ''''.
   335	     *					value APOST
   336            05  DFHCLEAR                  PIC X VALUE '_'.
   337            05  DFHPA1                    PIC X VALUE '%'.
   338            05  DFHPA2                    PIC X VALUE '>'.
   339            05  DFHPA3                    PIC X VALUE ','.
   340            05  DFHPF1                    PIC X VALUE '1'.
   341            05  DFHPF2                    PIC X VALUE '2'.
   342            05  DFHPF3                    PIC X VALUE '3'.
   343            05  DFHPF4                    PIC X VALUE '4'.
   344            05  DFHPF5                    PIC X VALUE '5'.
   345            05  DFHPF6                    PIC X VALUE '6'.
   346            05  DFHPF7                    PIC X VALUE '7'.
   347            05  DFHPF8                    PIC X VALUE '8'.
   348            05  DFHPF9                    PIC X VALUE '9'.
   349            05  DFHPF10                   PIC X VALUE ':'.
   350            05  DFHPF11                   PIC X VALUE '#'.
   351            05  DFHPF12                   PIC X VALUE '@'.
   352            05  DFHPF13                   PIC X VALUE 'A'.
   353            05  DFHPF14                   PIC X VALUE 'B'.
   354            05  DFHPF15                   PIC X VALUE 'C'.
   355            05  DFHPF16                   PIC X VALUE 'D'.
   356            05  DFHPF17                   PIC X VALUE 'E'.
   357            05  DFHPF18                   PIC X VALUE 'F'.
   358            05  DFHPF19                   PIC X VALUE 'G'.
   359            05  DFHPF20                   PIC X VALUE 'H'.
   360            05  DFHPF21                   PIC X VALUE 'I'.
   361            05  DFHPF22                   PIC X VALUE '›'.
   362       *                                  EBCDIC Cent sign x'4A'
   363       *                                  ASCII  Cent sign x'9B'
   364            05  DFHPF23                   PIC X VALUE '.'.
   365            05  DFHPF24                   PIC X VALUE '<'.
   366            05  DFHOPID                   PIC X VALUE 'W'.   367            05  DFHMSRE                   PIC X VALUE 'X'.
   368            05  DFHTRIG                   PIC X VALUE '"'.
   369       *                                        value QUOTE  "
   370            05  DFHPEN                    PIC X VALUE '='.
   371            05  DFHCLRP                   PIC X VALUE 'Ý'.
   372       *                                  EBCDIC x'6A'
   373       *                                  ASCII  x'DD'
   374            05  DFHSTRF                   PIC X VALUE 'h'.
   375	     *	  DFHQUIT is a CA-Realia CICS Extension
   376	     *	  It is set by using <Ctrl>+C or <Ctrl>+<Break> Keys
   377            05  DFHQUIT                   PIC X VALUE '!'.
   378		  05  DFHNULL			PIC X VALUE LOW-VALUE.
   380	     *
   381	      COPY DFHBMSCA.
   383	      01  DFHBMSCA.
   384	     *
   385	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   386	     *
   387	     * Revision Information
   388	     * ^{File:dfhbmsca.cob}
   389	     * ^{Timestamp:Tue Oct 08 15:34:54 1996}
   390	     * ^{Revision:2.0}
   391	     *
   392	     *	Note:This FILE is provided with most values as quoted literals
   393	     *	     so that the file can be used for both ASCII and EBCDIC
   394	     *	     programs
   395	     *
   396	     *	     The only exceptions are some 3270 Data Stream Orders
   397	     *	     They use different Hexadecimal values for ASCII and
   398	     *	     EBCDIC and they cannot be expressed as quoted literals
   399	     *	     as the values are <Line Feed>, <Tab>, <End of File> etc.
   400	     *	     characters in ASCII
   401	     *
   402	     *	     They have their values set up to default to the EBCDIC
   403	     *	     values.
   404	     *
   405	     *	     3270 orders are only needed for EXEC CICS SEND and RECEIVE
   406	     *	     and SEND TEXT with imbedded format orders.
   407	     *	     If you use these values in ASCII programs the values
   408	     *	     must be changed.
   409	     *
   410	     *	     An alternative is to use REPLACING to change the values.
   411	     *
   412	     *	  i.e. COPY DFHBMSCA replacing
   413	     *			    ==005== BY ==009==	*> DFHPT
   414	     *			    ==021== BY ==010==	*> DFHNL
   415	     *			    ==040== BY ==021==	*> DFHSA
   416	     *			    ==041== BY ==031==	*> DFHSFE
   417	     *			    ==044== BY ==023==	*> DFHMF
   418	     *			    ==060== BY ==020==	*> DFHRA
   419	     *			    ==063== BY ==026==. *> DFHSUB
   420	     *
   421	     ******************************************************************
   422	     *BMS and Terminal Control - Order & Attributes constants	      *
   423	     ******************************************************************
   424	     *
   425	     *	  Field Attributes
   426	     *
   427            05  DFHBMASB                          PIC X VALUE '8'.
   428            05  DFHBMASF                          PIC X VALUE '1'.   429            05  DFHBMASK                          PIC X VALUE '0'.
   430            05  DFHBMBRY                          PIC X VALUE 'H'.
   431            05  DFHBMDAR                          PIC X VALUE '<'.
   432            05  DFHBMFSE                          PIC X VALUE 'A'.
   433            05  DFHBMPRF                          PIC X VALUE '/'.
   434            05  DFHBMPRO                          PIC X VALUE '-'.
   435            05  DFHBMUNN                          PIC X VALUE '&'.
   436            05  DFHBMUNP                          PIC X VALUE ' '.
   437            05  DFHUNNUM                          PIC X VALUE 'J'.
   438	     *
   439	     *	  partially supported
   440	     *
   441            05  DFHUNNOD                          PIC X VALUE '('.
   442            05  DFHUNIMD                          PIC X VALUE 'I'.
   443            05  DFHUNINT                          PIC X VALUE 'R'.
   444            05  DFHUNNON                          PIC X VALUE '('.
   445            05  DFHPROTI                          PIC X VALUE 'Y'.
   446            05  DFHPROTN                          PIC X VALUE '%'.
   447	     *
   448	     *	  These values are additions to mainframe constants
   449	     *
   450            05  DFHBMS-ASK-DARK                   PIC X VALUE '@'.
   451            05  DFHBMS-ASK-BRY-FSET               PIC X VALUE '9'.
   452            05  DFHBMS-ASK-DAR-FSET               PIC X VALUE ''''.
   453	     *						      VALUE APOST
   454            05  DFHBMS-PRO-BRY-FSET               PIC X VALUE 'Z'.
   455            05  DFHBMS-PRO-DAR-FSET               PIC X VALUE '_'.
   456            05  DFHBMS-NUM-BRY                    PIC X VALUE 'Q'.
   457            05  DFHBMS-NUM-DAR                    PIC X VALUE '*'.
   458            05  DFHBMS-NUM-DAR-FSET               PIC X VALUE ')'.
   459	     *
   460	     *	  Field Flag values
   461		  05  DFHBMEOF-VAL VALUE 128		PIC S9(4) COMP-4.
   462		  05  FILLER REDEFINES DFHBMEOF-VAL.
   463		      10  FILLER			PIC X.
   464		      10  DFHBMEOF			PIC X.
   465       *                                          x'80'.
   466		  05  DFHBMCUR-VAL VALUE 002		PIC S9(4) COMP-4.
   467		  05  FILLER REDEFINES DFHBMCUR-VAL.
   468		      10  FILLER			PIC X.
   469		      10  DFHBMCUR			PIC X.
   470       *                                          x'02'.
   471		  05  DFHBMMEC-VAL VALUE 130		PIC S9(4) COMP-4.
   472		  05  FILLER REDEFINES DFHBMMEC-VAL.
   473		      10  FILLER			PIC X.
   474		      10  DFHBMMEC			PIC X.
   475       *                                          x'82'.
   476       *                                          x'02'.
   477		  05  DFHBMFLG-VAL  VALUE 0		PIC S9(4) COMP-4.
   478		      88  DFHERASE			VALUES 128 130.
   479       *                                          x'80' X'82'
   480		      88  DFHCURSR			VALUES 002 130.
   481       *                                          x'02' X'82'
   482		  05  FILLER REDEFINES DFHBMFLG-VAL.
   483		      10  FILLER			PIC X.
   484		      10  DFHBMFLG			PIC X.
   485
   486		  05  DFHBMDUP-VAL VALUE 028		PIC S9(4) COMP-4.
   487		  05  FILLER REDEFINES DFHBMDUP-VAL.
   488		      10  FILLER			PIC X.   489		      10  DFHBMDUP			PIC X.
   490       *                                              x'1C'
   491	     *
   492	     ******************************************************************
   493	     *	  supported 327X Extended Attributes
   494	     *
   495	     *	  Extended COLOR Attributes
   496	     *
   497            05  DFHDFCOL                          PIC X VALUE '0'.
   498            05  DFHBLUE                           PIC X VALUE '1'.
   499            05  DFHRED                            PIC X VALUE '2'.
   500            05  DFHPINK                           PIC X VALUE '3'.
   501            05  DFHGREEN                          PIC X VALUE '4'.
   502            05  DFHTURQ                           PIC X VALUE '5'.
   503            05  DFHYELLO                          PIC X VALUE '6'.
   504            05  DFHNEUTR                          PIC X VALUE '7'.
   505	     *
   506	     *	  Extended HILIGHT Attributes
   507	     *
   508            05  DFHDFHI                           PIC X VALUE '0'.
   509            05  DFHBLINK                          PIC X VALUE '1'.
   510            05  DFHREVRS                          PIC X VALUE '2'.
   511            05  DFHUNDLN                          PIC X VALUE '4'.
   512	     *
   513	     ******************************************************************
   514	     *	  supported 327X Data Stream Orders
   515	     *
   516		  05  DFHSBA-VAL VALUE 017		 PIC S9(4) COMP-4.
   517		  05  FILLER REDEFINES DFHSBA-VAL.
   518		      10  FILLER			PIC X.
   519		      10  DFHSBA			PIC X.
   520       *                                              x'11'
   521		  05  DFHEUA-VAL VALUE 018		PIC S9(4) COMP-4.
   522		  05  FILLER REDEFINES DFHEUA-VAL.
   523		      10  FILLER			PIC X.
   524		      10  DFHEUA			PIC X.
   525       *                                              x'12'
   526		  05  DFHIC-VAL VALUE 019		PIC S9(4) COMP-4.
   527		  05  FILLER REDEFINES DFHIC-VAL.
   528		      10  FILLER			PIC X.
   529		      10  DFHIC 			PIC X.
   530       *                                              X'13'.
   531		  05  DFHSF-VAL VALUE 029		PIC S9(4) COMP-4.
   532		  05  FILLER REDEFINES DFHSF-VAL.
   533		      10  FILLER			PIC X.
   534		      10  DFHSF 			PIC X.
   535       *                                              X'1D'.
   536		  05  DFHPT-VAL VALUE 005		PIC S9(4) COMP-4.
   537		      88 DFHPT-VAL-EBCDIC		VALUE 5.
   538		      88 DFHPT-VAL-ASCII		VALUE 9.
   539		  05  FILLER REDEFINES DFHPT-VAL.
   540		      10  FILLER			PIC X.
   541		      10  DFHPT 			PIC X.
   542       *                                              EBCDIC X'05'.
   543       *                                              ASCII  X'09'.
   544		  05  DFHRA-VAL VALUE 060		PIC S9(4) COMP-4.
   545		      88 DFHRA-VAL-EBCDIC		VALUE 60.
   546		      88 DFHRA-VAL-ASCII		VALUE 20.
   547		  05  FILLER REDEFINES DFHRA-VAL.
   548		      10  FILLER			PIC X.   549		      10  DFHRA 			PIC X.
   550       *                                              EBCDIC x'3C'
   551       *                                              ASCII  x'14'
   552		  05  DFHSFE-VAL VALUE 041		PIC S9(4) COMP-4.
   553		      88 DFHSFE-VAL-EBCDIC		VALUE 41.
   554		      88 DFHSFE-VAL-ASCII		VALUE 31.
   555		  05  FILLER REDEFINES DFHSFE-VAL.
   556		      10  FILLER			PIC X.
   557		      10  DFHSFE			PIC X.
   558       *                                              EBCDIC x'29'
   559       *                                              ASCII  x'1F'
   560		  05  DFHMF-VAL VALUE 044		PIC S9(4) COMP-4.
   561		      88 DFHMF-VAL-EBCDIC		VALUE 44.
   562		      88 DFHMF-VAL-ASCII		VALUE 23.
   563		  05  FILLER REDEFINES DFHMF-VAL.
   564		      10  FILLER			PIC X.
   565		      10  DFHMF 			PIC X.
   566       *                                              EBCDIC x'2C'
   567       *                                              ASCII  x'17'
   568	     *
   569	     ******************************************************************
   570	     *	  unsupported 327X Data Stream order codes
   571	     *
   572		  05  DFHSA-VAL VALUE 040		PIC S9(4) COMP-4.
   573		      88 DFHSA-VAL-EBCDIC		VALUE 40.
   574		      88 DFHSA-VAL-ASCII		VALUE 21.
   575		  05  FILLER REDEFINES DFHSA-VAL.
   576		      10  FILLER			PIC X.
   577		      10  DFHSA 			PIC X.
   578       *                                              EBCDIC x'28'
   579       *                                              ASCII  x'15'
   580		  05  DFHGE-VAL VALUE 008		PIC S9(4) COMP-4.
   581		  05  FILLER REDEFINES DFHGE-VAL.
   582		      10  FILLER			PIC X.
   583		      10  DFHGE 			PIC X.
   584       *                                              X'08'.
   585	     *
   586	     ******************************************************************
   587	     *	  SFE and MF supported attribute types
   588	     *
   589            05  DFHCOLOR                          PIC X VALUE 'ƒ'.
   590       *                                              EBCDIC x'42'
   591       *                                              ASCII  x'83'
   592            05  DFHHLT                            PIC X VALUE 'Ö'.
   593       *                                              EBCDIC x'41'
   594       *                                              ASCII  x'D6'
   595            05  DFH3270                           PIC X VALUE '{'.
   596	     *
   597	     *	  supported for SEND TEXT command and printer terminal
   598	     *
   599		  05  DFHBMPNL-VAL VALUE 021		PIC S9(4) COMP-4.
   600		      88 DFHBMPNL-VAL-EBCDIC		VALUE 21.
   601		      88 DFHBMPNL-VAL-ASCII		VALUE 10.
   602		  05  FILLER REDEFINES DFHBMPNL-VAL.
   603		      10  FILLER			PIC X.
   604		      10  DFHBMPNL			PIC X.
   605       *                                              EBCDIC X'15'.
   606       *                                              ASCII  X'0A'.
   607	     *
   608	     ******************************************************************   609	     *	  Printer terminal data stream only
   610	     *
   611		  05  DFHBMPFF-VAL VALUE 012		PIC S9(4) COMP-4.
   612		  05  FILLER REDEFINES DFHBMPFF-VAL.
   613		      10  FILLER			PIC X.
   614		      10  DFHBMPFF			PIC X.
   615       *                                              X'0C'.
   616		  05  DFHBMPCR-VAL VALUE 013		PIC S9(4) COMP-4.
   617		  05  FILLER REDEFINES DFHBMPCR-VAL.
   618		      10  FILLER			PIC X.
   619		      10  DFHBMPCR			PIC X.
   620       *                                              X'0D'.
   621		  05  DFHBMPEM-VAL VALUE 025		PIC S9(4) COMP-4.
   622		  05  FILLER REDEFINES DFHBMPEM-VAL.
   623		      10  FILLER			PIC X.
   624		      10  DFHBMPEM			PIC X.
   625       *                                              X'19'.
   626	     *
   627	     ******************************************************************
   628	     *	  unsupported Miscellaneous attributes and constants
   629	     *
   630		  05  DFHALL				PIC X VALUE LOW-VALUES.
   631            05  DFHBASE                           PIC X VALUE '0'.
   632		  05  DFHBMDET				PIC X VALUE LOW-VALUES.
   633		  05  DFHBMPSOSI-VAL VALUE 3599 	PIC S9(4) COMP-4.
   634		  05  FILLER REDEFINES DFHBMPSOSI-VAL.
   635		      10  DFHBMPSO			PIC X.
   636       *                                              X'0E'.
   637		      10  DFHBMPSI			PIC X.
   638       *                                              X'0F'.
   639		  05  DFHDFT VALUE HIGH-VALUES		PIC X.
   640            05  DFHERROR                          PIC X VALUE '¶'.
   641       *                                              EBCDIC X'1A'.
   642       *                                              ASCII  X'B6'.
   643            05  DFHFIL                            PIC X VALUE '4'.
   644            05  DFHMENT                           PIC X VALUE '2'.
   645            05  DFHMET                            PIC X VALUE '3'.
   646            05  DFHMFE                            PIC X VALUE '6'.
   647            05  DFHMFET                           PIC X VALUE '7'.
   648            05  DFHMFT                            PIC X VALUE '5'.
   649            05  DFHMT                             PIC X VALUE '1'.
   650            05  DFHOUTLN                          PIC X VALUE 'B'.
   651            05  DFHPS                             PIC X VALUE '„'.
   652       *                                              EBCDIC x'43'
   653       *                                              ASCII  x'84'
   654            05  DFHVAL                            PIC X VALUE 'A'.
   655	     *
   656		  05  DFHSUB-VAL   VALUE 063		PIC S9(4) COMP-4.
   657		      88 DFHSUB-VAL-EBCDIC		VALUE 63.
   658		      88 DFHSUB-VAL-ASCII		VALUE 26.
   659		  05  FILLER REDEFINES DFHSUB-VAL.
   660		      10  FILLER			PIC X.
   661		      10  DFHSUB			PIC X.
   662       *                                              EBCDIC X'3F'.
   663       *                                              ASCII  X'1A'.
   664	     *
   665		  05  DFHFM-VAL    VALUE 030		PIC S9(4) COMP-4.
   666		  05  FILLER REDEFINES DFHFM-VAL.
   667		      10  FILLER			PIC X.
   668		      10  DFHFM 			PIC X.   669       *                                              EBCDIC X'1E'.
   670		  05  DFHEO VALUE HIGH-VALUE		PIC X.
   672
   673	      LINKAGE SECTION.
   675	      01  DFHEIBLK.						       R
   676		  05 EIBTIME  PIC S9(7) COMP-3. 			       R
   677		  05 EIBDATE  PIC S9(7) COMP-3. 			       R
   678		  05 EIBTRNID PIC X(4). 				       R
   679		  05 EIBTASKN PIC S9(7) COMP-3. 			       R
   680		  05 EIBTRMID PIC X(4). 				       R
   681		  05 DFHEIGDI PIC S9(4) COMP-4. 			       R
   682		  05 EIBCPOSN PIC S9(4) COMP-4. 			       R
   683		  05 EIBCALEN PIC S9(4) COMP-4. 			       R
   684		  05 EIBAID   PIC X.					       R
   685		  05 EIBFN    PIC X(2). 				       R
   686		  05 EIBRCODE PIC X(6). 				       R
   687		  05 EIBDS    PIC X(8). 				       R
   688		  05 EIBREQID PIC X(8). 				       R
   689		  05 EIBRSRCE PIC X(8). 				       R
   690		  05 EIBSYNC  PIC X.					       R
   691		  05 EIBFREE  PIC X.					       R
   692		  05 EIBRECV  PIC X.					       R
   693		  05 EIBSEND  PIC X.					       R
   694		  05 EIBATT   PIC X.					       R
   695		  05 EIBEOC   PIC X.					       R
   696		  05 EIBFMH   PIC X.					       R
   697		  05 EIBCOMPL PIC X.					       R
   698		  05 EIBSIG   PIC X.					       R
   699		  05 EIBCONF  PIC X.					       R
   700		  05 EIBERR   PIC X.					       R
   701		  05 EIBERRCD PIC X(4). 				       R
   702		  05 EIBSYNRB PIC X.					       R
   703		  05 EIBNODAT PIC X.					       R
   704		  05 EIBRESP  PIC S9(8) COMP-4. 			       R
   705		  05 EIBRESP2 PIC S9(8) COMP-4. 			       R
   706		  05 EIBRLDBK PIC X.					       R
   707		  05 EIBCARESERVED PIC X(32).				       R
   709	      01  DFHCOMMAREA				PIC X(322).
   710	     *
   711	      PROCEDURE DIVISION					       R
   713		  USING DFHEIBLK DFHCOMMAREA.				       R
   738	      000-PROCESS-MENU.
   739	     *
   740            IF EIBTRNID = 'SM00' OR 'SM01' OR 'SM02' OR 'SM03' OR 'SM04'
   741                          OR 'SM05' OR 'SM06' OR 'UA01'
   742		      MOVE LOW-VALUES TO SW00MO
   743		      PERFORM 400-SEARCH-USER
   744		  ELSE
   746		      EXEC CICS SEND TEXT
   747			  FROM (WS-INVALID)
   748			  LENGTH (15)
   749			  ERASE
   750		      END-EXEC
   780		  END-IF
   781
   782		  EVALUATE TRUE
   783		      WHEN EIBCALEN = +0
   784			  MOVE LOW-VALUES TO WS-CHOICE-PH
   785                    MOVE 'ENTER OPTION AND PRESS ENTER' TO ERRMSGO
   786			  PERFORM 100-SEND-MAP   787		      WHEN EIBAID = DFHPF3
   789			  EXEC CICS SEND TEXT
   790			      FROM (WS-END)
   791			      LENGTH (15)
   792			      ERASE
   793			  END-EXEC
   824			  EXEC CICS RETURN END-EXEC
   837		      WHEN EIBAID = DFHENTER
   838			  PERFORM 300-PROCESS-TRAN
   839		      WHEN OTHER
   840			  MOVE WS-INVKEY TO ERRMSGO
   841			  PERFORM 400-SEARCH-USER
   842			  PERFORM 100-SEND-MAP
   843		  END-EVALUATE
   845		  EXEC CICS
   846		      RETURN
   847                    TRANSID('SM00')
   848			  COMMAREA(WS-COMMAREA)
   849		      END-EXEC.
   874	      000-EXIT.
   875		  EXIT.
   876
   877
   878	      100-SEND-MAP.
   879		  MOVE EIBDATE TO WS-DATE.
   880		  MOVE WS-DATE-X TO DATEO.
   882		  EXEC CICS ASKTIME
   883			  ABSTIME      (WS-TIME)
   884		      END-EXEC
   903		      EXEC CICS FORMATTIME
   904			  ABSTIME      (WS-TIME)
   905                    DATESEP      ('-')
   906			  MMDDYY   (DATEO)
   907		      TIME     (TIMEO)
   908                TIMESEP  (':')
   909		  END-EXEC
   949		  MOVE DFHBMASB TO TIMEA
   950		  MOVE DFHBMASB TO DATEA
   951		  MOVE DFHUNIMD TO OPTIONA
   953		  EXEC CICS
   954                SEND MAP('SW00M')
   955                     MAPSET('SW00S')
   956			   FROM(SW00MO)
   957			   ERASE
   958		  END-EXEC.
   995	      100-EXIT.
   996		  EXIT.
   997
   998	      300-PROCESS-TRAN.
  1000		  EXEC CICS
  1001               RECEIVE MAP('SW00M')
  1002                       MAPSET('SW00S')
  1003			     INTO (SW00MI)
  1004		  END-EXEC
  1037		  EVALUATE TRUE
  1038		      WHEN OPTIONL = 0 OR OPTIONI = SPACE
  1039                    MOVE 'OPTION IS REQUIRED' TO ERRMSGO
  1040			  MOVE DFHBMBRY TO OPTIONA
  1041		      WHEN OPTIONI = 1
  1042                    IF WS-CHC1 = '- USER MAINTENANCE'  1043			      PERFORM 700-TRANSFER-PROG
  1044			      IF EIBCALEN = +0
  1046				  EXEC CICS XCTL
  1047                                PROGRAM('UA001P')
  1048				  END-EXEC
  1067			      ELSE
  1069				  EXEC CICS XCTL
  1070                                PROGRAM('UA001P')
  1071				      COMMAREA(WS-COMMAREA)
  1072				  END-EXEC
  1096			      END-IF
  1097			  END-IF
  1098                    IF WS-CHC1 = '- SEARCH TICKET'
  1100			      EXEC CICS XCTL
  1101                            PROGRAM('SM001P')
  1102			      END-EXEC
  1121			  END-IF
  1122		      WHEN OPTIONI = 2
  1123                    IF WS-CHC2 = '- ADD TICKET'
  1124			      PERFORM 700-TRANSFER-PROG
  1125			      IF TIXNOL NOT = +0
  1126				  PERFORM 900-NO-TIX
  1127			      END-IF
  1128			      IF EIBCALEN = +0
  1130				  EXEC CICS XCTL
  1131                                PROGRAM('SM02P')
  1132				  END-EXEC
  1151			      ELSE
  1153				  EXEC CICS XCTL
  1154                                PROGRAM('SM02P')
  1155				      COMMAREA(WS-COMMAREA)
  1156				  END-EXEC
  1180			      END-IF
  1181			  END-IF
  1182                    IF WS-CHC2 = '- UPDATE TICKET'
  1183			      PERFORM 700-TRANSFER-PROG
  1184			      IF TIXNOL NOT = +0
  1185				  PERFORM 900-NO-TIX
  1186			      END-IF
  1187			      IF EIBCALEN = +0
  1189				  EXEC CICS XCTL
  1190                                PROGRAM('SM03P')
  1191				  END-EXEC
  1210			      ELSE
  1212				  EXEC CICS XCTL
  1213                                PROGRAM('SM03P')
  1214				      COMMAREA(WS-COMMAREA)
  1215				  END-EXEC
  1239			      END-IF
  1240			  END-IF
  1241                    IF WS-CHC2 = '- APPROVE TICKET'
  1242			      IF TIXNOL NOT = +0
  1243				  PERFORM 700-TRANSFER-PROG
  1244			      END-IF
  1245			      PERFORM 800-NEED-TIX
  1246			      IF EIBCALEN = +0
  1248				  EXEC CICS XCTL
  1249                                PROGRAM('SM005')
  1250				  END-EXEC
  1269			      ELSE  1271				  EXEC CICS XCTL
  1272                                PROGRAM('SM005')
  1273				      COMMAREA(WS-COMMAREA)
  1274				  END-EXEC
  1298			      END-IF
  1299			  END-IF
  1300			  IF WS-CHC2 = LOW-VALUES
  1301                        MOVE 'INVALID OPTION' TO ERRMSGO
  1302			      PERFORM 100-SEND-MAP
  1303			  END-IF
  1304		      WHEN OPTIONI = 3
  1305                    IF WS-CHC3 = '- USER MAINTENANCE'
  1306			      PERFORM 700-TRANSFER-PROG
  1307			      IF EIBCALEN = +0
  1309				  EXEC CICS XCTL
  1310                                PROGRAM('UA001P')
  1311				  END-EXEC
  1330			      ELSE
  1332				  EXEC CICS XCTL
  1333                                PROGRAM('UA001P')
  1334				      COMMAREA(WS-COMMAREA)
  1335				  END-EXEC
  1359			      END-IF
  1360			  END-IF
  1361                    IF WS-CHC3 = '- APPROVE TICKET'
  1362			      PERFORM 700-TRANSFER-PROG
  1363			      IF TIXNOL NOT = +0
  1364				  PERFORM 800-NEED-TIX
  1365			      END-IF
  1366			      IF EIBCALEN = +0
  1368				  EXEC CICS XCTL
  1369                                PROGRAM('SM005')
  1370				  END-EXEC
  1389			      ELSE
  1391				  EXEC CICS XCTL
  1392                                PROGRAM('SM005')
  1393				      COMMAREA(WS-COMMAREA)
  1394				  END-EXEC
  1418			      END-IF
  1419			  END-IF
  1420                    IF WS-CHC3 = '- UPDATE TICKET'
  1421			      PERFORM 700-TRANSFER-PROG
  1422			      IF TIXNOL NOT = +0
  1423				  PERFORM 800-NEED-TIX
  1424			      END-IF
  1425			      IF EIBCALEN = +0
  1427				  EXEC CICS XCTL
  1428                                PROGRAM('SM03P')
  1429				      COMMAREA(WS-COMMAREA)
  1430				  END-EXEC
  1454			      ELSE
  1456				  EXEC CICS XCTL
  1457                                PROGRAM('SM03P')
  1458				      COMMAREA(WS-COMMAREA)
  1459				  END-EXEC
  1483			      END-IF
  1484			  END-IF
  1485			  IF WS-CHC3 = LOW-VALUES
  1486                        MOVE 'INVALID OPTION' TO ERRMSGO
  1487			      PERFORM 100-SEND-MAP  1488			  END-IF
  1489		      WHEN OPTIONI = 4
  1490                    IF WS-CHC4 = '- USER MAINTENANCE'
  1491			      PERFORM 700-TRANSFER-PROG
  1492			      IF EIBCALEN = +0
  1494				  EXEC CICS XCTL
  1495                                PROGRAM('UA001P')
  1496				  END-EXEC
  1515			      ELSE
  1517				  EXEC CICS XCTL
  1518                                PROGRAM('UA001P')
  1519				      COMMAREA(WS-COMMAREA)
  1520				  END-EXEC
  1544			      END-IF
  1545			  END-IF
  1546                    IF WS-CHC4 = '- CLOSE TICKET'
  1547			      PERFORM 700-TRANSFER-PROG
  1548			      IF TIXNOL NOT = +0
  1549				  PERFORM 800-NEED-TIX
  1550			      END-IF
  1551			      IF EIBCALEN = +0
  1553				  EXEC CICS XCTL
  1554                                PROGRAM('SM004')
  1555				      COMMAREA(WS-COMMAREA)
  1556				  END-EXEC
  1580			      ELSE
  1582				  EXEC CICS XCTL
  1583                                PROGRAM('SM004')
  1584				      COMMAREA(WS-COMMAREA)
  1585				  END-EXEC
  1609			      END-IF
  1610			  END-IF
  1611			  IF WS-CHC4 = LOW-VALUES
  1612                        MOVE 'INVALID OPTION' TO ERRMSGO
  1613			      PERFORM 100-SEND-MAP
  1614			  END-IF
  1615		      WHEN OPTIONI = 5
  1616                    IF WS-CHC5 = '- CANCEL TICKET'
  1617			      PERFORM 700-TRANSFER-PROG
  1618			      IF TIXNOL NOT = +0
  1619				  PERFORM 800-NEED-TIX
  1620			      END-IF
  1621			      IF EIBCALEN = +0
  1623				  EXEC CICS XCTL
  1624                                PROGRAM('SM006P')
  1625				  END-EXEC
  1644			      ELSE
  1646				  EXEC CICS XCTL
  1647                                PROGRAM('SM006P')
  1648				      COMMAREA(WS-COMMAREA)
  1649				  END-EXEC
  1673			      END-IF
  1674			  END-IF
  1675			  IF WS-CHC5 = LOW-VALUES
  1676                        MOVE 'INVALID OPTION' TO ERRMSGO
  1677			      PERFORM 100-SEND-MAP
  1678			  END-IF
  1679		      WHEN OPTIONI = 6
  1680                    IF WS-CHC6 = '- APPROVE TICKET'
  1681			      PERFORM 700-TRANSFER-PROG  1682			      IF TIXNOL NOT = +0
  1683				  PERFORM 800-NEED-TIX
  1684			      END-IF
  1685			      IF EIBCALEN = +0
  1687				  EXEC CICS XCTL
  1688                                PROGRAM('SM005')
  1689				  END-EXEC
  1708			      ELSE
  1710				  EXEC CICS XCTL
  1711                                PROGRAM('SM005')
  1712				      COMMAREA(WS-COMMAREA)
  1713				  END-EXEC
  1737			      END-IF
  1738			  END-IF
  1739                    IF WS-CHC6 = '- USER MAINTENANCE'
  1740			      PERFORM 700-TRANSFER-PROG
  1741			      IF EIBCALEN = +0
  1743				  EXEC CICS XCTL
  1744                                PROGRAM('UA001P')
  1745				  END-EXEC
  1764			      ELSE
  1766				  EXEC CICS XCTL
  1767                                PROGRAM('UA001P')
  1768				      COMMAREA(WS-COMMAREA)
  1769				  END-EXEC
  1793			      END-IF
  1794			  END-IF
  1795			  IF WS-CHC6 = LOW-VALUES
  1796                        MOVE 'INVALID OPTION' TO ERRMSGO
  1797			      PERFORM 100-SEND-MAP
  1798			  END-IF
  1799		      WHEN OPTIONI = 7
  1800                    IF WS-CHC7 = '- USER MAINTENANCE'
  1801			      PERFORM 700-TRANSFER-PROG
  1802			      IF EIBCALEN = +0
  1804				  EXEC CICS XCTL
  1805                                PROGRAM('UA001P')
  1806				  END-EXEC
  1825			      ELSE
  1827				  EXEC CICS XCTL
  1828                                PROGRAM('UA001P')
  1829				      COMMAREA(WS-COMMAREA)
  1830				  END-EXEC
  1854			      END-IF
  1855			  END-IF
  1856			  IF WS-CHC7 = LOW-VALUES
  1857                        MOVE 'INVALID OPTION' TO ERRMSGO
  1858			      PERFORM 100-SEND-MAP
  1859			  END-IF
  1860		      WHEN OPTIONI NOT = 1 OR 2 OR 3 OR 4 OR 5 OR 6 OR 7
  1861			  IF WS-CHC7 = LOW-VALUES
  1862                        MOVE 'INVALID OPTION' TO ERRMSGO
  1863			      PERFORM 100-SEND-MAP
  1864			  END-IF
  1865		  END-EVALUATE
  1866		  PERFORM 100-SEND-MAP.
  1867	      300-EXIT.
  1868		  EXIT.
  1869
  1870	      400-SEARCH-USER.  1872		  EXEC CICS ASSIGN
  1873		      USERID(WS-USERID)
  1874		  END-EXEC
  1893		  EXEC CICS
  1894                READ FILE('UAF00001')
  1895		      INTO (WS-USER-REC)
  1896		      RIDFLD (WS-USERID)
  1897		      RESP(WS-RESPONSE-CODE)
  1898		      GTEQ
  1899		  END-EXEC
  1937            IF WS-RESPONSE-CODE NOT = +00 OR (REQUESTOR = 'N' AND
  1938                                      SERVICE-PROVIDER = 'N' AND APPROVER
  1939                                          = 'N' AND ADMINISTRATOR = 'N')
  1941		      EXEC CICS SEND TEXT
  1942			  FROM (WS-INVALID)
  1943			  LENGTH (+25)
  1944			  ERASE
  1945		      END-EXEC
  1976		      EXEC CICS RETURN END-EXEC
  1989		  ELSE
  1990		   MOVE WS-USERID TO USERID
  1991		   MOVE 1 TO WS-PROG-STATE
  1992		  END-IF
  1993            IF REQUESTOR = 'Y'
  1994                MOVE '- SEARCH TICKET' TO WS-CHOICE
  1995		      PERFORM 500-MOVE-CHOICE-VAL
  1996                MOVE '- ADD TICKET' TO WS-CHOICE
  1997		      PERFORM 500-MOVE-CHOICE-VAL
  1998                MOVE '- UPDATE TICKET' TO WS-CHOICE
  1999		      PERFORM 500-MOVE-CHOICE-VAL
  2000                MOVE '- CLOSE TICKET' TO WS-CHOICE
  2001		      PERFORM 500-MOVE-CHOICE-VAL
  2002                MOVE '- CANCEL TICKET' TO WS-CHOICE
  2003		      PERFORM 500-MOVE-CHOICE-VAL
  2004		  END-IF
  2005            IF SERVICE-PROVIDER = 'Y'
  2006                IF NOT REQUESTOR = 'Y'
  2007                    MOVE '- SEARCH TICKET' TO WS-CHOICE
  2008			  PERFORM 500-MOVE-CHOICE-VAL
  2009                    MOVE '- UPDATE TICKET' TO WS-CHOICE
  2010			  PERFORM 500-MOVE-CHOICE-VAL
  2011		      ELSE
  2012			  CONTINUE
  2013		      END-IF
  2014		  END-IF
  2015            IF APPROVER = 'Y'
  2016                IF NOT (REQUESTOR = 'Y' OR SERVICE-PROVIDER = 'Y')
  2017                    MOVE '- SEARCH TICKET' TO WS-CHOICE
  2018			  PERFORM 500-MOVE-CHOICE-VAL
  2019		      ELSE
  2020                    MOVE '- APPROVE TICKET' TO WS-CHOICE
  2021			  PERFORM 500-MOVE-CHOICE-VAL
  2022		      END-IF
  2023		  END-IF
  2024            IF ADMINISTRATOR = 'Y'
  2025                MOVE '- USER MAINTENANCE' TO WS-CHOICE
  2026		      PERFORM 500-MOVE-CHOICE-VAL
  2027		  END-IF.
  2028	      400-EXIT.
  2029		  EXIT.  2030
  2031	      500-MOVE-CHOICE-VAL.
  2032		  EVALUATE TRUE
  2033		      WHEN OPTCHC1O = LOW-VALUES
  2034			  MOVE WS-INDEX TO OPTNO1O
  2035			  MOVE WS-CHOICE TO OPTCHC1O
  2036			  MOVE WS-CHOICE TO WS-CHC1
  2037			  ADD 1 TO WS-INDEX
  2038		      WHEN OPTCHC2O = LOW-VALUES
  2039			  MOVE WS-INDEX TO OPTNO2O
  2040			  MOVE WS-CHOICE TO OPTCHC2O
  2041			  MOVE WS-CHOICE TO WS-CHC2
  2042			  ADD 1 TO WS-INDEX
  2043		      WHEN OPTCHC3O = LOW-VALUES
  2044			  MOVE WS-INDEX TO OPTNO3O
  2045			  MOVE WS-CHOICE TO OPTCHC3O
  2046			  MOVE WS-CHOICE TO WS-CHC3
  2047			  ADD 1 TO WS-INDEX
  2048		      WHEN OPTCHC4O = LOW-VALUES
  2049			  MOVE WS-INDEX TO OPTNO4O
  2050			  MOVE WS-CHOICE TO OPTCHC4O
  2051			  MOVE WS-CHOICE TO WS-CHC4
  2052			  ADD 1 TO WS-INDEX
  2053		      WHEN OPTCHC5O = LOW-VALUES
  2054			  MOVE WS-INDEX TO OPTNO5O
  2055			  MOVE WS-CHOICE TO OPTCHC5O
  2056			  MOVE WS-CHOICE TO WS-CHC5
  2057			  ADD 1 TO WS-INDEX
  2058		      WHEN OPTCHC6O = LOW-VALUES
  2059			  MOVE WS-INDEX TO OPTNO6O
  2060			  MOVE WS-CHOICE TO OPTCHC6O
  2061			  MOVE WS-CHOICE TO WS-CHC6
  2062			  ADD 1 TO WS-INDEX
  2063		      WHEN OPTCHC7O = LOW-VALUES
  2064			  MOVE WS-INDEX TO OPTNO7O
  2065			  MOVE WS-CHOICE TO OPTCHC7O
  2066			  MOVE WS-CHOICE TO WS-CHC7
  2067			  ADD 1 TO WS-INDEX
  2068		  END-EVALUATE.
  2069	      500-EXIT.
  2070		  EXIT.
  2071
  2072	      600-VALIDATE-TICKET.
  2074		  EXEC CICS
  2075                READ FILE('STF00001')
  2076		      INTO (WS-TIX-REC)
  2077		      RIDFLD (WS-TICKET-NUM1)
  2078		      RESP(WS-RESPONSE-CODE)
  2079		      EQUAL
  2080		  END-EXEC
  2119		  IF EIBRESP = DFHRESP(NOTFND)
  2121		  IF EIBRESP =	       013				       R
  2122                MOVE 'N' TO WS-VALID-TIX-FLAG
  2123		  ELSE
  2124                MOVE 'Y' TO WS-VALID-TIX-FLAG
  2125		      MOVE 1 TO WS-PROG-STATE
  2126
  2127                IF WS-CHC2 = '- ADD TICKET'
  2128		       IF WS-TICKET-NUM = SPACES
  2129                  MOVE '0' TO WS-TICKET-NUM  2130		       END-IF
  2131		      END-IF
  2132		  END-IF.
  2133	      600-EXIT.
  2134		  EXIT.
  2135
  2136	      700-TRANSFER-PROG.
  2137		  IF TIXNOI = SPACES OR TIXNOL = ZERO OR TIXNOI = LOW-VALUES
  2138		      MOVE TIXNOI TO WS-TICKET-NUM1
  2139		      MOVE +0 TO EIBCALEN
  2140                MOVE '0' TO WS-TICKET-NUM
  2141		  ELSE
  2142                MOVE 'N' TO WS-INIT
  2143		      MOVE TIXNOI TO WS-TICKET-NUM1
  2144		      PERFORM 600-VALIDATE-TICKET
  2145		  END-IF.
  2146	      700-EXIT.
  2147		  EXIT.
  2148
  2149	      800-NEED-TIX.
  2150            IF WS-VALID-TIX-FLAG = 'N'
  2151		      MOVE WS-INVALID-TICKET TO ERRMSGO
  2152		      PERFORM 600-VALIDATE-TICKET
  2153		      PERFORM 100-SEND-MAP
  2155		      EXEC CICS RETURN
  2156                    TRANSID('SM00')
  2157			  COMMAREA(WS-COMMAREA)
  2158		      END-EXEC
  2182		  END-IF.
  2183	      800-EXIT.
  2184		  EXIT.
  2185
  2186	      900-NO-TIX.
  2187            IF WS-VALID-TIX-FLAG = 'Y'
  2188		      MOVE WS-DUP-TICKET TO ERRMSGO
  2189		      PERFORM 600-VALIDATE-TICKET
  2190		      PERFORM 100-SEND-MAP
  2192		      EXEC CICS RETURN
  2193                    TRANSID('SM00')
  2194			  COMMAREA(WS-COMMAREA)
  2195		      END-EXEC
  2219		  END-IF.
  2220	      900-EXIT.
  2221		  EXIT.CA-Realia COBOL Version 6.0.45	 C:\handson-cics\CAWB30\sm000p.cic     PAGE   20



			Realia COBOL Compiler Version Information

			      Pass 1	 Version 6.072
			      Pass 1a	 Version 6.015
			      Pass 2	 Version 6.068
			      Pass 2a	 Version 6.020
			      Pass 3	 Version 6.094
			      Pass 4	 Version 6.007
			      Pass 5	 Version 6.022


			Compilation Directives in Effect

COMP-4		  DCHK		    OPT 	      NOCALL
NOSUBCHK	  STRCHK	    NOTRUNC	      NOSMALLCOMP
NODCALL 	  NODIVZERO	    NOEPDCALL	      APOST
EBCDIC		  STATABORT	    NOMOVELINK	      NOBLL4K
ARGCHK		  UPLOW 	    NOVERARG	      MDY
LP:   60	  PP		    FCREATE	      NOIEEE
NOLILIAN	  CURRENCY-SIGN=$   WRITEAFTER	      SOSI
NOCOPY68	  NOFLAG-COM	    NOFLAG-SEG	      NOFLAG-FIPS
DEBUGXREF	  DIALECT-VS2

			Error level limit: W

			Source lines compiled:	    2232
			Compilation time (mm:ss.ss):  0:00.06
			Compilation speed (lines/minute): 32000

			Compilation date (yy/mm/dd): 23/12/04
			     Time of day (hh:mm:ss): 13:01:00