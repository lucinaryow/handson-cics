     5	     *	CBL XOPTS(COBOL2)
    20	      IDENTIFICATION DIVISION.
    21	      PROGRAM-ID. SM000P.
    22
    23	      ENVIRONMENT DIVISION.
    24	      CONFIGURATION SECTION.
    25	      SOURCE-COMPUTER.	  IBM-PC.
    26	      OBJECT-COMPUTER.	  IBM-PC.
    27	      DATA DIVISION.
    28	      WORKING-STORAGE SECTION.
    74	      01  WS-TIME			  PIC 9(15) COMP-3.
    75	      01  WS-DATE				PIC 9(7).
    76	      01  WS-DATE-X REDEFINES WS-DATE		PIC X(7).
    77        01  WS-VALID-TIX-FLAG                     PIC X VALUE 'Y'.
    78	      01  WS-LENGTH				PIC S9(4) COMP.
    79	      01  WS-INDEX				PIC 9 VALUE 1.
    80	      01  WS-CHOICE				PIC X(21).
    81	      01  WS-CHOICE-PH.
    82		  05  WS-CHC1				PIC X(21).
    83		  05  WS-CHC2				PIC X(21).
    84		  05  WS-CHC3				PIC X(21).
    85		  05  WS-CHC4				PIC X(21).
    86		  05  WS-CHC5				PIC X(21).
    87		  05  WS-CHC6				PIC X(21).
    88		  05  WS-CHC7				PIC X(21).
    89	      01  WS-USERID				PIC X(7).
    90	      01  WS-TIXID				PIC X(6).
    91	      01  WS-RESPONSE-CODE    PIC S9(8) COMP.
    92	      01  WS-LOGID.
    93		  05  LOGID2				PIC X(6).
    94		  05  FILLER				PIC X.
    95	      01  WS-USER-REC.
    96		  05  USERID.
    97		      10  USERID1			PIC X(7).
    98		      10  FILLER			PIC X.
    99		  05  REQUESTOR 			PIC X.
   100		  05  ADMINISTRATOR			PIC X.
   101		  05  APPROVER				PIC X.
   102		  05  SERVICE-PROVIDER			PIC X.
   103		  05  UPDATED-BY1.
   104		      10  UPDBY1			PIC X(7).
   105		      10  FILLER			PIC X.
   106	      01  WS-TIX-REC.
   107		  05  TIX-ID				PIC X(06).
   108		  05  TIX-REQUESTOR			PIC X(08).
   109		  05  TIX-STATUS			PIC X(10).
   110		  05  TIX-TITLE 			PIC X(25).
   111		  05  TIX-DESC				PIC X(100).
   112		  05  TIX-DESC-RED REDEFINES TIX-DESC.
   113		      10  TIX-DESC1			PIC X(50).
   114		      10  TIX-DESC2			PIC X(50).
   115		  05  LAST-UPDATE			PIC X(20).
   116		  05  LAST-UPDATE-RED REDEFINES LAST-UPDATE.
   117		      10  LAST-UPDATE-DATE		PIC X(11).
   118		      10  LAST-UPDATE-TIME		PIC X(09).
   119		  05  UPDATED-BY2.
   120		      10  UPDBY2			PIC X(7).
   121		      10  FILLER			PIC X.
   122		  05  LAST-UPDATE-REM			PIC X(50).
   123		  05  LAST-UPDATE-REMW REDEFINES LAST-UPDATE-REM.   124		      10  LAST-UPDATE-REM1		PIC X(25).
   125		      10  LAST-UPDATE-REM2		PIC X(25).
   126	      01  WS-END				PIC X(15) VALUE
   127            'END PROCESSING'.
   128	      01  WS-INVKEY				PIC X(21) VALUE
   129            'INVALID PFKEY PRESSED'.
   130	      01  WS-INVALID			  PIC X(14) VALUE
   131            'INVALID ACCESS'.
   132	      01  WS-INVALID-TICKET			  PIC X(28) VALUE
   133            'TICKET NUMBER DOES NOT EXIST'.
   134	      01  WS-DUP-TICKET 			  PIC X(28) VALUE
   135            'DUPLICATE TICKET NUMBER'.
   136	      01  WS-INVALID-USER			  PIC X(24) VALUE
   137            'INVALID ACCESS TO TICKET'.
   138	      01  WS-COMMAREA.
   139		  05  WS-USERID1			 PIC X(7).
   140		  05  WS-TICKET-NUM.
   141		      10  WS-TICKET-NUM1		 PIC X(6).
   142		      10  FILLER			 PIC X.
   143		  05  WS-PROG-STATE			 PIC 9(1).
   144            05  WS-INIT                            PIC X VALUE 'Y'.
   145		  05  WS-TCKID				 PIC X(6).
   146		  05  WS-TCKREQ 			 PIC X(8).
   147		  05  WS-TCKSTAT			 PIC X(10).
   148		  05  WS-TCKTTL 			 PIC X(25).
   149		  05  WS-TCKDESC			 PIC X(100).
   150		  05  WS-LSTUPD 			 PIC X(20).
   151		  05  WS-STUPDBY			 PIC X(8).
   152		  05  WS-LSTUPDRMK			 PIC X(50).
   153		  05  WS-REQUESTOR			 PIC X.
   154		  05  WS-ADMINISTRATOR			 PIC X.
   155		  05  WS-APPROVER			 PIC X.
   156		  05  WS-SERVICE-PROVIDER		 PIC X.
   157
   158
   159	     *
   160		  COPY SM000S.
   162	     * SYMBOLIC MAP of sm000s Created by CACXBMS Version 6.0.27
   163	      01  SW00MI.
   164		  02  FILLER				     PIC X(12).
   165		  02  OPTCHC1L				     PIC S9(4) COMP.
   166		  02  OPTCHC1F				     PIC X.
   167		  02  FILLER REDEFINES OPTCHC1F.
   168		      03  OPTCHC1A			     PIC X.
   169		  02  OPTCHC1I				     PIC X(021).
   170		  02  OPTNO1L				     PIC S9(4) COMP.
   171		  02  OPTNO1F				     PIC X.
   172		  02  FILLER REDEFINES OPTNO1F.
   173		      03  OPTNO1A			     PIC X.
   174		  02  OPTNO1I				     PIC X(001).
   175		  02  OPTCHC2L				     PIC S9(4) COMP.
   176		  02  OPTCHC2F				     PIC X.
   177		  02  FILLER REDEFINES OPTCHC2F.
   178		      03  OPTCHC2A			     PIC X.
   179		  02  OPTCHC2I				     PIC X(021).
   180		  02  OPTNO2L				     PIC S9(4) COMP.
   181		  02  OPTNO2F				     PIC X.
   182		  02  FILLER REDEFINES OPTNO2F.
   183		      03  OPTNO2A			     PIC X.
   184		  02  OPTNO2I				     PIC X(001).   185		  02  OPTCHC3L				     PIC S9(4) COMP.
   186		  02  OPTCHC3F				     PIC X.
   187		  02  FILLER REDEFINES OPTCHC3F.
   188		      03  OPTCHC3A			     PIC X.
   189		  02  OPTCHC3I				     PIC X(021).
   190		  02  OPTNO3L				     PIC S9(4) COMP.
   191		  02  OPTNO3F				     PIC X.
   192		  02  FILLER REDEFINES OPTNO3F.
   193		      03  OPTNO3A			     PIC X.
   194		  02  OPTNO3I				     PIC X(001).
   195		  02  OPTCHC4L				     PIC S9(4) COMP.
   196		  02  OPTCHC4F				     PIC X.
   197		  02  FILLER REDEFINES OPTCHC4F.
   198		      03  OPTCHC4A			     PIC X.
   199		  02  OPTCHC4I				     PIC X(021).
   200		  02  OPTNO4L				     PIC S9(4) COMP.
   201		  02  OPTNO4F				     PIC X.
   202		  02  FILLER REDEFINES OPTNO4F.
   203		      03  OPTNO4A			     PIC X.
   204		  02  OPTNO4I				     PIC X(001).
   205		  02  OPTCHC5L				     PIC S9(4) COMP.
   206		  02  OPTCHC5F				     PIC X.
   207		  02  FILLER REDEFINES OPTCHC5F.
   208		      03  OPTCHC5A			     PIC X.
   209		  02  OPTCHC5I				     PIC X(021).
   210		  02  OPTNO5L				     PIC S9(4) COMP.
   211		  02  OPTNO5F				     PIC X.
   212		  02  FILLER REDEFINES OPTNO5F.
   213		      03  OPTNO5A			     PIC X.
   214		  02  OPTNO5I				     PIC X(001).
   215		  02  OPTCHC6L				     PIC S9(4) COMP.
   216		  02  OPTCHC6F				     PIC X.
   217		  02  FILLER REDEFINES OPTCHC6F.
   218		      03  OPTCHC6A			     PIC X.
   219		  02  OPTCHC6I				     PIC X(021).
   220		  02  OPTNO6L				     PIC S9(4) COMP.
   221		  02  OPTNO6F				     PIC X.
   222		  02  FILLER REDEFINES OPTNO6F.
   223		      03  OPTNO6A			     PIC X.
   224		  02  OPTNO6I				     PIC X(001).
   225		  02  OPTCHC7L				     PIC S9(4) COMP.
   226		  02  OPTCHC7F				     PIC X.
   227		  02  FILLER REDEFINES OPTCHC7F.
   228		      03  OPTCHC7A			     PIC X.
   229		  02  OPTCHC7I				     PIC X(021).
   230		  02  OPTNO7L				     PIC S9(4) COMP.
   231		  02  OPTNO7F				     PIC X.
   232		  02  FILLER REDEFINES OPTNO7F.
   233		      03  OPTNO7A			     PIC X.
   234		  02  OPTNO7I				     PIC X(001).
   235		  02  OPTIONL				     PIC S9(4) COMP.
   236		  02  OPTIONF				     PIC X.
   237		  02  FILLER REDEFINES OPTIONF.
   238		      03  OPTIONA			     PIC X.
   239		  02  OPTIONI				     PIC X(001).
   240		  02  TIXNOL				     PIC S9(4) COMP.
   241		  02  TIXNOF				     PIC X.
   242		  02  FILLER REDEFINES TIXNOF.
   243		      03  TIXNOA			     PIC X.
   244		  02  TIXNOI				     PIC X(006).   245		  02  ERRMSGL				     PIC S9(4) COMP.
   246		  02  ERRMSGF				     PIC X.
   247		  02  FILLER REDEFINES ERRMSGF.
   248		      03  ERRMSGA			     PIC X.
   249		  02  ERRMSGI				     PIC X(071).
   250		  02  DATEL				     PIC S9(4) COMP.
   251		  02  DATEF				     PIC X.
   252		  02  FILLER REDEFINES DATEF.
   253		      03  DATEA 			     PIC X.
   254		  02  DATEI				     PIC X(010).
   255		  02  TIMEL				     PIC S9(4) COMP.
   256		  02  TIMEF				     PIC X.
   257		  02  FILLER REDEFINES TIMEF.
   258		      03  TIMEA 			     PIC X.
   259		  02  TIMEI				     PIC X(008).
   260	      01  SW00MO REDEFINES SW00MI.
   261		  02  FILLER				     PIC X(12).
   262		  02  FILLER				     PIC XX.
   263		  02  FILLER				     PIC X.
   264		  02  OPTCHC1O				     PIC X(021).
   265		  02  FILLER				     PIC XX.
   266		  02  FILLER				     PIC X.
   267		  02  OPTNO1O				     PIC X(001).
   268		  02  FILLER				     PIC XX.
   269		  02  FILLER				     PIC X.
   270		  02  OPTCHC2O				     PIC X(021).
   271		  02  FILLER				     PIC XX.
   272		  02  FILLER				     PIC X.
   273		  02  OPTNO2O				     PIC X(001).
   274		  02  FILLER				     PIC XX.
   275		  02  FILLER				     PIC X.
   276		  02  OPTCHC3O				     PIC X(021).
   277		  02  FILLER				     PIC XX.
   278		  02  FILLER				     PIC X.
   279		  02  OPTNO3O				     PIC X(001).
   280		  02  FILLER				     PIC XX.
   281		  02  FILLER				     PIC X.
   282		  02  OPTCHC4O				     PIC X(021).
   283		  02  FILLER				     PIC XX.
   284		  02  FILLER				     PIC X.
   285		  02  OPTNO4O				     PIC X(001).
   286		  02  FILLER				     PIC XX.
   287		  02  FILLER				     PIC X.
   288		  02  OPTCHC5O				     PIC X(021).
   289		  02  FILLER				     PIC XX.
   290		  02  FILLER				     PIC X.
   291		  02  OPTNO5O				     PIC X(001).
   292		  02  FILLER				     PIC XX.
   293		  02  FILLER				     PIC X.
   294		  02  OPTCHC6O				     PIC X(021).
   295		  02  FILLER				     PIC XX.
   296		  02  FILLER				     PIC X.
   297		  02  OPTNO6O				     PIC X(001).
   298		  02  FILLER				     PIC XX.
   299		  02  FILLER				     PIC X.
   300		  02  OPTCHC7O				     PIC X(021).
   301		  02  FILLER				     PIC XX.
   302		  02  FILLER				     PIC X.
   303		  02  OPTNO7O				     PIC X(001).
   304		  02  FILLER				     PIC XX.   305		  02  FILLER				     PIC X.
   306		  02  OPTIONO				     PIC X(001).
   307		  02  FILLER				     PIC XX.
   308		  02  FILLER				     PIC X.
   309		  02  TIXNOO				     PIC X(006).
   310		  02  FILLER				     PIC XX.
   311		  02  FILLER				     PIC X.
   312		  02  ERRMSGO				     PIC X(071).
   313		  02  FILLER				     PIC XX.
   314		  02  FILLER				     PIC X.
   315		  02  DATEO				     PIC X(010).
   316		  02  FILLER				     PIC XX.
   317		  02  FILLER				     PIC X.
   318		  02  TIMEO				     PIC X(008).
   320	     *
   321		  COPY DFHAID.
   323	      01  DFHAID.
   324	     *
   325	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   326	     *
   327	     * Revision Information
   328	     * ^{File:dfhaid.cob  }
   329	     * ^{Timestamp:Thu May 15 14:02:52 1997}
   330	     * ^{Revision:2.0}
   331	     *
   332	     *This is the AID constants copy file
   333	     *
   334            05  DFHENTER                  PIC X VALUE ''''.
   335	     *					value APOST
   336            05  DFHCLEAR                  PIC X VALUE '_'.
   337            05  DFHPA1                    PIC X VALUE '%'.
   338            05  DFHPA2                    PIC X VALUE '>'.
   339            05  DFHPA3                    PIC X VALUE ','.
   340            05  DFHPF1                    PIC X VALUE '1'.
   341            05  DFHPF2                    PIC X VALUE '2'.
   342            05  DFHPF3                    PIC X VALUE '3'.
   343            05  DFHPF4                    PIC X VALUE '4'.
   344            05  DFHPF5                    PIC X VALUE '5'.
   345            05  DFHPF6                    PIC X VALUE '6'.
   346            05  DFHPF7                    PIC X VALUE '7'.
   347            05  DFHPF8                    PIC X VALUE '8'.
   348            05  DFHPF9                    PIC X VALUE '9'.
   349            05  DFHPF10                   PIC X VALUE ':'.
   350            05  DFHPF11                   PIC X VALUE '#'.
   351            05  DFHPF12                   PIC X VALUE '@'.
   352            05  DFHPF13                   PIC X VALUE 'A'.
   353            05  DFHPF14                   PIC X VALUE 'B'.
   354            05  DFHPF15                   PIC X VALUE 'C'.
   355            05  DFHPF16                   PIC X VALUE 'D'.
   356            05  DFHPF17                   PIC X VALUE 'E'.
   357            05  DFHPF18                   PIC X VALUE 'F'.
   358            05  DFHPF19                   PIC X VALUE 'G'.
   359            05  DFHPF20                   PIC X VALUE 'H'.
   360            05  DFHPF21                   PIC X VALUE 'I'.
   361            05  DFHPF22                   PIC X VALUE '›'.
   362       *                                  EBCDIC Cent sign x'4A'
   363       *                                  ASCII  Cent sign x'9B'
   364            05  DFHPF23                   PIC X VALUE '.'.
   365            05  DFHPF24                   PIC X VALUE '<'.
   366            05  DFHOPID                   PIC X VALUE 'W'.   367            05  DFHMSRE                   PIC X VALUE 'X'.
   368            05  DFHTRIG                   PIC X VALUE '"'.
   369       *                                        value QUOTE  "
   370            05  DFHPEN                    PIC X VALUE '='.
   371            05  DFHCLRP                   PIC X VALUE 'Ý'.
   372       *                                  EBCDIC x'6A'
   373       *                                  ASCII  x'DD'
   374            05  DFHSTRF                   PIC X VALUE 'h'.
   375	     *	  DFHQUIT is a CA-Realia CICS Extension
   376	     *	  It is set by using <Ctrl>+C or <Ctrl>+<Break> Keys
   377            05  DFHQUIT                   PIC X VALUE '!'.
   378		  05  DFHNULL			PIC X VALUE LOW-VALUE.
   380	     *
   381	      COPY DFHBMSCA.
   383	      01  DFHBMSCA.
   384	     *
   385	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   386	     *
   387	     * Revision Information
   388	     * ^{File:dfhbmsca.cob}
   389	     * ^{Timestamp:Tue Oct 08 15:34:54 1996}
   390	     * ^{Revision:2.0}
   391	     *
   392	     *	Note:This FILE is provided with most values as quoted literals
   393	     *	     so that the file can be used for both ASCII and EBCDIC
   394	     *	     programs
   395	     *
   396	     *	     The only exceptions are some 3270 Data Stream Orders
   397	     *	     They use different Hexadecimal values for ASCII and
   398	     *	     EBCDIC and they cannot be expressed as quoted literals
   399	     *	     as the values are <Line Feed>, <Tab>, <End of File> etc.
   400	     *	     characters in ASCII
   401	     *
   402	     *	     They have their values set up to default to the EBCDIC
   403	     *	     values.
   404	     *
   405	     *	     3270 orders are only needed for EXEC CICS SEND and RECEIVE
   406	     *	     and SEND TEXT with imbedded format orders.
   407	     *	     If you use these values in ASCII programs the values
   408	     *	     must be changed.
   409	     *
   410	     *	     An alternative is to use REPLACING to change the values.
   411	     *
   412	     *	  i.e. COPY DFHBMSCA replacing
   413	     *			    ==005== BY ==009==	*> DFHPT
   414	     *			    ==021== BY ==010==	*> DFHNL
   415	     *			    ==040== BY ==021==	*> DFHSA
   416	     *			    ==041== BY ==031==	*> DFHSFE
   417	     *			    ==044== BY ==023==	*> DFHMF
   418	     *			    ==060== BY ==020==	*> DFHRA
   419	     *			    ==063== BY ==026==. *> DFHSUB
   420	     *
   421	     ******************************************************************
   422	     *BMS and Terminal Control - Order & Attributes constants	      *
   423	     ******************************************************************
   424	     *
   425	     *	  Field Attributes
   426	     *
   427            05  DFHBMASB                          PIC X VALUE '8'.
   428            05  DFHBMASF                          PIC X VALUE '1'.   429            05  DFHBMASK                          PIC X VALUE '0'.
   430            05  DFHBMBRY                          PIC X VALUE 'H'.
   431            05  DFHBMDAR                          PIC X VALUE '<'.
   432            05  DFHBMFSE                          PIC X VALUE 'A'.
   433            05  DFHBMPRF                          PIC X VALUE '/'.
   434            05  DFHBMPRO                          PIC X VALUE '-'.
   435            05  DFHBMUNN                          PIC X VALUE '&'.
   436            05  DFHBMUNP                          PIC X VALUE ' '.
   437            05  DFHUNNUM                          PIC X VALUE 'J'.
   438	     *
   439	     *	  partially supported
   440	     *
   441            05  DFHUNNOD                          PIC X VALUE '('.
   442            05  DFHUNIMD                          PIC X VALUE 'I'.
   443            05  DFHUNINT                          PIC X VALUE 'R'.
   444            05  DFHUNNON                          PIC X VALUE '('.
   445            05  DFHPROTI                          PIC X VALUE 'Y'.
   446            05  DFHPROTN                          PIC X VALUE '%'.
   447	     *
   448	     *	  These values are additions to mainframe constants
   449	     *
   450            05  DFHBMS-ASK-DARK                   PIC X VALUE '@'.
   451            05  DFHBMS-ASK-BRY-FSET               PIC X VALUE '9'.
   452            05  DFHBMS-ASK-DAR-FSET               PIC X VALUE ''''.
   453	     *						      VALUE APOST
   454            05  DFHBMS-PRO-BRY-FSET               PIC X VALUE 'Z'.
   455            05  DFHBMS-PRO-DAR-FSET               PIC X VALUE '_'.
   456            05  DFHBMS-NUM-BRY                    PIC X VALUE 'Q'.
   457            05  DFHBMS-NUM-DAR                    PIC X VALUE '*'.
   458            05  DFHBMS-NUM-DAR-FSET               PIC X VALUE ')'.
   459	     *
   460	     *	  Field Flag values
   461		  05  DFHBMEOF-VAL VALUE 128		PIC S9(4) COMP-4.
   462		  05  FILLER REDEFINES DFHBMEOF-VAL.
   463		      10  FILLER			PIC X.
   464		      10  DFHBMEOF			PIC X.
   465       *                                          x'80'.
   466		  05  DFHBMCUR-VAL VALUE 002		PIC S9(4) COMP-4.
   467		  05  FILLER REDEFINES DFHBMCUR-VAL.
   468		      10  FILLER			PIC X.
   469		      10  DFHBMCUR			PIC X.
   470       *                                          x'02'.
   471		  05  DFHBMMEC-VAL VALUE 130		PIC S9(4) COMP-4.
   472		  05  FILLER REDEFINES DFHBMMEC-VAL.
   473		      10  FILLER			PIC X.
   474		      10  DFHBMMEC			PIC X.
   475       *                                          x'82'.
   476       *                                          x'02'.
   477		  05  DFHBMFLG-VAL  VALUE 0		PIC S9(4) COMP-4.
   478		      88  DFHERASE			VALUES 128 130.
   479       *                                          x'80' X'82'
   480		      88  DFHCURSR			VALUES 002 130.
   481       *                                          x'02' X'82'
   482		  05  FILLER REDEFINES DFHBMFLG-VAL.
   483		      10  FILLER			PIC X.
   484		      10  DFHBMFLG			PIC X.
   485
   486		  05  DFHBMDUP-VAL VALUE 028		PIC S9(4) COMP-4.
   487		  05  FILLER REDEFINES DFHBMDUP-VAL.
   488		      10  FILLER			PIC X.   489		      10  DFHBMDUP			PIC X.
   490       *                                              x'1C'
   491	     *
   492	     ******************************************************************
   493	     *	  supported 327X Extended Attributes
   494	     *
   495	     *	  Extended COLOR Attributes
   496	     *
   497            05  DFHDFCOL                          PIC X VALUE '0'.
   498            05  DFHBLUE                           PIC X VALUE '1'.
   499            05  DFHRED                            PIC X VALUE '2'.
   500            05  DFHPINK                           PIC X VALUE '3'.
   501            05  DFHGREEN                          PIC X VALUE '4'.
   502            05  DFHTURQ                           PIC X VALUE '5'.
   503            05  DFHYELLO                          PIC X VALUE '6'.
   504            05  DFHNEUTR                          PIC X VALUE '7'.
   505	     *
   506	     *	  Extended HILIGHT Attributes
   507	     *
   508            05  DFHDFHI                           PIC X VALUE '0'.
   509            05  DFHBLINK                          PIC X VALUE '1'.
   510            05  DFHREVRS                          PIC X VALUE '2'.
   511            05  DFHUNDLN                          PIC X VALUE '4'.
   512	     *
   513	     ******************************************************************
   514	     *	  supported 327X Data Stream Orders
   515	     *
   516		  05  DFHSBA-VAL VALUE 017		 PIC S9(4) COMP-4.
   517		  05  FILLER REDEFINES DFHSBA-VAL.
   518		      10  FILLER			PIC X.
   519		      10  DFHSBA			PIC X.
   520       *                                              x'11'
   521		  05  DFHEUA-VAL VALUE 018		PIC S9(4) COMP-4.
   522		  05  FILLER REDEFINES DFHEUA-VAL.
   523		      10  FILLER			PIC X.
   524		      10  DFHEUA			PIC X.
   525       *                                              x'12'
   526		  05  DFHIC-VAL VALUE 019		PIC S9(4) COMP-4.
   527		  05  FILLER REDEFINES DFHIC-VAL.
   528		      10  FILLER			PIC X.
   529		      10  DFHIC 			PIC X.
   530       *                                              X'13'.
   531		  05  DFHSF-VAL VALUE 029		PIC S9(4) COMP-4.
   532		  05  FILLER REDEFINES DFHSF-VAL.
   533		      10  FILLER			PIC X.
   534		      10  DFHSF 			PIC X.
   535       *                                              X'1D'.
   536		  05  DFHPT-VAL VALUE 005		PIC S9(4) COMP-4.
   537		      88 DFHPT-VAL-EBCDIC		VALUE 5.
   538		      88 DFHPT-VAL-ASCII		VALUE 9.
   539		  05  FILLER REDEFINES DFHPT-VAL.
   540		      10  FILLER			PIC X.
   541		      10  DFHPT 			PIC X.
   542       *                                              EBCDIC X'05'.
   543       *                                              ASCII  X'09'.
   544		  05  DFHRA-VAL VALUE 060		PIC S9(4) COMP-4.
   545		      88 DFHRA-VAL-EBCDIC		VALUE 60.
   546		      88 DFHRA-VAL-ASCII		VALUE 20.
   547		  05  FILLER REDEFINES DFHRA-VAL.
   548		      10  FILLER			PIC X.   549		      10  DFHRA 			PIC X.
   550       *                                              EBCDIC x'3C'
   551       *                                              ASCII  x'14'
   552		  05  DFHSFE-VAL VALUE 041		PIC S9(4) COMP-4.
   553		      88 DFHSFE-VAL-EBCDIC		VALUE 41.
   554		      88 DFHSFE-VAL-ASCII		VALUE 31.
   555		  05  FILLER REDEFINES DFHSFE-VAL.
   556		      10  FILLER			PIC X.
   557		      10  DFHSFE			PIC X.
   558       *                                              EBCDIC x'29'
   559       *                                              ASCII  x'1F'
   560		  05  DFHMF-VAL VALUE 044		PIC S9(4) COMP-4.
   561		      88 DFHMF-VAL-EBCDIC		VALUE 44.
   562		      88 DFHMF-VAL-ASCII		VALUE 23.
   563		  05  FILLER REDEFINES DFHMF-VAL.
   564		      10  FILLER			PIC X.
   565		      10  DFHMF 			PIC X.
   566       *                                              EBCDIC x'2C'
   567       *                                              ASCII  x'17'
   568	     *
   569	     ******************************************************************
   570	     *	  unsupported 327X Data Stream order codes
   571	     *
   572		  05  DFHSA-VAL VALUE 040		PIC S9(4) COMP-4.
   573		      88 DFHSA-VAL-EBCDIC		VALUE 40.
   574		      88 DFHSA-VAL-ASCII		VALUE 21.
   575		  05  FILLER REDEFINES DFHSA-VAL.
   576		      10  FILLER			PIC X.
   577		      10  DFHSA 			PIC X.
   578       *                                              EBCDIC x'28'
   579       *                                              ASCII  x'15'
   580		  05  DFHGE-VAL VALUE 008		PIC S9(4) COMP-4.
   581		  05  FILLER REDEFINES DFHGE-VAL.
   582		      10  FILLER			PIC X.
   583		      10  DFHGE 			PIC X.
   584       *                                              X'08'.
   585	     *
   586	     ******************************************************************
   587	     *	  SFE and MF supported attribute types
   588	     *
   589            05  DFHCOLOR                          PIC X VALUE 'ƒ'.
   590       *                                              EBCDIC x'42'
   591       *                                              ASCII  x'83'
   592            05  DFHHLT                            PIC X VALUE 'Ö'.
   593       *                                              EBCDIC x'41'
   594       *                                              ASCII  x'D6'
   595            05  DFH3270                           PIC X VALUE '{'.
   596	     *
   597	     *	  supported for SEND TEXT command and printer terminal
   598	     *
   599		  05  DFHBMPNL-VAL VALUE 021		PIC S9(4) COMP-4.
   600		      88 DFHBMPNL-VAL-EBCDIC		VALUE 21.
   601		      88 DFHBMPNL-VAL-ASCII		VALUE 10.
   602		  05  FILLER REDEFINES DFHBMPNL-VAL.
   603		      10  FILLER			PIC X.
   604		      10  DFHBMPNL			PIC X.
   605       *                                              EBCDIC X'15'.
   606       *                                              ASCII  X'0A'.
   607	     *
   608	     ******************************************************************   609	     *	  Printer terminal data stream only
   610	     *
   611		  05  DFHBMPFF-VAL VALUE 012		PIC S9(4) COMP-4.
   612		  05  FILLER REDEFINES DFHBMPFF-VAL.
   613		      10  FILLER			PIC X.
   614		      10  DFHBMPFF			PIC X.
   615       *                                              X'0C'.
   616		  05  DFHBMPCR-VAL VALUE 013		PIC S9(4) COMP-4.
   617		  05  FILLER REDEFINES DFHBMPCR-VAL.
   618		      10  FILLER			PIC X.
   619		      10  DFHBMPCR			PIC X.
   620       *                                              X'0D'.
   621		  05  DFHBMPEM-VAL VALUE 025		PIC S9(4) COMP-4.
   622		  05  FILLER REDEFINES DFHBMPEM-VAL.
   623		      10  FILLER			PIC X.
   624		      10  DFHBMPEM			PIC X.
   625       *                                              X'19'.
   626	     *
   627	     ******************************************************************
   628	     *	  unsupported Miscellaneous attributes and constants
   629	     *
   630		  05  DFHALL				PIC X VALUE LOW-VALUES.
   631            05  DFHBASE                           PIC X VALUE '0'.
   632		  05  DFHBMDET				PIC X VALUE LOW-VALUES.
   633		  05  DFHBMPSOSI-VAL VALUE 3599 	PIC S9(4) COMP-4.
   634		  05  FILLER REDEFINES DFHBMPSOSI-VAL.
   635		      10  DFHBMPSO			PIC X.
   636       *                                              X'0E'.
   637		      10  DFHBMPSI			PIC X.
   638       *                                              X'0F'.
   639		  05  DFHDFT VALUE HIGH-VALUES		PIC X.
   640            05  DFHERROR                          PIC X VALUE '¶'.
   641       *                                              EBCDIC X'1A'.
   642       *                                              ASCII  X'B6'.
   643            05  DFHFIL                            PIC X VALUE '4'.
   644            05  DFHMENT                           PIC X VALUE '2'.
   645            05  DFHMET                            PIC X VALUE '3'.
   646            05  DFHMFE                            PIC X VALUE '6'.
   647            05  DFHMFET                           PIC X VALUE '7'.
   648            05  DFHMFT                            PIC X VALUE '5'.
   649            05  DFHMT                             PIC X VALUE '1'.
   650            05  DFHOUTLN                          PIC X VALUE 'B'.
   651            05  DFHPS                             PIC X VALUE '„'.
   652       *                                              EBCDIC x'43'
   653       *                                              ASCII  x'84'
   654            05  DFHVAL                            PIC X VALUE 'A'.
   655	     *
   656		  05  DFHSUB-VAL   VALUE 063		PIC S9(4) COMP-4.
   657		      88 DFHSUB-VAL-EBCDIC		VALUE 63.
   658		      88 DFHSUB-VAL-ASCII		VALUE 26.
   659		  05  FILLER REDEFINES DFHSUB-VAL.
   660		      10  FILLER			PIC X.
   661		      10  DFHSUB			PIC X.
   662       *                                              EBCDIC X'3F'.
   663       *                                              ASCII  X'1A'.
   664	     *
   665		  05  DFHFM-VAL    VALUE 030		PIC S9(4) COMP-4.
   666		  05  FILLER REDEFINES DFHFM-VAL.
   667		      10  FILLER			PIC X.
   668		      10  DFHFM 			PIC X.   669       *                                              EBCDIC X'1E'.
   670		  05  DFHEO VALUE HIGH-VALUE		PIC X.
   672
   673	      LINKAGE SECTION.
   675	      01  DFHEIBLK.						       R
   676		  05 EIBTIME  PIC S9(7) COMP-3. 			       R
   677		  05 EIBDATE  PIC S9(7) COMP-3. 			       R
   678		  05 EIBTRNID PIC X(4). 				       R
   679		  05 EIBTASKN PIC S9(7) COMP-3. 			       R
   680		  05 EIBTRMID PIC X(4). 				       R
   681		  05 DFHEIGDI PIC S9(4) COMP-4. 			       R
   682		  05 EIBCPOSN PIC S9(4) COMP-4. 			       R
   683		  05 EIBCALEN PIC S9(4) COMP-4. 			       R
   684		  05 EIBAID   PIC X.					       R
   685		  05 EIBFN    PIC X(2). 				       R
   686		  05 EIBRCODE PIC X(6). 				       R
   687		  05 EIBDS    PIC X(8). 				       R
   688		  05 EIBREQID PIC X(8). 				       R
   689		  05 EIBRSRCE PIC X(8). 				       R
   690		  05 EIBSYNC  PIC X.					       R
   691		  05 EIBFREE  PIC X.					       R
   692		  05 EIBRECV  PIC X.					       R
   693		  05 EIBSEND  PIC X.					       R
   694		  05 EIBATT   PIC X.					       R
   695		  05 EIBEOC   PIC X.					       R
   696		  05 EIBFMH   PIC X.					       R
   697		  05 EIBCOMPL PIC X.					       R
   698		  05 EIBSIG   PIC X.					       R
   699		  05 EIBCONF  PIC X.					       R
   700		  05 EIBERR   PIC X.					       R
   701		  05 EIBERRCD PIC X(4). 				       R
   702		  05 EIBSYNRB PIC X.					       R
   703		  05 EIBNODAT PIC X.					       R
   704		  05 EIBRESP  PIC S9(8) COMP-4. 			       R
   705		  05 EIBRESP2 PIC S9(8) COMP-4. 			       R
   706		  05 EIBRLDBK PIC X.					       R
   707		  05 EIBCARESERVED PIC X(32).				       R
   709	      01  DFHCOMMAREA				PIC X(247).
   710	     *
   711	      PROCEDURE DIVISION					       R
   713		  USING DFHEIBLK DFHCOMMAREA.				       R
   738	      000-PROCESS-MENU.
   739	     *
   740            IF EIBTRNID = 'SM00' OR 'SM01' OR 'SM02' OR 'SM03' OR 'SM04'
   741                          OR 'SM05' OR 'SM06' OR 'UA01'
   742		      MOVE LOW-VALUES TO SW00MO
   743		      PERFORM 400-SEARCH-USER
   744		  ELSE
   746		      EXEC CICS SEND TEXT
   747			  FROM (WS-INVALID)
   748			  LENGTH (15)
   749			  ERASE
   750		      END-EXEC
   780		  END-IF
   781
   782		  EVALUATE TRUE
   783		      WHEN EIBCALEN = +0
   784			  MOVE LOW-VALUES TO WS-CHOICE-PH
   785                    MOVE 'ENTER OPTION AND PRESS ENTER' TO ERRMSGO
   786			  PERFORM 100-SEND-MAP   787		      WHEN EIBAID = DFHPF3
   789			  EXEC CICS SEND TEXT
   790			      FROM (WS-END)
   791			      LENGTH (15)
   792			      ERASE
   793			  END-EXEC
   824			  EXEC CICS RETURN END-EXEC
   837		      WHEN EIBAID = DFHENTER
   838			  PERFORM 300-PROCESS-TRAN
   839		      WHEN OTHER
   841			  EXEC CICS SEND TEXT
   842			      ERASE
   843			      FROM (WS-INVKEY)
   844			      LENGTH (22)
   845			  END-EXEC
   875		  END-EVALUATE
   877		  EXEC CICS
   878		      RETURN
   879                    TRANSID('SM00')
   880			  COMMAREA(WS-COMMAREA)
   881		      END-EXEC.
   906	      000-EXIT.
   907		  EXIT.
   908
   909
   910	      100-SEND-MAP.
   911		  MOVE EIBDATE TO WS-DATE.
   912		  MOVE WS-DATE-X TO DATEO.
   914		  EXEC CICS ASKTIME
   915			  ABSTIME      (WS-TIME)
   916		      END-EXEC
   935		      EXEC CICS FORMATTIME
   936			  ABSTIME      (WS-TIME)
   937                    DATESEP      ('-')
   938			  MMDDYY   (DATEO)
   939		      TIME     (TIMEO)
   940                TIMESEP  (':')
   941		  END-EXEC
   981		  MOVE DFHBMASB TO TIMEA
   982		  MOVE DFHBMASB TO DATEA
   983		  MOVE DFHUNIMD TO OPTIONA
   985		  EXEC CICS
   986                SEND MAP('SW00M')
   987                     MAPSET('SW00S')
   988			   FROM(SW00MO)
   989			   ERASE
   990		  END-EXEC.
  1027	      100-EXIT.
  1028		  EXIT.
  1029
  1030	      300-PROCESS-TRAN.
  1032		  EXEC CICS
  1033               RECEIVE MAP('SW00M')
  1034                       MAPSET('SW00S')
  1035			     INTO (SW00MI)
  1036		  END-EXEC
  1069		  EVALUATE TRUE
  1070		      WHEN OPTIONL = 0 OR OPTIONI = SPACE
  1071                    MOVE 'OPTION IS REQUIRED' TO ERRMSGO
  1072			  MOVE DFHBMBRY TO OPTIONA  1073		      WHEN OPTIONI = 1
  1074                    IF WS-CHC1 = '- USER MAINTENANCE'
  1075			      PERFORM 700-TRANSFER-PROG
  1076			      IF EIBCALEN = +0
  1078				  EXEC CICS XCTL
  1079                                PROGRAM('UA001P')
  1080				  END-EXEC
  1099			      ELSE
  1101				  EXEC CICS XCTL
  1102                                PROGRAM('UA001P')
  1103				      COMMAREA(WS-COMMAREA)
  1104				  END-EXEC
  1128			      END-IF
  1129			  END-IF
  1130                    IF WS-CHC1 = '- SEARCH TICKET'
  1131			      PERFORM 700-TRANSFER-PROG
  1132			      IF WS-TICKET-NUM1 NOT = SPACES OR
  1133				  WS-TICKET-NUM1 NOT = LOW-VALUES
  1134				  PERFORM 800-NEED-TIX
  1135			      END-IF
  1136			      IF EIBCALEN = +0
  1138				  EXEC CICS XCTL
  1139                                PROGRAM('SM001')
  1140				  END-EXEC
  1159			      ELSE
  1161				  EXEC CICS XCTL
  1162                                PROGRAM('SM001')
  1163				      COMMAREA(WS-COMMAREA)
  1164				  END-EXEC
  1188			      END-IF
  1189			  END-IF
  1190		      WHEN OPTIONI = 2
  1191                    IF WS-CHC2 = '- ADD TICKET'
  1192			      PERFORM 700-TRANSFER-PROG
  1193			      IF WS-TICKET-NUM1 = SPACES OR
  1194				  WS-TICKET-NUM1 = LOW-VALUES
  1195				  PERFORM 900-NO-TIX
  1196			      END-IF
  1197			      IF EIBCALEN = +0
  1198
  1200				  EXEC CICS XCTL
  1201                                PROGRAM('SM02P')
  1202				      COMMAREA(WS-COMMAREA)
  1203				  END-EXEC
  1227			      ELSE
  1229				  EXEC CICS XCTL
  1230                                PROGRAM('SM02P')
  1231				      COMMAREA(WS-COMMAREA)
  1232				  END-EXEC
  1256			      END-IF
  1257			  END-IF
  1258                    IF WS-CHC2 = '- UPDATE TICKET'
  1259			      PERFORM 700-TRANSFER-PROG
  1260			      IF WS-TICKET-NUM1 NOT = SPACES OR
  1261				  WS-TICKET-NUM1 NOT = LOW-VALUES
  1262				  PERFORM 900-NO-TIX
  1263			      END-IF
  1264			      IF EIBCALEN = +0
  1266				  EXEC CICS XCTL
  1267                                PROGRAM('SM03P')  1268				  END-EXEC
  1287			      ELSE
  1289				  EXEC CICS XCTL
  1290                                PROGRAM('SM03P')
  1291				      COMMAREA(WS-COMMAREA)
  1292				  END-EXEC
  1316			      END-IF
  1317			  END-IF
  1318                    IF WS-CHC2 = '- APPROVE TICKET'
  1319			      IF WS-TICKET-NUM1 NOT = SPACES OR
  1320				  WS-TICKET-NUM1 NOT = LOW-VALUES
  1321				  PERFORM 700-TRANSFER-PROG
  1322			      END-IF
  1323			      PERFORM 800-NEED-TIX
  1324			      IF EIBCALEN = +0
  1326				  EXEC CICS XCTL
  1327                                PROGRAM('SM005')
  1328				  END-EXEC
  1347			      ELSE
  1349				  EXEC CICS XCTL
  1350                                PROGRAM('SM005')
  1351				      COMMAREA(WS-COMMAREA)
  1352				  END-EXEC
  1376			      END-IF
  1377			  END-IF
  1378			  IF WS-CHC2 = LOW-VALUES
  1379                        MOVE 'INVALID OPTION' TO ERRMSGO
  1380			      PERFORM 100-SEND-MAP
  1381			  END-IF
  1382		      WHEN OPTIONI = 3
  1383                    IF WS-CHC3 = '- USER MAINTENANCE'
  1384			      PERFORM 700-TRANSFER-PROG
  1385			      IF EIBCALEN = +0
  1387				  EXEC CICS XCTL
  1388                                PROGRAM('UA001P')
  1389				  END-EXEC
  1408			      ELSE
  1410				  EXEC CICS XCTL
  1411                                PROGRAM('UA001P')
  1412				      COMMAREA(WS-COMMAREA)
  1413				  END-EXEC
  1437			      END-IF
  1438			  END-IF
  1439                    IF WS-CHC3 = '- APPROVE TICKET'
  1440			      PERFORM 700-TRANSFER-PROG
  1441			      IF WS-TICKET-NUM1 NOT = SPACES OR
  1442				  WS-TICKET-NUM1 NOT = LOW-VALUES
  1443				  PERFORM 800-NEED-TIX
  1444			      END-IF
  1445			      IF EIBCALEN = +0
  1447				  EXEC CICS XCTL
  1448                                PROGRAM('SM005')
  1449				  END-EXEC
  1468			      ELSE
  1470				  EXEC CICS XCTL
  1471                                PROGRAM('SM005')
  1472				      COMMAREA(WS-COMMAREA)
  1473				  END-EXEC
  1497			      END-IF
  1498			  END-IF  1499                    IF WS-CHC3 = '- UPDATE TICKET'
  1500			      PERFORM 700-TRANSFER-PROG
  1501			      IF WS-TICKET-NUM1 NOT = SPACES OR
  1502				  WS-TICKET-NUM1 NOT = LOW-VALUES
  1503				  PERFORM 800-NEED-TIX
  1504			      END-IF
  1505			      IF EIBCALEN = +0
  1507				  EXEC CICS XCTL
  1508                                PROGRAM('SM03P')
  1509				      COMMAREA(WS-COMMAREA)
  1510				  END-EXEC
  1534			      ELSE
  1536				  EXEC CICS XCTL
  1537                                PROGRAM('SM03P')
  1538				      COMMAREA(WS-COMMAREA)
  1539				  END-EXEC
  1563			      END-IF
  1564			  END-IF
  1565			  IF WS-CHC3 = LOW-VALUES
  1566                        MOVE 'INVALID OPTION' TO ERRMSGO
  1567			      PERFORM 100-SEND-MAP
  1568			  END-IF
  1569		      WHEN OPTIONI = 4
  1570                    IF WS-CHC4 = '- USER MAINTENANCE'
  1571			      PERFORM 700-TRANSFER-PROG
  1572			      IF EIBCALEN = +0
  1574				  EXEC CICS XCTL
  1575                                PROGRAM('UA001P')
  1576				  END-EXEC
  1595			      ELSE
  1597				  EXEC CICS XCTL
  1598                                PROGRAM('UA001P')
  1599				      COMMAREA(WS-COMMAREA)
  1600				  END-EXEC
  1624			      END-IF
  1625			  END-IF
  1626                    IF WS-CHC4 = '- CLOSE TICKET'
  1627			      PERFORM 700-TRANSFER-PROG
  1628			      IF WS-TICKET-NUM1 NOT = SPACES OR
  1629				  WS-TICKET-NUM1 NOT = LOW-VALUES
  1630				  PERFORM 800-NEED-TIX
  1631			      END-IF
  1632			      IF EIBCALEN = +0
  1634				  EXEC CICS XCTL
  1635                                PROGRAM('SM004')
  1636				      COMMAREA(WS-COMMAREA)
  1637				  END-EXEC
  1661			      ELSE
  1663				  EXEC CICS XCTL
  1664                                PROGRAM('SM004')
  1665				      COMMAREA(WS-COMMAREA)
  1666				  END-EXEC
  1690			      END-IF
  1691			  END-IF
  1692			  IF WS-CHC4 = LOW-VALUES
  1693                        MOVE 'INVALID OPTION' TO ERRMSGO
  1694			      PERFORM 100-SEND-MAP
  1695			  END-IF
  1696		      WHEN OPTIONI = 5
  1697                    IF WS-CHC5 = '- CANCEL TICKET'  1698			      PERFORM 700-TRANSFER-PROG
  1699			      IF WS-TICKET-NUM1 NOT = SPACES OR
  1700				  WS-TICKET-NUM1 NOT = LOW-VALUES
  1701				  PERFORM 800-NEED-TIX
  1702			      END-IF
  1703			      IF EIBCALEN = +0
  1705				  EXEC CICS XCTL
  1706                                PROGRAM('SM006P')
  1707				  END-EXEC
  1726			      ELSE
  1728				  EXEC CICS XCTL
  1729                                PROGRAM('SM006P')
  1730				      COMMAREA(WS-COMMAREA)
  1731				  END-EXEC
  1755			      END-IF
  1756			  END-IF
  1757			  IF WS-CHC5 = LOW-VALUES
  1758                        MOVE 'INVALID OPTION' TO ERRMSGO
  1759			      PERFORM 100-SEND-MAP
  1760			  END-IF
  1761		      WHEN OPTIONI = 6
  1762                    IF WS-CHC6 = '- APPROVE TICKET'
  1763			      PERFORM 700-TRANSFER-PROG
  1764			      IF WS-TICKET-NUM1 NOT = SPACES OR
  1765				  WS-TICKET-NUM1 NOT = LOW-VALUES
  1766				  PERFORM 800-NEED-TIX
  1767			      END-IF
  1768			      IF EIBCALEN = +0
  1770				  EXEC CICS XCTL
  1771                                PROGRAM('SM005')
  1772				  END-EXEC
  1791			      ELSE
  1793				  EXEC CICS XCTL
  1794                                PROGRAM('SM005')
  1795				      COMMAREA(WS-COMMAREA)
  1796				  END-EXEC
  1820			      END-IF
  1821			  END-IF
  1822                    IF WS-CHC6 = '- USER MAINTENANCE'
  1823			      PERFORM 700-TRANSFER-PROG
  1824			      IF EIBCALEN = +0
  1826				  EXEC CICS XCTL
  1827                                PROGRAM('UA001P')
  1828				  END-EXEC
  1847			      ELSE
  1849				  EXEC CICS XCTL
  1850                                PROGRAM('UA001P')
  1851				      COMMAREA(WS-COMMAREA)
  1852				  END-EXEC
  1876			      END-IF
  1877			  END-IF
  1878			  IF WS-CHC6 = LOW-VALUES
  1879                        MOVE 'INVALID OPTION' TO ERRMSGO
  1880			      PERFORM 100-SEND-MAP
  1881			  END-IF
  1882		      WHEN OPTIONI = 7
  1883                    IF WS-CHC7 = '- USER MAINTENANCE'
  1884			      PERFORM 700-TRANSFER-PROG
  1885			      IF EIBCALEN = +0
  1887				  EXEC CICS XCTL  1888                                PROGRAM('UA001P')
  1889				  END-EXEC
  1908			      ELSE
  1910				  EXEC CICS XCTL
  1911                                PROGRAM('UA001P')
  1912				      COMMAREA(WS-COMMAREA)
  1913				  END-EXEC
  1937			      END-IF
  1938			  END-IF
  1939			  IF WS-CHC7 = LOW-VALUES
  1940                        MOVE 'INVALID OPTION' TO ERRMSGO
  1941			      PERFORM 100-SEND-MAP
  1942			  END-IF
  1943		      WHEN OPTIONI NOT = 1 OR 2 OR 3 OR 4 OR 5 OR 6 OR 7
  1944			  IF WS-CHC7 = LOW-VALUES
  1945                        MOVE 'INVALID OPTION' TO ERRMSGO
  1946			      PERFORM 100-SEND-MAP
  1947			  END-IF
  1948		  END-EVALUATE
  1949		  PERFORM 100-SEND-MAP.
  1950	      300-EXIT.
  1951		  EXIT.
  1952
  1953	      400-SEARCH-USER.
  1955		  EXEC CICS ASSIGN
  1956		      USERID(WS-USERID)
  1957		  END-EXEC
  1976		  EXEC CICS
  1977                READ FILE('UAF00001')
  1978		      INTO (WS-USER-REC)
  1979		      RIDFLD (WS-USERID)
  1980		      RESP(WS-RESPONSE-CODE)
  1981		      GTEQ
  1982		  END-EXEC
  2020            IF WS-RESPONSE-CODE NOT = +00 OR (REQUESTOR = 'N' AND
  2021                                      SERVICE-PROVIDER = 'N' AND APPROVER
  2022                                          = 'N' AND ADMINISTRATOR = 'N')
  2024		      EXEC CICS SEND TEXT
  2025			  FROM (WS-INVALID)
  2026			  LENGTH (+25)
  2027			  ERASE
  2028		      END-EXEC
  2059		      EXEC CICS RETURN END-EXEC
  2072		  ELSE
  2073		   MOVE WS-USERID TO WS-USERID1
  2074		   MOVE REQUESTOR TO WS-REQUESTOR
  2075		   MOVE ADMINISTRATOR TO WS-ADMINISTRATOR
  2076		   MOVE APPROVER TO WS-APPROVER
  2077		   MOVE SERVICE-PROVIDER TO WS-SERVICE-PROVIDER
  2078		   MOVE 1 TO WS-PROG-STATE
  2079		  END-IF
  2080            IF REQUESTOR = 'Y'
  2081                MOVE '- SEARCH TICKET' TO WS-CHOICE
  2082		      PERFORM 500-MOVE-CHOICE-VAL
  2083                MOVE '- ADD TICKET' TO WS-CHOICE
  2084		      PERFORM 500-MOVE-CHOICE-VAL
  2085                MOVE '- UPDATE TICKET' TO WS-CHOICE
  2086		      PERFORM 500-MOVE-CHOICE-VAL
  2087                MOVE '- CLOSE TICKET' TO WS-CHOICE
  2088		      PERFORM 500-MOVE-CHOICE-VAL  2089                MOVE '- CANCEL TICKET' TO WS-CHOICE
  2090		      PERFORM 500-MOVE-CHOICE-VAL
  2091		  END-IF
  2092            IF SERVICE-PROVIDER = 'Y'
  2093                IF NOT REQUESTOR = 'Y'
  2094                    MOVE '- SEARCH TICKET' TO WS-CHOICE
  2095			  PERFORM 500-MOVE-CHOICE-VAL
  2096                    MOVE '- UPDATE TICKET' TO WS-CHOICE
  2097			  PERFORM 500-MOVE-CHOICE-VAL
  2098		      ELSE
  2099			  CONTINUE
  2100		      END-IF
  2101		  END-IF
  2102            IF APPROVER = 'Y'
  2103                IF NOT (REQUESTOR = 'Y' OR SERVICE-PROVIDER = 'Y')
  2104                    MOVE '- SEARCH TICKET' TO WS-CHOICE
  2105			  PERFORM 500-MOVE-CHOICE-VAL
  2106		      ELSE
  2107                    MOVE '- APPROVE TICKET' TO WS-CHOICE
  2108			  PERFORM 500-MOVE-CHOICE-VAL
  2109		      END-IF
  2110		  END-IF
  2111            IF ADMINISTRATOR = 'Y'
  2112                MOVE '- USER MAINTENANCE' TO WS-CHOICE
  2113		      PERFORM 500-MOVE-CHOICE-VAL
  2114		  END-IF.
  2115	      400-EXIT.
  2116		  EXIT.
  2117
  2118	      500-MOVE-CHOICE-VAL.
  2119		  EVALUATE TRUE
  2120		      WHEN OPTCHC1O = LOW-VALUES
  2121			  MOVE WS-INDEX TO OPTNO1O
  2122			  MOVE WS-CHOICE TO OPTCHC1O
  2123			  MOVE WS-CHOICE TO WS-CHC1
  2124			  ADD 1 TO WS-INDEX
  2125		      WHEN OPTCHC2O = LOW-VALUES
  2126			  MOVE WS-INDEX TO OPTNO2O
  2127			  MOVE WS-CHOICE TO OPTCHC2O
  2128			  MOVE WS-CHOICE TO WS-CHC2
  2129			  ADD 1 TO WS-INDEX
  2130		      WHEN OPTCHC3O = LOW-VALUES
  2131			  MOVE WS-INDEX TO OPTNO3O
  2132			  MOVE WS-CHOICE TO OPTCHC3O
  2133			  MOVE WS-CHOICE TO WS-CHC3
  2134			  ADD 1 TO WS-INDEX
  2135		      WHEN OPTCHC4O = LOW-VALUES
  2136			  MOVE WS-INDEX TO OPTNO4O
  2137			  MOVE WS-CHOICE TO OPTCHC4O
  2138			  MOVE WS-CHOICE TO WS-CHC4
  2139			  ADD 1 TO WS-INDEX
  2140		      WHEN OPTCHC5O = LOW-VALUES
  2141			  MOVE WS-INDEX TO OPTNO5O
  2142			  MOVE WS-CHOICE TO OPTCHC5O
  2143			  MOVE WS-CHOICE TO WS-CHC5
  2144			  ADD 1 TO WS-INDEX
  2145		      WHEN OPTCHC6O = LOW-VALUES
  2146			  MOVE WS-INDEX TO OPTNO6O
  2147			  MOVE WS-CHOICE TO OPTCHC6O
  2148			  MOVE WS-CHOICE TO WS-CHC6  2149			  ADD 1 TO WS-INDEX
  2150		      WHEN OPTCHC7O = LOW-VALUES
  2151			  MOVE WS-INDEX TO OPTNO7O
  2152			  MOVE WS-CHOICE TO OPTCHC7O
  2153			  MOVE WS-CHOICE TO WS-CHC7
  2154			  ADD 1 TO WS-INDEX
  2155		  END-EVALUATE.
  2156	      500-EXIT.
  2157		  EXIT.
  2158
  2159	      600-VALIDATE-TICKET.
  2161		  EXEC CICS
  2162                READ FILE('STF00001')
  2163		      INTO (WS-TIX-REC)
  2164		      RIDFLD (WS-TICKET-NUM1)
  2165		      RESP(WS-RESPONSE-CODE)
  2166		      EQUAL
  2167		  END-EXEC
  2206		  IF EIBRESP = DFHRESP(NOTFND)
  2208		  IF EIBRESP =	       013				       R
  2209                MOVE 'N' TO WS-VALID-TIX-FLAG
  2210		  ELSE
  2211                MOVE 'Y' TO WS-VALID-TIX-FLAG
  2212		      MOVE 2 TO WS-PROG-STATE
  2213		      MOVE TIX-REQUESTOR TO WS-TCKREQ
  2214		      MOVE TIX-STATUS TO WS-TCKSTAT
  2215		      MOVE TIX-TITLE TO WS-TCKTTL
  2216		      MOVE TIX-DESC TO WS-TCKDESC
  2217		      MOVE LAST-UPDATE TO WS-LSTUPD
  2218		      MOVE UPDATED-BY2 TO WS-STUPDBY
  2219		      MOVE LAST-UPDATE-REMW TO WS-LSTUPDRMK
  2220
  2221		  END-IF.
  2222	      600-EXIT.
  2223		  EXIT.
  2224
  2225	      700-TRANSFER-PROG.
  2226		  IF TIXNOI = SPACES OR TIXNOL = ZERO OR TIXNOI = LOW-VALUES
  2227		      MOVE TIXNOI TO WS-TICKET-NUM1
  2228		      MOVE +0 TO EIBCALEN
  2229                IF WS-CHC2 = '- ADD TICKET'
  2230                 MOVE '0' TO WS-TICKET-NUM
  2231		      END-IF
  2232		  ELSE
  2233                MOVE 'N' TO WS-INIT
  2234		      MOVE TIXNOI TO WS-TICKET-NUM1
  2235		      PERFORM 600-VALIDATE-TICKET
  2236		  END-IF.
  2237	      700-EXIT.
  2238		  EXIT.
  2239
  2240	      800-NEED-TIX.
  2241            IF WS-VALID-TIX-FLAG = 'N'
  2242		      MOVE WS-INVALID-TICKET TO ERRMSGO
  2243		      PERFORM 600-VALIDATE-TICKET
  2244		      PERFORM 100-SEND-MAP
  2246		      EXEC CICS RETURN
  2247                    TRANSID('SM00')
  2248			  COMMAREA(WS-COMMAREA)
  2249		      END-EXEC  2273		  END-IF.
  2274	      800-EXIT.
  2275		  EXIT.
  2276
  2277	      900-NO-TIX.
  2278            IF WS-VALID-TIX-FLAG = 'Y'
  2279		      MOVE WS-DUP-TICKET TO ERRMSGO
  2280		      PERFORM 600-VALIDATE-TICKET
  2281		      PERFORM 100-SEND-MAP
  2283		      EXEC CICS RETURN
  2284                    TRANSID('SM00')
  2285			  COMMAREA(WS-COMMAREA)
  2286		      END-EXEC
  2310		  END-IF.
  2311	      900-EXIT.
  2312		  EXIT.CA-Realia COBOL Version 6.0.45	 C:\handson-cics\CAWB30\sm000p.cic     PAGE   21



			Realia COBOL Compiler Version Information

			      Pass 1	 Version 6.072
			      Pass 1a	 Version 6.015
			      Pass 2	 Version 6.068
			      Pass 2a	 Version 6.020
			      Pass 3	 Version 6.094
			      Pass 4	 Version 6.007
			      Pass 5	 Version 6.022


			Compilation Directives in Effect

COMP-4		  DCHK		    OPT 	      NOCALL
NOSUBCHK	  STRCHK	    NOTRUNC	      NOSMALLCOMP
NODCALL 	  NODIVZERO	    NOEPDCALL	      APOST
EBCDIC		  STATABORT	    NOMOVELINK	      NOBLL4K
ARGCHK		  UPLOW 	    NOVERARG	      MDY
LP:   60	  PP		    FCREATE	      NOIEEE
NOLILIAN	  CURRENCY-SIGN=$   WRITEAFTER	      SOSI
NOCOPY68	  NOFLAG-COM	    NOFLAG-SEG	      NOFLAG-FIPS
DEBUGXREF	  DIALECT-VS2

			Error level limit: W

			Source lines compiled:	    2323
			Compilation time (mm:ss.ss):  0:00.06
			Compilation speed (lines/minute): 23000

			Compilation date (yy/mm/dd): 23/12/05
			     Time of day (hh:mm:ss): 00:31:40