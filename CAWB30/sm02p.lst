     5	     *	CBL XOPTS(COBOL2)
    20	      IDENTIFICATION DIVISION.
    21	      PROGRAM-ID. SM02P.
    22
    23	      ENVIRONMENT DIVISION.
    24	      CONFIGURATION SECTION.
    25	      SOURCE-COMPUTER.	  IBM-PC.
    26	      OBJECT-COMPUTER.	  IBM-PC.
    27	      DATA DIVISION.
    28	      WORKING-STORAGE SECTION.
    74        01  WS-CURRENT-MAP  VALUE 'SM002'         PIC X(7).
    75	      01  WS-TIME					PIC 9(15) COMP-3
    76	      01  WS-DATE				PIC 9(8).
    77	      01  WS-DATE-X REDEFINES WS-DATE		PIC X(8).
    78	      01  WS-LENGTH				PIC S9(4) COMP.
    79	      01  WS-END				PIC X(14) VALUE
    80            'END PROCESSING'.
    81	      01  WS-MAPFAIL				PIC X(20) VALUE
    82            'MAPFAIL ERROR'.
    83	      01  WS-INVALID					PIC X(14) VALUE
    84            'INVALID ACCESS'.
    85	      01  WS-COMMAREA.
    86		  05  WS-USERID1			 PIC X(7).
    87		  05  WS-TICKET-NUM.
    88		      10  WS-TICKET-NUM1		 PIC X(6).
    89		      10  FILLER			 PIC X.
    90		  05  WS-PROG-STATE			 PIC 9(1).
    91            05  WS-INIT                            PIC X VALUE 'Y'.
    92
    93	      01  WS-FIELD01.
    94		  05 WS-STF01TCKID			PIC X(6).
    95		  05 WS-STF01TCKIDR REDEFINES WS-STF01TCKID PIC 9(06).
    96		  05 WS-STF01TCKREQ			PIC X(8).
    97		  05 WS-STF01TCKSTAT			PIC X(10).
    98		  05 WS-STF01TCKTTL			PIC X(25).
    99		  05 WS-STF01TCKDESC			PIC X(100).
   100		  05 WS-STF01LSTUPD			PIC X(20).
   101		  05 WS-STF01LSTUPDBY			PIC X(8).
   102		  05 WS-STF01LSTUPDRMK			PIC X(50).
   103
   104	      01  WS-TIX-REC.
   105		  05  TIX-ID				PIC X(06).
   106		  05  TIX-REQUESTOR			PIC X(08).
   107		  05  TIX-STATUS			PIC X(10).
   108		  05  TIX-TITLE 			PIC X(25).
   109		  05  TIX-DESC				PIC X(100).
   110		  05  TIX-DESC-RED REDEFINES TIX-DESC.
   111		      10  TIX-DESC1			PIC X(50).
   112		      10  TIX-DESC2			PIC X(50).
   113		  05  LAST-UPDATE			PIC X(20).
   114		  05  LAST-UPDATE-RED REDEFINES LAST-UPDATE.
   115		      10  LAST-UPDATE-DATE		PIC X(11).
   116		      10  LAST-UPDATE-TIME		PIC X(09).
   117		  05  UPDATED-BY2.
   118		      10  UPDBY2			PIC X(7).
   119		      10  FILLER			PIC X.
   120		  05  LAST-UPDATE-REM			PIC X(50).
   121		  05  LAST-UPDATE-REMW REDEFINES LAST-UPDATE-REM.
   122		      10  LAST-UPDATE-REM1		PIC X(25).
   123		      10  LAST-UPDATE-REM2		PIC X(25).   124
   125	      01  WS-LOG.
   126		  05  LOG-TIX-ID.
   127		      10  LOG-TIX-ID1			PIC X(6).
   128		      10  LOG-SEQ-NUM			PIC 9(3).
   129		  05  LOG-LAST-UPDATE.
   130		      10  LOG-LAST-UPDATE-DATE		PIC X(10).
   131		      10  LOG-LAST-UPDATE-TIME		PIC X(10).
   132		  05  LOG-UPDATED-BY.
   133		      10  LOG-UPDBY2			PIC X(7).
   134		      10  FILLER			PIC X.
   135		  05  LOG-LAST-UPDATE-REM		PIC X(50).
   136		  05  FILLER				PIC X(02).
   137
   138	      01  WS-LOG-PH				PIC X(9).
   139	      01  WS-LOG-PH2 REDEFINES WS-LOG-PH.
   140		  05  WS-LOG-ID 			PIC 9(6).
   141		  05  WS-LOG-SEQ			PIC 9(3).
   142
   143	      01  WS-HV 				PIC X(20).
   144
   145	      01  WS-ENTRCTR				PIC 9(1).
   146	      01  WS-HDATE				PIC 9(10).
   147	      01  WS-HDATE-X REDEFINES WS-HDATE 	PIC X(10).
   148	      01  WS-HTIME			       PIC 9(15).
   149	      01  WS-HTIME-X REDEFINES WS-HTIME 	PIC X(8).
   150	      01  WS-RES-CODE				PIC S9(8) COMP.
   151
   152
   153	     *
   154		  COPY SM002.
   156	     * SYMBOLIC MAP of sm002 Created by CACXBMS Version 6.0.27
   157	      01  SM002MI.
   158		  02  FILLER				     PIC X(12).
   159		  02  HEADERL				     PIC S9(4) COMP.
   160		  02  HEADERF				     PIC X.
   161		  02  FILLER REDEFINES HEADERF.
   162		      03  HEADERA			     PIC X.
   163		  02  HEADERI				     PIC X(013).
   164		  02  UPDREML				     PIC S9(4) COMP.
   165		  02  UPDREMF				     PIC X.
   166		  02  FILLER REDEFINES UPDREMF.
   167		      03  UPDREMA			     PIC X.
   168		  02  UPDREMI				     PIC X(021).
   169		  02  UPDDTL				     PIC S9(4) COMP.
   170		  02  UPDDTF				     PIC X.
   171		  02  FILLER REDEFINES UPDDTF.
   172		      03  UPDDTA			     PIC X.
   173		  02  UPDDTI				     PIC X(021).
   174		  02  UPDBY1L				     PIC S9(4) COMP.
   175		  02  UPDBY1F				     PIC X.
   176		  02  FILLER REDEFINES UPDBY1F.
   177		      03  UPDBY1A			     PIC X.
   178		  02  UPDBY1I				     PIC X(021).
   179		  02  ERRMSGL				     PIC S9(4) COMP.
   180		  02  ERRMSGF				     PIC X.
   181		  02  FILLER REDEFINES ERRMSGF.
   182		      03  ERRMSGA			     PIC X.
   183		  02  ERRMSGI				     PIC X(058).
   184		  02  DATEL				     PIC S9(4) COMP.   185		  02  DATEF				     PIC X.
   186		  02  FILLER REDEFINES DATEF.
   187		      03  DATEA 			     PIC X.
   188		  02  DATEI				     PIC X(010).
   189		  02  TIMEL				     PIC S9(4) COMP.
   190		  02  TIMEF				     PIC X.
   191		  02  FILLER REDEFINES TIMEF.
   192		      03  TIMEA 			     PIC X.
   193		  02  TIMEI				     PIC X(008).
   194		  02  TIXNUML				     PIC S9(4) COMP.
   195		  02  TIXNUMF				     PIC X.
   196		  02  FILLER REDEFINES TIXNUMF.
   197		      03  TIXNUMA			     PIC X.
   198		  02  TIXNUMI				     PIC X(006).
   199		  02  TIXTTLL				     PIC S9(4) COMP.
   200		  02  TIXTTLF				     PIC X.
   201		  02  FILLER REDEFINES TIXTTLF.
   202		      03  TIXTTLA			     PIC X.
   203		  02  TIXTTLI				     PIC X(025).
   204		  02  TIXDESC1L 			     PIC S9(4) COMP.
   205		  02  TIXDESC1F 			     PIC X.
   206		  02  FILLER REDEFINES TIXDESC1F.
   207		      03  TIXDESC1A			     PIC X.
   208		  02  TIXDESC1I 			     PIC X(040).
   209		  02  TIXDESC2L 			     PIC S9(4) COMP.
   210		  02  TIXDESC2F 			     PIC X.
   211		  02  FILLER REDEFINES TIXDESC2F.
   212		      03  TIXDESC2A			     PIC X.
   213		  02  TIXDESC2I 			     PIC X(040).
   214		  02  STATL				     PIC S9(4) COMP.
   215		  02  STATF				     PIC X.
   216		  02  FILLER REDEFINES STATF.
   217		      03  STATA 			     PIC X.
   218		  02  STATI				     PIC X(008).
   219		  02  UPDRMKL				     PIC S9(4) COMP.
   220		  02  UPDRMKF				     PIC X.
   221		  02  FILLER REDEFINES UPDRMKF.
   222		      03  UPDRMKA			     PIC X.
   223		  02  UPDRMKI				     PIC X(025).
   224		  02  UPDRMK1L				     PIC S9(4) COMP.
   225		  02  UPDRMK1F				     PIC X.
   226		  02  FILLER REDEFINES UPDRMK1F.
   227		      03  UPDRMK1A			     PIC X.
   228		  02  UPDRMK1I				     PIC X(025).
   229		  02  DATE1L				     PIC S9(4) COMP.
   230		  02  DATE1F				     PIC X.
   231		  02  FILLER REDEFINES DATE1F.
   232		      03  DATE1A			     PIC X.
   233		  02  DATE1I				     PIC X(011).
   234		  02  TIME1L				     PIC S9(4) COMP.
   235		  02  TIME1F				     PIC X.
   236		  02  FILLER REDEFINES TIME1F.
   237		      03  TIME1A			     PIC X.
   238		  02  TIME1I				     PIC X(010).
   239		  02  UPDBY2L				     PIC S9(4) COMP.
   240		  02  UPDBY2F				     PIC X.
   241		  02  FILLER REDEFINES UPDBY2F.
   242		      03  UPDBY2A			     PIC X.
   243		  02  UPDBY2I				     PIC X(007).
   244	      01  SM002MO REDEFINES SM002MI.   245		  02  FILLER				     PIC X(12).
   246		  02  FILLER				     PIC XX.
   247		  02  FILLER				     PIC X.
   248		  02  HEADERO				     PIC X(013).
   249		  02  FILLER				     PIC XX.
   250		  02  FILLER				     PIC X.
   251		  02  UPDREMO				     PIC X(021).
   252		  02  FILLER				     PIC XX.
   253		  02  FILLER				     PIC X.
   254		  02  UPDDTO				     PIC X(021).
   255		  02  FILLER				     PIC XX.
   256		  02  FILLER				     PIC X.
   257		  02  UPDBY1O				     PIC X(021).
   258		  02  FILLER				     PIC XX.
   259		  02  FILLER				     PIC X.
   260		  02  ERRMSGO				     PIC X(058).
   261		  02  FILLER				     PIC XX.
   262		  02  FILLER				     PIC X.
   263		  02  DATEO				     PIC X(010).
   264		  02  FILLER				     PIC XX.
   265		  02  FILLER				     PIC X.
   266		  02  TIMEO				     PIC X(008).
   267		  02  FILLER				     PIC XX.
   268		  02  FILLER				     PIC X.
   269		  02  TIXNUMO				     PIC X(006).
   270		  02  FILLER				     PIC XX.
   271		  02  FILLER				     PIC X.
   272		  02  TIXTTLO				     PIC X(025).
   273		  02  FILLER				     PIC XX.
   274		  02  FILLER				     PIC X.
   275		  02  TIXDESC1O 			     PIC X(040).
   276		  02  FILLER				     PIC XX.
   277		  02  FILLER				     PIC X.
   278		  02  TIXDESC2O 			     PIC X(040).
   279		  02  FILLER				     PIC XX.
   280		  02  FILLER				     PIC X.
   281		  02  STATO				     PIC X(008).
   282		  02  FILLER				     PIC XX.
   283		  02  FILLER				     PIC X.
   284		  02  UPDRMKO				     PIC X(025).
   285		  02  FILLER				     PIC XX.
   286		  02  FILLER				     PIC X.
   287		  02  UPDRMK1O				     PIC X(025).
   288		  02  FILLER				     PIC XX.
   289		  02  FILLER				     PIC X.
   290		  02  DATE1O				     PIC X(011).
   291		  02  FILLER				     PIC XX.
   292		  02  FILLER				     PIC X.
   293		  02  TIME1O				     PIC X(010).
   294		  02  FILLER				     PIC XX.
   295		  02  FILLER				     PIC X.
   296		  02  UPDBY2O				     PIC X(007).
   298	     *
   299		  COPY DFHAID.
   301	      01  DFHAID.
   302	     *
   303	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   304	     *
   305	     * Revision Information
   306	     * ^{File:dfhaid.cob  }   307	     * ^{Timestamp:Thu May 15 14:02:52 1997}
   308	     * ^{Revision:2.0}
   309	     *
   310	     *This is the AID constants copy file
   311	     *
   312            05  DFHENTER                  PIC X VALUE ''''.
   313	     *					value APOST
   314            05  DFHCLEAR                  PIC X VALUE '_'.
   315            05  DFHPA1                    PIC X VALUE '%'.
   316            05  DFHPA2                    PIC X VALUE '>'.
   317            05  DFHPA3                    PIC X VALUE ','.
   318            05  DFHPF1                    PIC X VALUE '1'.
   319            05  DFHPF2                    PIC X VALUE '2'.
   320            05  DFHPF3                    PIC X VALUE '3'.
   321            05  DFHPF4                    PIC X VALUE '4'.
   322            05  DFHPF5                    PIC X VALUE '5'.
   323            05  DFHPF6                    PIC X VALUE '6'.
   324            05  DFHPF7                    PIC X VALUE '7'.
   325            05  DFHPF8                    PIC X VALUE '8'.
   326            05  DFHPF9                    PIC X VALUE '9'.
   327            05  DFHPF10                   PIC X VALUE ':'.
   328            05  DFHPF11                   PIC X VALUE '#'.
   329            05  DFHPF12                   PIC X VALUE '@'.
   330            05  DFHPF13                   PIC X VALUE 'A'.
   331            05  DFHPF14                   PIC X VALUE 'B'.
   332            05  DFHPF15                   PIC X VALUE 'C'.
   333            05  DFHPF16                   PIC X VALUE 'D'.
   334            05  DFHPF17                   PIC X VALUE 'E'.
   335            05  DFHPF18                   PIC X VALUE 'F'.
   336            05  DFHPF19                   PIC X VALUE 'G'.
   337            05  DFHPF20                   PIC X VALUE 'H'.
   338            05  DFHPF21                   PIC X VALUE 'I'.
   339            05  DFHPF22                   PIC X VALUE '›'.
   340       *                                  EBCDIC Cent sign x'4A'
   341       *                                  ASCII  Cent sign x'9B'
   342            05  DFHPF23                   PIC X VALUE '.'.
   343            05  DFHPF24                   PIC X VALUE '<'.
   344            05  DFHOPID                   PIC X VALUE 'W'.
   345            05  DFHMSRE                   PIC X VALUE 'X'.
   346            05  DFHTRIG                   PIC X VALUE '"'.
   347       *                                        value QUOTE  "
   348            05  DFHPEN                    PIC X VALUE '='.
   349            05  DFHCLRP                   PIC X VALUE 'Ý'.
   350       *                                  EBCDIC x'6A'
   351       *                                  ASCII  x'DD'
   352            05  DFHSTRF                   PIC X VALUE 'h'.
   353	     *	  DFHQUIT is a CA-Realia CICS Extension
   354	     *	  It is set by using <Ctrl>+C or <Ctrl>+<Break> Keys
   355            05  DFHQUIT                   PIC X VALUE '!'.
   356		  05  DFHNULL			PIC X VALUE LOW-VALUE.
   358	     *
   359	      COPY DFHBMSCA.
   361	      01  DFHBMSCA.
   362	     *
   363	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   364	     *
   365	     * Revision Information
   366	     * ^{File:dfhbmsca.cob}
   367	     * ^{Timestamp:Tue Oct 08 15:34:54 1996}
   368	     * ^{Revision:2.0}   369	     *
   370	     *	Note:This FILE is provided with most values as quoted literals
   371	     *	     so that the file can be used for both ASCII and EBCDIC
   372	     *	     programs
   373	     *
   374	     *	     The only exceptions are some 3270 Data Stream Orders
   375	     *	     They use different Hexadecimal values for ASCII and
   376	     *	     EBCDIC and they cannot be expressed as quoted literals
   377	     *	     as the values are <Line Feed>, <Tab>, <End of File> etc.
   378	     *	     characters in ASCII
   379	     *
   380	     *	     They have their values set up to default to the EBCDIC
   381	     *	     values.
   382	     *
   383	     *	     3270 orders are only needed for EXEC CICS SEND and RECEIVE
   384	     *	     and SEND TEXT with imbedded format orders.
   385	     *	     If you use these values in ASCII programs the values
   386	     *	     must be changed.
   387	     *
   388	     *	     An alternative is to use REPLACING to change the values.
   389	     *
   390	     *	  i.e. COPY DFHBMSCA replacing
   391	     *			    ==005== BY ==009==	*> DFHPT
   392	     *			    ==021== BY ==010==	*> DFHNL
   393	     *			    ==040== BY ==021==	*> DFHSA
   394	     *			    ==041== BY ==031==	*> DFHSFE
   395	     *			    ==044== BY ==023==	*> DFHMF
   396	     *			    ==060== BY ==020==	*> DFHRA
   397	     *			    ==063== BY ==026==. *> DFHSUB
   398	     *
   399	     ******************************************************************
   400	     *BMS and Terminal Control - Order & Attributes constants	      *
   401	     ******************************************************************
   402	     *
   403	     *	  Field Attributes
   404	     *
   405            05  DFHBMASB                          PIC X VALUE '8'.
   406            05  DFHBMASF                          PIC X VALUE '1'.
   407            05  DFHBMASK                          PIC X VALUE '0'.
   408            05  DFHBMBRY                          PIC X VALUE 'H'.
   409            05  DFHBMDAR                          PIC X VALUE '<'.
   410            05  DFHBMFSE                          PIC X VALUE 'A'.
   411            05  DFHBMPRF                          PIC X VALUE '/'.
   412            05  DFHBMPRO                          PIC X VALUE '-'.
   413            05  DFHBMUNN                          PIC X VALUE '&'.
   414            05  DFHBMUNP                          PIC X VALUE ' '.
   415            05  DFHUNNUM                          PIC X VALUE 'J'.
   416	     *
   417	     *	  partially supported
   418	     *
   419            05  DFHUNNOD                          PIC X VALUE '('.
   420            05  DFHUNIMD                          PIC X VALUE 'I'.
   421            05  DFHUNINT                          PIC X VALUE 'R'.
   422            05  DFHUNNON                          PIC X VALUE '('.
   423            05  DFHPROTI                          PIC X VALUE 'Y'.
   424            05  DFHPROTN                          PIC X VALUE '%'.
   425	     *
   426	     *	  These values are additions to mainframe constants
   427	     *
   428            05  DFHBMS-ASK-DARK                   PIC X VALUE '@'.   429            05  DFHBMS-ASK-BRY-FSET               PIC X VALUE '9'.
   430            05  DFHBMS-ASK-DAR-FSET               PIC X VALUE ''''.
   431	     *						      VALUE APOST
   432            05  DFHBMS-PRO-BRY-FSET               PIC X VALUE 'Z'.
   433            05  DFHBMS-PRO-DAR-FSET               PIC X VALUE '_'.
   434            05  DFHBMS-NUM-BRY                    PIC X VALUE 'Q'.
   435            05  DFHBMS-NUM-DAR                    PIC X VALUE '*'.
   436            05  DFHBMS-NUM-DAR-FSET               PIC X VALUE ')'.
   437	     *
   438	     *	  Field Flag values
   439		  05  DFHBMEOF-VAL VALUE 128		PIC S9(4) COMP-4.
   440		  05  FILLER REDEFINES DFHBMEOF-VAL.
   441		      10  FILLER			PIC X.
   442		      10  DFHBMEOF			PIC X.
   443       *                                          x'80'.
   444		  05  DFHBMCUR-VAL VALUE 002		PIC S9(4) COMP-4.
   445		  05  FILLER REDEFINES DFHBMCUR-VAL.
   446		      10  FILLER			PIC X.
   447		      10  DFHBMCUR			PIC X.
   448       *                                          x'02'.
   449		  05  DFHBMMEC-VAL VALUE 130		PIC S9(4) COMP-4.
   450		  05  FILLER REDEFINES DFHBMMEC-VAL.
   451		      10  FILLER			PIC X.
   452		      10  DFHBMMEC			PIC X.
   453       *                                          x'82'.
   454       *                                          x'02'.
   455		  05  DFHBMFLG-VAL  VALUE 0		PIC S9(4) COMP-4.
   456		      88  DFHERASE			VALUES 128 130.
   457       *                                          x'80' X'82'
   458		      88  DFHCURSR			VALUES 002 130.
   459       *                                          x'02' X'82'
   460		  05  FILLER REDEFINES DFHBMFLG-VAL.
   461		      10  FILLER			PIC X.
   462		      10  DFHBMFLG			PIC X.
   463
   464		  05  DFHBMDUP-VAL VALUE 028		PIC S9(4) COMP-4.
   465		  05  FILLER REDEFINES DFHBMDUP-VAL.
   466		      10  FILLER			PIC X.
   467		      10  DFHBMDUP			PIC X.
   468       *                                              x'1C'
   469	     *
   470	     ******************************************************************
   471	     *	  supported 327X Extended Attributes
   472	     *
   473	     *	  Extended COLOR Attributes
   474	     *
   475            05  DFHDFCOL                          PIC X VALUE '0'.
   476            05  DFHBLUE                           PIC X VALUE '1'.
   477            05  DFHRED                            PIC X VALUE '2'.
   478            05  DFHPINK                           PIC X VALUE '3'.
   479            05  DFHGREEN                          PIC X VALUE '4'.
   480            05  DFHTURQ                           PIC X VALUE '5'.
   481            05  DFHYELLO                          PIC X VALUE '6'.
   482            05  DFHNEUTR                          PIC X VALUE '7'.
   483	     *
   484	     *	  Extended HILIGHT Attributes
   485	     *
   486            05  DFHDFHI                           PIC X VALUE '0'.
   487            05  DFHBLINK                          PIC X VALUE '1'.
   488            05  DFHREVRS                          PIC X VALUE '2'.   489            05  DFHUNDLN                          PIC X VALUE '4'.
   490	     *
   491	     ******************************************************************
   492	     *	  supported 327X Data Stream Orders
   493	     *
   494		  05  DFHSBA-VAL VALUE 017		 PIC S9(4) COMP-4.
   495		  05  FILLER REDEFINES DFHSBA-VAL.
   496		      10  FILLER			PIC X.
   497		      10  DFHSBA			PIC X.
   498       *                                              x'11'
   499		  05  DFHEUA-VAL VALUE 018		PIC S9(4) COMP-4.
   500		  05  FILLER REDEFINES DFHEUA-VAL.
   501		      10  FILLER			PIC X.
   502		      10  DFHEUA			PIC X.
   503       *                                              x'12'
   504		  05  DFHIC-VAL VALUE 019		PIC S9(4) COMP-4.
   505		  05  FILLER REDEFINES DFHIC-VAL.
   506		      10  FILLER			PIC X.
   507		      10  DFHIC 			PIC X.
   508       *                                              X'13'.
   509		  05  DFHSF-VAL VALUE 029		PIC S9(4) COMP-4.
   510		  05  FILLER REDEFINES DFHSF-VAL.
   511		      10  FILLER			PIC X.
   512		      10  DFHSF 			PIC X.
   513       *                                              X'1D'.
   514		  05  DFHPT-VAL VALUE 005		PIC S9(4) COMP-4.
   515		      88 DFHPT-VAL-EBCDIC		VALUE 5.
   516		      88 DFHPT-VAL-ASCII		VALUE 9.
   517		  05  FILLER REDEFINES DFHPT-VAL.
   518		      10  FILLER			PIC X.
   519		      10  DFHPT 			PIC X.
   520       *                                              EBCDIC X'05'.
   521       *                                              ASCII  X'09'.
   522		  05  DFHRA-VAL VALUE 060		PIC S9(4) COMP-4.
   523		      88 DFHRA-VAL-EBCDIC		VALUE 60.
   524		      88 DFHRA-VAL-ASCII		VALUE 20.
   525		  05  FILLER REDEFINES DFHRA-VAL.
   526		      10  FILLER			PIC X.
   527		      10  DFHRA 			PIC X.
   528       *                                              EBCDIC x'3C'
   529       *                                              ASCII  x'14'
   530		  05  DFHSFE-VAL VALUE 041		PIC S9(4) COMP-4.
   531		      88 DFHSFE-VAL-EBCDIC		VALUE 41.
   532		      88 DFHSFE-VAL-ASCII		VALUE 31.
   533		  05  FILLER REDEFINES DFHSFE-VAL.
   534		      10  FILLER			PIC X.
   535		      10  DFHSFE			PIC X.
   536       *                                              EBCDIC x'29'
   537       *                                              ASCII  x'1F'
   538		  05  DFHMF-VAL VALUE 044		PIC S9(4) COMP-4.
   539		      88 DFHMF-VAL-EBCDIC		VALUE 44.
   540		      88 DFHMF-VAL-ASCII		VALUE 23.
   541		  05  FILLER REDEFINES DFHMF-VAL.
   542		      10  FILLER			PIC X.
   543		      10  DFHMF 			PIC X.
   544       *                                              EBCDIC x'2C'
   545       *                                              ASCII  x'17'
   546	     *
   547	     ******************************************************************
   548	     *	  unsupported 327X Data Stream order codes   549	     *
   550		  05  DFHSA-VAL VALUE 040		PIC S9(4) COMP-4.
   551		      88 DFHSA-VAL-EBCDIC		VALUE 40.
   552		      88 DFHSA-VAL-ASCII		VALUE 21.
   553		  05  FILLER REDEFINES DFHSA-VAL.
   554		      10  FILLER			PIC X.
   555		      10  DFHSA 			PIC X.
   556       *                                              EBCDIC x'28'
   557       *                                              ASCII  x'15'
   558		  05  DFHGE-VAL VALUE 008		PIC S9(4) COMP-4.
   559		  05  FILLER REDEFINES DFHGE-VAL.
   560		      10  FILLER			PIC X.
   561		      10  DFHGE 			PIC X.
   562       *                                              X'08'.
   563	     *
   564	     ******************************************************************
   565	     *	  SFE and MF supported attribute types
   566	     *
   567            05  DFHCOLOR                          PIC X VALUE 'ƒ'.
   568       *                                              EBCDIC x'42'
   569       *                                              ASCII  x'83'
   570            05  DFHHLT                            PIC X VALUE 'Ö'.
   571       *                                              EBCDIC x'41'
   572       *                                              ASCII  x'D6'
   573            05  DFH3270                           PIC X VALUE '{'.
   574	     *
   575	     *	  supported for SEND TEXT command and printer terminal
   576	     *
   577		  05  DFHBMPNL-VAL VALUE 021		PIC S9(4) COMP-4.
   578		      88 DFHBMPNL-VAL-EBCDIC		VALUE 21.
   579		      88 DFHBMPNL-VAL-ASCII		VALUE 10.
   580		  05  FILLER REDEFINES DFHBMPNL-VAL.
   581		      10  FILLER			PIC X.
   582		      10  DFHBMPNL			PIC X.
   583       *                                              EBCDIC X'15'.
   584       *                                              ASCII  X'0A'.
   585	     *
   586	     ******************************************************************
   587	     *	  Printer terminal data stream only
   588	     *
   589		  05  DFHBMPFF-VAL VALUE 012		PIC S9(4) COMP-4.
   590		  05  FILLER REDEFINES DFHBMPFF-VAL.
   591		      10  FILLER			PIC X.
   592		      10  DFHBMPFF			PIC X.
   593       *                                              X'0C'.
   594		  05  DFHBMPCR-VAL VALUE 013		PIC S9(4) COMP-4.
   595		  05  FILLER REDEFINES DFHBMPCR-VAL.
   596		      10  FILLER			PIC X.
   597		      10  DFHBMPCR			PIC X.
   598       *                                              X'0D'.
   599		  05  DFHBMPEM-VAL VALUE 025		PIC S9(4) COMP-4.
   600		  05  FILLER REDEFINES DFHBMPEM-VAL.
   601		      10  FILLER			PIC X.
   602		      10  DFHBMPEM			PIC X.
   603       *                                              X'19'.
   604	     *
   605	     ******************************************************************
   606	     *	  unsupported Miscellaneous attributes and constants
   607	     *
   608		  05  DFHALL				PIC X VALUE LOW-VALUES.   609            05  DFHBASE                           PIC X VALUE '0'.
   610		  05  DFHBMDET				PIC X VALUE LOW-VALUES.
   611		  05  DFHBMPSOSI-VAL VALUE 3599 	PIC S9(4) COMP-4.
   612		  05  FILLER REDEFINES DFHBMPSOSI-VAL.
   613		      10  DFHBMPSO			PIC X.
   614       *                                              X'0E'.
   615		      10  DFHBMPSI			PIC X.
   616       *                                              X'0F'.
   617		  05  DFHDFT VALUE HIGH-VALUES		PIC X.
   618            05  DFHERROR                          PIC X VALUE '¶'.
   619       *                                              EBCDIC X'1A'.
   620       *                                              ASCII  X'B6'.
   621            05  DFHFIL                            PIC X VALUE '4'.
   622            05  DFHMENT                           PIC X VALUE '2'.
   623            05  DFHMET                            PIC X VALUE '3'.
   624            05  DFHMFE                            PIC X VALUE '6'.
   625            05  DFHMFET                           PIC X VALUE '7'.
   626            05  DFHMFT                            PIC X VALUE '5'.
   627            05  DFHMT                             PIC X VALUE '1'.
   628            05  DFHOUTLN                          PIC X VALUE 'B'.
   629            05  DFHPS                             PIC X VALUE '„'.
   630       *                                              EBCDIC x'43'
   631       *                                              ASCII  x'84'
   632            05  DFHVAL                            PIC X VALUE 'A'.
   633	     *
   634		  05  DFHSUB-VAL   VALUE 063		PIC S9(4) COMP-4.
   635		      88 DFHSUB-VAL-EBCDIC		VALUE 63.
   636		      88 DFHSUB-VAL-ASCII		VALUE 26.
   637		  05  FILLER REDEFINES DFHSUB-VAL.
   638		      10  FILLER			PIC X.
   639		      10  DFHSUB			PIC X.
   640       *                                              EBCDIC X'3F'.
   641       *                                              ASCII  X'1A'.
   642	     *
   643		  05  DFHFM-VAL    VALUE 030		PIC S9(4) COMP-4.
   644		  05  FILLER REDEFINES DFHFM-VAL.
   645		      10  FILLER			PIC X.
   646		      10  DFHFM 			PIC X.
   647       *                                              EBCDIC X'1E'.
   648		  05  DFHEO VALUE HIGH-VALUE		PIC X.
   650
   651	      LINKAGE SECTION.
   653	      01  DFHEIBLK.						       R
   654		  05 EIBTIME  PIC S9(7) COMP-3. 			       R
   655		  05 EIBDATE  PIC S9(7) COMP-3. 			       R
   656		  05 EIBTRNID PIC X(4). 				       R
   657		  05 EIBTASKN PIC S9(7) COMP-3. 			       R
   658		  05 EIBTRMID PIC X(4). 				       R
   659		  05 DFHEIGDI PIC S9(4) COMP-4. 			       R
   660		  05 EIBCPOSN PIC S9(4) COMP-4. 			       R
   661		  05 EIBCALEN PIC S9(4) COMP-4. 			       R
   662		  05 EIBAID   PIC X.					       R
   663		  05 EIBFN    PIC X(2). 				       R
   664		  05 EIBRCODE PIC X(6). 				       R
   665		  05 EIBDS    PIC X(8). 				       R
   666		  05 EIBREQID PIC X(8). 				       R
   667		  05 EIBRSRCE PIC X(8). 				       R
   668		  05 EIBSYNC  PIC X.					       R
   669		  05 EIBFREE  PIC X.					       R
   670		  05 EIBRECV  PIC X.					       R   671		  05 EIBSEND  PIC X.					       R
   672		  05 EIBATT   PIC X.					       R
   673		  05 EIBEOC   PIC X.					       R
   674		  05 EIBFMH   PIC X.					       R
   675		  05 EIBCOMPL PIC X.					       R
   676		  05 EIBSIG   PIC X.					       R
   677		  05 EIBCONF  PIC X.					       R
   678		  05 EIBERR   PIC X.					       R
   679		  05 EIBERRCD PIC X(4). 				       R
   680		  05 EIBSYNRB PIC X.					       R
   681		  05 EIBNODAT PIC X.					       R
   682		  05 EIBRESP  PIC S9(8) COMP-4. 			       R
   683		  05 EIBRESP2 PIC S9(8) COMP-4. 			       R
   684		  05 EIBRLDBK PIC X.					       R
   685		  05 EIBCARESERVED PIC X(32).				       R
   687	      01  DFHCOMMAREA				PIC X(20).
   688	     *
   689	      PROCEDURE DIVISION					       R
   691		  USING DFHEIBLK DFHCOMMAREA.				       R
   716	      100-PROCESS.
   717
   718		  MOVE DFHCOMMAREA TO WS-COMMAREA
   719            IF EIBTRNID = 'SM00' OR 'SM01' OR 'SM02'
   720		      IF EIBCALEN NOT = +0
   721
   722                  IF WS-PROG-STATE = '1'
   723                    MOVE 'ENTER TICKET DETAILS AND PRESS PF2' TO ERRMSGO
   724			  MOVE SPACES TO TIXTTLI
   725			  MOVE SPACES TO TIXDESC1I
   726			  MOVE 2 TO WS-PROG-STATE
   727
   728			  PERFORM 110-NEW-MAP
   729			ELSE
   730			  PERFORM 200-REC-MAP
   731			END-IF
   732		      ELSE
   733			  MOVE DFHCOMMAREA TO WS-COMMAREA
   734                    MOVE 'ENTER TICKET DETAILS AND PRESS PF2' TO ERRMSGO
   735			  MOVE 1 TO WS-PROG-STATE
   736			  PERFORM 110-NEW-MAP
   737
   738
   739		      END-IF
   740		  ELSE
   742		      EXEC CICS SEND TEXT
   743			   FROM (WS-INVALID)
   744			   LENGTH (+15)
   745			   ERASE
   746		      END-EXEC
   777		      EXEC CICS RETURN
   778		      END-EXEC
   791		  END-IF.
   792
   793
   794
   795	      110-NEW-MAP.
   796
   797		      MOVE EIBDATE TO WS-DATE.
   798		  MOVE WS-DATE-X TO DATEO.
   800		  EXEC CICS ASKTIME   801		   ABSTIME (WS-TIME)
   802		  END-EXEC
   820
   822		  EXEC CICS FORMATTIME
   823		   ABSTIME (WS-TIME)
   824             DATESEP ('-')
   825		   MMDDYY (DATEO)
   826		   TIME (TIMEO)
   827             TIMESEP (':')
   828		  END-EXEC
   868
   869		  MOVE DFHBMASB TO TIMEA
   870		  MOVE DFHBMASB TO DATEA
   871
   873		  EXEC CICS
   874             SEND MAP('SM002M')
   875             MAPSET('SM002')
   876		   FROM(SM002MO)
   877
   878		   ERASE
   879		  END-EXEC
   915
   917		  EXEC CICS RETURN
   918             TRANSID('SM02')
   919		   COMMAREA(WS-COMMAREA)
   920		  END-EXEC.
   945
   946	      200-REC-MAP.
   948		  EXEC CICS
   949                RECEIVE MAP('SM002M')
   950                MAPSET('SM002')
   951		      INTO (SM002MI)
   952		  END-EXEC
   985
   986		  IF EIBAID = DFHENTER
   987             IF WS-PROG-STATE = '2'
   988
   989		    MOVE SPACES TO TIXTTLI
   990		    MOVE SPACES TO TIXDESC1I
   991		    MOVE SPACES TO TIXDESC2I
   992		    MOVE SPACES TO STATI
   993		    MOVE HIGH-VALUES TO WS-STF01TCKID
   994		    MOVE 3 TO WS-PROG-STATE
   995
   996		   PERFORM 300-READ-STF1
   997
   998		   ELSE
   999
  1000		    IF TIXTTLI NOT = SPACES AND TIXDESC1I NOT = SPACES
  1001
  1002               MOVE 'PRESS PF2 TO ADD TICKET' TO ERRMSGO
  1003		     CONTINUE
  1004		    ELSE
  1005
  1006		     IF TIXTTLI = SPACES AND TIXDESC1I = SPACES
  1007                MOVE 'TITLE AND DESCRIPTION IS REQUIRED' TO ERRMSGO
  1008		     END-IF
  1009
  1010		     IF TIXTTLI = SPACES AND TIXDESC1I NOT = SPACES
  1011                MOVE 'TITLE IS REQUIRED' TO ERRMSGO  1012		     END-IF
  1013
  1014		     IF TIXTTLI NOT = SPACES AND TIXDESC1I = SPACES
  1015                MOVE 'DESCRIPTION IS REQUIRED' TO ERRMSGO
  1016		     END-IF
  1017
  1018		    END-IF
  1019
  1020		   END-IF
  1021
  1022		  END-IF
  1023
  1024		  IF EIBAID = DFHPF2
  1025		   IF TIXNUML = ZERO OR TIXTTLI = SPACES OR TIXDESC1I = SPACES
  1026              MOVE 'INVALID SPACES' TO ERRMSGO
  1027		    PERFORM 110-NEW-MAP
  1028		   ELSE
  1029		    MOVE 0 TO WS-ENTRCTR
  1030		    MOVE DFHDFHI TO UPDREMA
  1031		    MOVE DFHDFHI TO UPDDTA
  1032		    MOVE DFHDFHI TO UPDBY1A
  1033		    MOVE DFHDFHI TO UPDRMKA
  1034		    MOVE DFHDFHI TO UPDRMK1A
  1035		    MOVE DFHDFHI TO DATE1A
  1036		    MOVE DFHDFHI TO TIME1A
  1037		    MOVE DFHDFHI TO UPDBY2A
  1038
  1039		    MOVE SPACES TO WS-STF01TCKREQ
  1040		    MOVE SPACES TO WS-STF01TCKSTAT
  1041		    MOVE SPACES TO WS-STF01TCKTTL
  1042		    MOVE SPACES TO WS-STF01TCKDESC
  1043		    MOVE SPACES TO WS-STF01LSTUPD
  1044		    MOVE SPACES TO WS-STF01LSTUPDBY
  1045		    MOVE SPACES TO WS-STF01LSTUPDRMK
  1046
  1047		    MOVE TIXTTLI TO WS-STF01TCKTTL
  1048		    MOVE TIXDESC1O TO WS-STF01TCKDESC(1:50)
  1049		    MOVE TIXDESC2O TO WS-STF01TCKDESC(51:50)
  1050              MOVE 'CREATED' TO STATI
  1051		    MOVE STATI TO WS-STF01TCKSTAT
  1052              MOVE 'TICKET CREATED' TO UPDRMKI
  1053		    MOVE UPDRMKI TO WS-STF01LSTUPDRMK(1:25)
  1054		    MOVE UPDRMK1I TO WS-STF01LSTUPDRMK(26:25)
  1055		    MOVE WS-USERID1 TO UPDBY2I
  1056		    MOVE WS-USERID1 TO WS-STF01TCKREQ
  1057		    MOVE WS-USERID1 TO WS-STF01LSTUPDBY
  1058		    MOVE TIXNUMO TO WS-STF01TCKID
  1059
  1060		    MOVE EIBDATE TO WS-HDATE
  1062		    EXEC CICS ASKTIME
  1063		     ABSTIME (WS-HTIME)
  1064		    END-EXEC
  1082
  1084		    EXEC CICS FORMATTIME
  1085		     ABSTIME (WS-HTIME)
  1086               DATESEP ('/')
  1087		     MMDDYYYY (WS-HDATE-X)
  1088		     TIME (WS-HTIME)
  1089               TIMESEP (':')
  1090		    END-EXEC  1130
  1131		    MOVE WS-HDATE-X TO WS-STF01LSTUPD(1:10)
  1132		    MOVE WS-HDATE-X TO DATE1O
  1133		    MOVE WS-HTIME-X TO WS-STF01LSTUPD(11:10)
  1134		    MOVE WS-HTIME-X TO TIME1O
  1135
  1137		    EXEC CICS
  1138               WRITE FILE('STf00001')
  1139		     FROM (WS-FIELD01)
  1140		     RIDFLD (WS-STF01TCKID)
  1141		     RESP(WS-RES-CODE)
  1142		    END-EXEC
  1177		    END-IF
  1178
  1180		    IF EIBRESP NOT = DFHRESP(NORMAL)
  1182		    IF EIBRESP NOT =	     000			       R
  1183               MOVE 'TICKET NOT CREATED' TO ERRMSGO
  1184		    ELSE
  1185               MOVE 'TICKET CREATED, PRESS ENTER TO CREATE NEW TICKET'
  1186		     TO ERRMSGO
  1187		     PERFORM 400-CREATE-LOG
  1188		     MOVE SPACES TO WS-FIELD01
  1189		     MOVE DFHBMPRO TO TIXTTLA
  1190		     MOVE DFHBMPRO TO TIXDESC1A
  1191		     MOVE DFHBMPRO TO TIXDESC2A
  1192		     MOVE DFHBMPRO TO STATA
  1193		     MOVE DFHBMPRO TO UPDRMKA
  1194		     MOVE DFHBMPRO TO UPDRMK1A
  1195		     MOVE DFHBMPRO TO DATE1A
  1196		     MOVE DFHBMPRO TO TIME1A
  1197		     MOVE DFHBMPRO TO UPDBY2A
  1198
  1199		    END-IF
  1200
  1201
  1202		  END-IF
  1203
  1204
  1205		  IF EIBAID = DFHPF3
  1206             IF WS-PROG-STATE = '1'
  1208		    EXEC CICS SEND TEXT
  1209		     FROM (WS-END)
  1210		     LENGTH (15)
  1211		     ERASE
  1212		    END-EXEC
  1243		    EXEC CICS RETURN END-EXEC
  1256		   ELSE
  1258		    EXEC CICS XCTL
  1259               PROGRAM('SM000')
  1260		    END-EXEC
  1279		   END-IF
  1280		  END-IF
  1281
  1282		  IF EIBAID = DFHPF5
  1283		   MOVE SPACES TO ERRMSGO
  1284		   MOVE SPACES TO TIXNUMO
  1285		   MOVE SPACES TO TIXTTLO
  1286		   MOVE SPACES TO TIXDESC1O
  1287		   MOVE SPACES TO TIXDESC2O
  1288		   MOVE 2 TO WS-PROG-STATE  1289		   PERFORM 110-NEW-MAP
  1290		  END-IF.
  1291
  1292	      300-READ-STF1.
  1293
  1295		  EXEC CICS STARTBR
  1296             FILE('STf00001')
  1297		   RIDFLD (WS-STF01TCKID)
  1298		   RESP(WS-RES-CODE)
  1299		   GTEQ
  1300		  END-EXEC
  1333
  1335		  EXEC CICS READNEXT
  1336             FILE('STf00001')
  1337		   INTO (WS-FIELD01)
  1338		   RIDFLD (WS-STF01TCKID)
  1339		   RESP(WS-RES-CODE)
  1340		  END-EXEC
  1375
  1377		  IF EIBRESP = DFHRESP(NORMAL)
  1379		  IF EIBRESP =	       000				       R
  1380		   COMPUTE WS-STF01TCKIDR = WS-STF01TCKIDR + 1
  1381		   MOVE WS-STF01TCKIDR TO TIXNUMO
  1382		   MOVE WS-STF01TCKID TO WS-TICKET-NUM
  1383		   MOVE 1 TO WS-ENTRCTR
  1384		  END-IF.
  1385
  1386	      400-CREATE-LOG.
  1387		  MOVE WS-TICKET-NUM TO LOG-TIX-ID1
  1388		  MOVE 1 TO LOG-SEQ-NUM
  1389		  MOVE LOG-TIX-ID TO WS-LOG-PH
  1391            EXEC CICS STARTBR FILE('STf00002')
  1392		       RIDFLD (LOG-TIX-ID)
  1393		       KEYLENGTH(+9)
  1394		       RESP(WS-RES-CODE)
  1395		       GTEQ
  1396		  END-EXEC
  1436		  PERFORM UNTIL EIBRESP = DFHRESP(NOTFND)
  1438		  PERFORM UNTIL EIBRESP =	  013			       R
  1440		      EXEC CICS READPREV
  1441                          FILE('STf00002')
  1442				INTO (WS-LOG)
  1443				RIDFLD (LOG-TIX-ID)
  1444				RESP(WS-RES-CODE)
  1445		      END-EXEC
  1480		      IF WS-LOG-PH(1:6) NOT = LOG-TIX-ID1
  1481			  CONTINUE
  1482		      ELSE
  1483			  MOVE LOG-TIX-ID TO WS-LOG-PH
  1484		      END-IF
  1485		      ADD 1 TO LOG-SEQ-NUM
  1486		  END-PERFORM
  1487
  1488		  MOVE WS-LOG-PH TO LOG-TIX-ID
  1489		  MOVE WS-HTIME-X TO LOG-LAST-UPDATE-TIME
  1490		  MOVE WS-HDATE-X TO LOG-LAST-UPDATE-DATE
  1491		  MOVE WS-USERID1 TO LOG-UPDBY2
  1492		  MOVE UPDRMKI TO LOG-LAST-UPDATE-REM(1:25)
  1493		  MOVE UPDRMK1I TO LOG-LAST-UPDATE-REM(26:25)
  1495		  EXEC CICS  1496                WRITE FILE('STF00002')
  1497		      FROM(WS-LOG)
  1498		      RIDFLD(LOG-TIX-ID)
  1499		      RESP(WS-RES-CODE)
  1500		  END-EXEC.CA-Realia COBOL Version 6.0.45	 C:\handson-cics\CAWB30\sm02p.cic      PAGE   17

LINE (REL)  ERR# LVL			ERROR TEXT

  75 (  12)  0348 W Trailing dash discarded from 'COMP'
  76 (  13)  0132 W Period assumed before 'WS-DATE'

sm02p has    2 Warning messagesCA-Realia COBOL Version 6.0.45	 C:\handson-cics\CAWB30\sm02p.cic      PAGE   18



			Realia COBOL Compiler Version Information

			      Pass 1	 Version 6.072
			      Pass 1a	 Version 6.015
			      Pass 2	 Version 6.068
			      Pass 2a	 Version 6.020
			      Pass 3	 Version 6.094
			      Pass 4	 Version 6.007
			      Pass 5	 Version 6.022


			Compilation Directives in Effect

COMP-4		  DCHK		    OPT 	      NOCALL
NOSUBCHK	  STRCHK	    NOTRUNC	      NOSMALLCOMP
NODCALL 	  NODIVZERO	    NOEPDCALL	      APOST
EBCDIC		  STATABORT	    NOMOVELINK	      NOBLL4K
ARGCHK		  UPLOW 	    NOVERARG	      MDY
LP:   60	  PP		    FCREATE	      NOIEEE
NOLILIAN	  CURRENCY-SIGN=$   WRITEAFTER	      SOSI
NOCOPY68	  NOFLAG-COM	    NOFLAG-SEG	      NOFLAG-FIPS
DEBUGXREF	  DIALECT-VS2

			Error level limit: W

			Source lines compiled:	    1546
			Compilation time (mm:ss.ss):  0:00.67
			Compilation speed (lines/minute): 38447

			Compilation date (yy/mm/dd): 23/11/23
			     Time of day (hh:mm:ss): 03:45:24